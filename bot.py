 #!/usr/bin/env python3
# bot.py - –ü–æ–ª–Ω—ã–π –±–æ—Ç —Å keep-alive –¥–ª—è Render
import os
import telebot
from telebot import types
import json
import time
import random
import re
import threading
import requests
import math
from datetime import datetime, timedelta
from flask import Flask, request  # <-- –î–û–ë–ê–í–õ–ï–ù–û –î–õ–Ø WEBHOOK

# ========== CONFIGURATION ==========
BOT_TOKEN = os.environ.get('BOT_TOKEN', '8377535372:AAGLMfn_0P_tDvpJnfv_NmW4QclM2AIojEA')
bot = telebot.TeleBot(BOT_TOKEN)

# –ü–æ–ª—É—á–∞–µ–º URL –æ—Ç Render
RENDER_URL = os.environ.get('RENDER_EXTERNAL_URL', '')
WEBHOOK_URL = f'{RENDER_URL}/{BOT_TOKEN}' if RENDER_URL else None

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã
INITIAL_WORMS = 10
MAX_WORMS = 10
FISHING_TIME = 30
WORM_REFILL_TIME = 900  # 15 –º–∏–Ω—É—Ç
WARNING_EXPIRE_TIME = 86400  # 24 —á–∞—Å–∞
BAN_DURATION = 172800  # 2 –¥–Ω—è

# –ú–æ–Ω–µ—Ç—ã –∏ –º–∞–≥–∞–∑–∏–Ω
COINS_NAME = "—Ä—ã–±–æ–ø"
INITIAL_COINS = 100
WORM_PRICE = 10

# –ê–¥–º–∏–Ω —Å–∏—Å—Ç–µ–º–∞
ADMINS = {
    "5330661807": 5,  # 5 —É—Ä–æ–≤–µ–Ω—å - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
    "8351629145": 1,  # –ù–æ–≤—ã–µ –∞–¥–º–∏–Ω—ã –¥–ª—è –¥–æ–Ω–∞—Ç–∞
    "7093049365": 5
}
ADMIN_LOG_FILE = 'admin_logs.json'
ACTION_LOG_FILE = 'action_logs.json'
NEWS_CHANNEL_ID = None  # ID –∫–∞–Ω–∞–ª–∞ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π (–º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∂–µ)

# ========== –í–û–î–û–ï–ú–´ (10 —Ä–µ–∞–ª—å–Ω—ã—Ö –≤–æ–¥–æ–µ–º–æ–≤ –†–æ—Å—Å–∏–∏) ==========
WATER_BODIES = [
    {
        "name": "–û–∑–µ—Ä–æ –ë–∞–π–∫–∞–ª",
        "emoji": "üèîÔ∏è",
        "description": "–°–∞–º–æ–µ –≥–ª—É–±–æ–∫–æ–µ –æ–∑–µ—Ä–æ –≤ –º–∏—Ä–µ, —á–∏—Å—Ç–µ–π—à–∞—è –≤–æ–¥–∞",
        "fishes": ["–ë–∞–π–∫–∞–ª—å—Å–∫–∏–π –æ–º—É–ª—å", "–°–∏–≥", "–•–∞—Ä–∏—É—Å", "–õ–µ–Ω–æ–∫", "–¢–∞–π–º–µ–Ω—å", "–û—Å—ë—Ç—Ä", "–ù–∞–ª–∏–º", "–©—É–∫–∞", "–û–∫—É–Ω—å", "–ü–ª–æ—Ç–≤–∞"],
        "coordinates": "53¬∞N 108¬∞E",
        "difficulty": "–°–ª–æ–∂–Ω–æ"
    },
    {
        "name": "–í–æ–ª–≥–∞",
        "emoji": "üåä",
        "description": "–ö—Ä—É–ø–Ω–µ–π—à–∞—è —Ä–µ–∫–∞ –ï–≤—Ä–æ–ø—ã, –±–æ–≥–∞—Ç–∞ —Ä—ã–±–æ–π",
        "fishes": ["–°–æ–º", "–°—É–¥–∞–∫", "–õ–µ—â", "–°–∞–∑–∞–Ω", "–ñ–µ—Ä–µ—Ö", "–ü–ª–æ—Ç–≤–∞", "–ö–∞—Ä–∞—Å—å", "–û–∫—É–Ω—å", "–©—É–∫–∞", "–ì–æ–ª–∞–≤–ª—å"],
        "coordinates": "57¬∞N 47¬∞E",
        "difficulty": "–°—Ä–µ–¥–Ω–µ"
    },
    {
        "name": "–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ",
        "emoji": "üèûÔ∏è",
        "description": "–ö—Ä—É–ø–Ω–µ–π—à–µ–µ –æ–∑–µ—Ä–æ –≤ –ï–≤—Ä–æ–ø–µ",
        "fishes": ["–õ–∞–¥–æ–∂—Å–∫–∞—è —Ä–æ–≥–∞—Ç–∫–∞", "–°–∏–≥", "–ö–æ—Ä—é—à–∫–∞", "–û–∫—É–Ω—å", "–©—É–∫–∞", "–ü–ª–æ—Ç–≤–∞", "–õ–µ—â", "–°—É–¥–∞–∫", "–ù–∞–ª–∏–º", "–£–≥–æ—Ä—å"],
        "coordinates": "61¬∞N 31¬∞E",
        "difficulty": "–°—Ä–µ–¥–Ω–µ"
    },
    {
        "name": "–ê–º—É—Ä",
        "emoji": "üê≤",
        "description": "–ö—Ä—É–ø–Ω–∞—è —Ä–µ–∫–∞ –Ω–∞ –î–∞–ª—å–Ω–µ–º –í–æ—Å—Ç–æ–∫–µ",
        "fishes": ["–ö–µ—Ç–∞", "–ì–æ—Ä–±—É—à–∞", "–ö—Ä–∞—Å–Ω–æ–ø—ë—Ä–∫–∞", "–°–∞–∑–∞–Ω", "–©—É–∫–∞", "–°–æ–º", "–ó–º–µ–µ–≥–æ–ª–æ–≤", "–û—Å—ë—Ç—Ä", "–ö–∞–ª–∫–∞–Ω", "–¢–∞–π–º–µ–Ω—å"],
        "coordinates": "53¬∞N 140¬∞E",
        "difficulty": "–°–ª–æ–∂–Ω–æ"
    },
    {
        "name": "–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ",
        "emoji": "üåÖ",
        "description": "–°–∞–º—ã–π –±–æ–ª—å—à–æ–π –∑–∞–º–∫–Ω—É—Ç—ã–π –≤–æ–¥–æ—ë–º –≤ –º–∏—Ä–µ",
        "fishes": ["–ö–∞—Å–ø–∏–π—Å–∫–∞—è –∫–∏–ª—å–∫–∞", "–û—Å—ë—Ç—Ä", "–ë–µ–ª—É–≥–∞", "–°–µ–≤—Ä—é–≥–∞", "–ö–µ—Ñ–∞–ª—å", "–°–∞–∑–∞–Ω", "–°—É–¥–∞–∫", "–í–æ–±–ª–∞", "–õ–µ—â", "–°–æ–º"],
        "coordinates": "42¬∞N 50¬∞E",
        "difficulty": "–û—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ"
    },
    {
        "name": "–ï–Ω–∏—Å–µ–π",
        "emoji": "‚ùÑÔ∏è",
        "description": "–û–¥–Ω–∞ –∏–∑ –∫—Ä—É–ø–Ω–µ–π—à–∏—Ö —Ä–µ–∫ –º–∏—Ä–∞, –°–∏–±–∏—Ä—å",
        "fishes": ["–¢–∞–π–º–µ–Ω—å", "–õ–µ–Ω–æ–∫", "–•–∞—Ä–∏—É—Å", "–°–∏–≥", "–û–º—É–ª—å", "–©—É–∫–∞", "–û–∫—É–Ω—å", "–ü–ª–æ—Ç–≤–∞", "–õ–µ—â", "–ù–∞–ª–∏–º"],
        "coordinates": "62¬∞N 89¬∞E",
        "difficulty": "–°—Ä–µ–¥–Ω–µ"
    },
    {
        "name": "–û–Ω–µ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ",
        "emoji": "üõ∂",
        "description": "–í—Ç–æ—Ä–æ–µ –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ –æ–∑–µ—Ä–æ –≤ –ï–≤—Ä–æ–ø–µ",
        "fishes": ["–û–Ω–µ–∂—Å–∫–∏–π –ª–æ—Å–æ—Å—å", "–°–∏–≥", "–ü–∞–ª–∏—è", "–•–∞—Ä–∏—É—Å", "–©—É–∫–∞", "–û–∫—É–Ω—å", "–ü–ª–æ—Ç–≤–∞", "–õ–µ—â", "–ù–∞–ª–∏–º", "–£–≥–æ—Ä—å"],
        "coordinates": "61¬∞N 35¬∞E",
        "difficulty": "–°—Ä–µ–¥–Ω–µ"
    },
    {
        "name": "–î–æ–Ω",
        "emoji": "üåæ",
        "description": "–†–µ–∫–∞ –≤ —é–∂–Ω–æ–π –†–æ—Å—Å–∏–∏",
        "fishes": ["–°–æ–º", "–°—É–¥–∞–∫", "–õ–µ—â", "–°–∞–∑–∞–Ω", "–ö–∞—Ä–∞—Å—å", "–ü–ª–æ—Ç–≤–∞", "–û–∫—É–Ω—å", "–©—É–∫–∞", "–ì–æ–ª–∞–≤–ª—å", "–Ø–∑—å"],
        "coordinates": "47¬∞N 40¬∞E",
        "difficulty": "–õ–µ–≥–∫–æ"
    },
    {
        "name": "–û–±—å",
        "emoji": "üå≤",
        "description": "–ö—Ä—É–ø–Ω–µ–π—à–∞—è —Ä–µ–∫–∞ –ó–∞–ø–∞–¥–Ω–æ–π –°–∏–±–∏—Ä–∏",
        "fishes": ["–ú—É–∫—Å—É–Ω", "–ù–µ–ª—å–º–∞", "–©—ë–∫—É—Ä", "–Ø–∑—å", "–©—É–∫–∞", "–û–∫—É–Ω—å", "–ü–ª–æ—Ç–≤–∞", "–õ–µ—â", "–ö–∞—Ä–∞—Å—å", "–ù–∞–ª–∏–º"],
        "coordinates": "61¬∞N 68¬∞E",
        "difficulty": "–°—Ä–µ–¥–Ω–µ"
    },
    {
        "name": "–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ",
        "emoji": "‚õ∞Ô∏è",
        "description": "–ñ–µ–º—á—É–∂–∏–Ω–∞ –ì–æ—Ä–Ω–æ–≥–æ –ê–ª—Ç–∞—è",
        "fishes": ["–¢–µ–ª–µ—Ü–∫–∏–π —Ö–∞—Ä–∏—É—Å", "–¢–∞–π–º–µ–Ω—å", "–õ–µ–Ω–æ–∫", "–°–∏–≥", "–ü–ª–æ—Ç–≤–∞", "–û–∫—É–Ω—å", "–©—É–∫–∞", "–ù–∞–ª–∏–º", "–ï–ª–µ—Ü", "–ü–æ–¥–∫–∞–º–µ–Ω—â–∏–∫"],
        "coordinates": "51¬∞N 87¬∞E",
        "difficulty": "–°–ª–æ–∂–Ω–æ"
    }
]

# ========== 100 –í–ò–î–û–í –†–´–ë –†–û–°–°–ò–ò ==========
FISHES = [
    {"name": "–©—É–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (1, 20), "emoji": "üêü", "price": 50, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–í–æ–ª–≥–∞", "–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–î–æ–Ω", "–û–±—å", "–ï–Ω–∏—Å–µ–π"]},
    {"name": "–û–∫—É–Ω—å", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.1, 3), "emoji": "üêü", "price": 30, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à"], "locations": ["–ë–∞–π–∫–∞–ª", "–í–æ–ª–≥–∞", "–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–î–æ–Ω", "–û–±—å", "–ï–Ω–∏—Å–µ–π"]},
    {"name": "–ö–∞—Ä–∞—Å—å", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.3, 2), "emoji": "üêü", "price": 25, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à", "–ø–µ—Ä–ª–æ–≤–∫–∞"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω", "–û–±—å"]},
    {"name": "–õ–µ—â", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (1, 6), "emoji": "üêü", "price": 40, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à", "–≥–æ—Ä–æ—Ö"], "locations": ["–í–æ–ª–≥–∞", "–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–î–æ–Ω", "–û–±—å", "–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ü–ª–æ—Ç–≤–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.1, 1.5), "emoji": "üêü", "price": 20, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à"], "locations": ["–ë–∞–π–∫–∞–ª", "–í–æ–ª–≥–∞", "–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–î–æ–Ω", "–û–±—å", "–ï–Ω–∏—Å–µ–π", "–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–°—É–¥–∞–∫", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (2, 15), "emoji": "üê†", "price": 100, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å", "—Ç–≤–∏—Å—Ç–µ—Ä"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω", "–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–°–æ–º", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (5, 100), "emoji": "üê†", "price": 300, "baits": ["–ª—è–≥—É—à–∫–∞", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å", "—Ä–∞–∫"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω", "–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ", "–ê–º—É—Ä"]},
    {"name": "–ö–∞—Ä–ø", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (2, 20), "emoji": "üêü", "price": 150, "baits": ["–∫—É–∫—É—Ä—É–∑–∞", "—á–µ—Ä–≤—å", "–≥–æ—Ä–æ—Ö", "–±–æ–π–ª—ã"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–°–∞–∑–∞–Ω", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (3, 25), "emoji": "üêü", "price": 180, "baits": ["–∫—É–∫—É—Ä—É–∑–∞", "—á–µ—Ä–≤—å", "–≥–æ—Ä–æ—Ö", "–±–æ–π–ª—ã"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω", "–ê–º—É—Ä", "–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–§–æ—Ä–µ–ª—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 10), "emoji": "üê†", "price": 120, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à", "–∏–∫—Ä–∞"], "locations": ["–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ", "–≥–æ—Ä–Ω—ã–µ —Ä–µ–∫–∏"]},
    {"name": "–ì–æ–ª–∞–≤–ª—å", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.5, 4), "emoji": "üêü", "price": 60, "baits": ["–∫—É–∑–Ω–µ—á–∏–∫", "—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–ñ–µ—Ä–µ—Ö", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (2, 12), "emoji": "üêü", "price": 110, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "–±–ª–µ—Å–Ω–∞", "–≤–æ–±–ª–µ—Ä"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–Ø–∑—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 8), "emoji": "üêü", "price": 90, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–∫—É–∑–Ω–µ—á–∏–∫"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω", "–û–±—å", "–ï–Ω–∏—Å–µ–π"]},
    {"name": "–ö—Ä–∞—Å–Ω–æ–ø—ë—Ä–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.1, 1), "emoji": "üêü", "price": 15, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–õ–∏–Ω—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 7), "emoji": "üêü", "price": 130, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–ù–∞–ª–∏–º", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 12), "emoji": "üêü", "price": 140, "baits": ["—á–µ—Ä–≤—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "–∫—É—Å–∫–∏ —Ä—ã–±—ã"], "locations": ["–ë–∞–π–∫–∞–ª", "–í–æ–ª–≥–∞", "–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–û–±—å", "–ï–Ω–∏—Å–µ–π"]},
    {"name": "–û—Å—ë—Ç—Ä", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (10, 80), "emoji": "üê†", "price": 1000, "baits": ["—á–µ—Ä–≤—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—Ä–∞–∫"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ", "–ê–º—É—Ä", "–ë–∞–π–∫–∞–ª"]},
    {"name": "–ë–µ–ª—É–≥–∞", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (50, 1500), "emoji": "üê≥", "price": 2500, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å", "—Ä–∞–∫"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–°—Ç–µ—Ä–ª—è–¥—å", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (2, 16), "emoji": "üêü", "price": 800, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–æ–ø–∞—Ä—ã—à"], "locations": ["–í–æ–ª–≥–∞", "–û–±—å"]},
    {"name": "–†–∞–∫", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.05, 0.3), "emoji": "ü¶û", "price": 40, "baits": ["—á–µ—Ä–≤—å", "—Ä—ã–±–∞", "–º—è—Å–æ"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω", "–ë–∞–π–∫–∞–ª"]},
    {"name": "–ö—Ä–µ–≤–µ—Ç–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.02, 0.1), "emoji": "ü¶ê", "price": 10, "baits": ["—Ö–ª–µ–±", "—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ö—Ä–∞–±", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.3, 2), "emoji": "ü¶Ä", "price": 150, "baits": ["—Ä—ã–±–∞", "–º—è—Å–æ", "—á–µ—Ä–≤—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ö–∞–ª—å–º–∞—Ä", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 8), "emoji": "üêô", "price": 200, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å", "–∫—Ä–µ–≤–µ—Ç–∫–∞"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–§—É–≥—É", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (1, 4), "emoji": "üê°", "price": 600, "baits": ["—á–µ—Ä–≤—å", "–∫—Ä–µ–≤–µ—Ç–∫–∞", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ó–æ–ª–æ—Ç–∞—è —Ä—ã–±–∫–∞", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (0.1, 0.3), "emoji": "üëë", "price": 700, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "—Ö–ª–µ–±"], "locations": ["–ë–∞–π–∫–∞–ª", "–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–í–æ–¥–æ—Ä–æ—Å–ª–∏", "rarity": "–º—É—Å–æ—Ä", "weight_range": (0.1, 0.5), "emoji": "üåø", "price": 1, "baits": [], "locations": ["–í—Å–µ –≤–æ–¥–æ–µ–º—ã"]},
    {"name": "–ë–æ—Ç–∏–Ω–æ–∫", "rarity": "–º—É—Å–æ—Ä", "weight_range": (1, 2.5), "emoji": "üé£", "price": 1, "baits": [], "locations": ["–í—Å–µ –≤–æ–¥–æ–µ–º—ã"]},
    {"name": "–ü–∞–∫–µ—Ç", "rarity": "–º—É—Å–æ—Ä", "weight_range": (0.2, 0.5), "emoji": "üóëÔ∏è", "price": 1, "baits": [], "locations": ["–í—Å–µ –≤–æ–¥–æ–µ–º—ã"]},
    {"name": "–ë–∞–Ω–∫–∞", "rarity": "–º—É—Å–æ—Ä", "weight_range": (0.3, 0.8), "emoji": "üç∫", "price": 1, "baits": [], "locations": ["–í—Å–µ –≤–æ–¥–æ–µ–º—ã"]},
    {"name": "–ë–∞–π–∫–∞–ª—å—Å–∫–∏–π –æ–º—É–ª—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 3), "emoji": "üêü", "price": 200, "baits": ["–º–æ—Ç—ã–ª—å", "—á–µ—Ä–≤—å", "–æ–ø–∞—Ä—ã—à"], "locations": ["–ë–∞–π–∫–∞–ª"]},
    {"name": "–°–∏–≥", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.5, 5), "emoji": "üêü", "price": 80, "baits": ["–º–æ—Ç—ã–ª—å", "—á–µ—Ä–≤—å", "–æ–ø–∞—Ä—ã—à"], "locations": ["–ë–∞–π–∫–∞–ª", "–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–û–Ω–µ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–û–±—å"]},
    {"name": "–•–∞—Ä–∏—É—Å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.3, 2), "emoji": "üê†", "price": 180, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–∫—É–∑–Ω–µ—á–∏–∫"], "locations": ["–ë–∞–π–∫–∞–ª", "–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ", "–ï–Ω–∏—Å–µ–π"]},
    {"name": "–õ–µ–Ω–æ–∫", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 6), "emoji": "üêü", "price": 220, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–ë–∞–π–∫–∞–ª", "–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ", "–ï–Ω–∏—Å–µ–π"]},
    {"name": "–¢–∞–π–º–µ–Ω—å", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (5, 30), "emoji": "üê†", "price": 1200, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å", "—Ç–≤–∏—Å—Ç–µ—Ä"], "locations": ["–ë–∞–π–∫–∞–ª", "–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ", "–ï–Ω–∏—Å–µ–π", "–ê–º—É—Ä"]},
    {"name": "–õ–∞–¥–æ–∂—Å–∫–∞—è —Ä–æ–≥–∞—Ç–∫–∞", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.2, 1.5), "emoji": "üêü", "price": 160, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–ö–æ—Ä—é—à–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.05, 0.2), "emoji": "üêü", "price": 40, "baits": ["–º–æ—Ç—ã–ª—å", "—á–µ—Ä–≤—å"], "locations": ["–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–û–Ω–µ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–£–≥–æ—Ä—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 4), "emoji": "üêç", "price": 300, "baits": ["—á–µ—Ä–≤—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–û–Ω–µ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–ö–µ—Ç–∞", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (3, 15), "emoji": "üêü", "price": 350, "baits": ["–∏–∫—Ä–∞", "—á–µ—Ä–≤—å"], "locations": ["–ê–º—É—Ä"]},
    {"name": "–ì–æ—Ä–±—É—à–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (1.5, 5), "emoji": "üêü", "price": 120, "baits": ["–∏–∫—Ä–∞", "—á–µ—Ä–≤—å"], "locations": ["–ê–º—É—Ä"]},
    {"name": "–ó–º–µ–µ–≥–æ–ª–æ–≤", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (3, 10), "emoji": "üêç", "price": 700, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å"], "locations": ["–ê–º—É—Ä"]},
    {"name": "–ö–∞–ª–∫–∞–Ω", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (2, 12), "emoji": "üêü", "price": 280, "baits": ["—á–µ—Ä–≤—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–ê–º—É—Ä"]},
    {"name": "–ö–∞—Å–ø–∏–π—Å–∫–∞—è –∫–∏–ª—å–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.01, 0.05), "emoji": "üêü", "price": 5, "baits": ["–º–æ—Ç—ã–ª—å", "—á–µ—Ä–≤—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–°–µ–≤—Ä—é–≥–∞", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (10, 40), "emoji": "üêü", "price": 3000, "baits": ["—á–µ—Ä–≤—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ö–µ—Ñ–∞–ª—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 6), "emoji": "üêü", "price": 250, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–í–æ–±–ª–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.1, 0.8), "emoji": "üêü", "price": 35, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ú—É–∫—Å—É–Ω", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (2, 8), "emoji": "üêü", "price": 900, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–û–±—å"]},
    {"name": "–ù–µ–ª—å–º–∞", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (5, 25), "emoji": "üêü", "price": 2000, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å"], "locations": ["–û–±—å"]},
    {"name": "–©—ë–∫—É—Ä", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 3), "emoji": "üêü", "price": 320, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–û–±—å"]},
    {"name": "–û–Ω–µ–∂—Å–∫–∏–π –ª–æ—Å–æ—Å—å", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (4, 18), "emoji": "üêü", "price": 1500, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å"], "locations": ["–û–Ω–µ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–ü–∞–ª–∏—è", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 7), "emoji": "üêü", "price": 400, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–û–Ω–µ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–¢–µ–ª–µ—Ü–∫–∏–π —Ö–∞—Ä–∏—É—Å", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (0.5, 3), "emoji": "üêü", "price": 1100, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å", "–∫—É–∑–Ω–µ—á–∏–∫"], "locations": ["–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–ï–ª–µ—Ü", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.1, 0.5), "emoji": "üêü", "price": 45, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–ü–æ–¥–∫–∞–º–µ–Ω—â–∏–∫", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.05, 0.3), "emoji": "üêü", "price": 180, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–¢–µ–ª–µ—Ü–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    # –î–æ–±–∞–≤–∏–º –µ—â–µ 48 —Ä—ã–± –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã 100 –≤–∏–¥–æ–≤
    {"name": "–ü–µ–ª—è–¥—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 2), "emoji": "üêü", "price": 190, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–ë–∞–π–∫–∞–ª", "–û–±—å"]},
    {"name": "–†—è–ø—É—à–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.05, 0.2), "emoji": "üêü", "price": 25, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ", "–û–Ω–µ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–ß–∏—Ä", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 5), "emoji": "üêü", "price": 270, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–û–±—å", "–ï–Ω–∏—Å–µ–π"]},
    {"name": "–¢—É–≥—É–Ω", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.05, 0.1), "emoji": "üêü", "price": 150, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–ï–Ω–∏—Å–µ–π"]},
    {"name": "–ê–º—É—Ä—Å–∫–∏–π —Å–æ–º", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (10, 60), "emoji": "üê†", "price": 1300, "baits": ["–ª—è–≥—É—à–∫–∞", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–ê–º—É—Ä"]},
    {"name": "–ñ–µ–ª—Ç–æ—â—ë–∫", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (3, 15), "emoji": "üêü", "price": 850, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞", "—á–µ—Ä–≤—å"], "locations": ["–ê–º—É—Ä"]},
    {"name": "–ú–æ–Ω–≥–æ–ª—å—Å–∫–∏–π –∫—Ä–∞—Å–Ω–æ–ø—ë—Ä", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 3), "emoji": "üêü", "price": 310, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–ë–∞–π–∫–∞–ª"]},
    {"name": "–î–∞–≤–∞—Ç—á–∞–Ω", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (1, 8), "emoji": "üêü", "price": 3500, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–ë–∞–π–∫–∞–ª"]},
    {"name": "–ì–æ–ª—å—è–Ω", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.01, 0.03), "emoji": "üêü", "price": 10, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–í—Å–µ —Ä–µ–∫–∏"]},
    {"name": "–í–µ—Ä—Ö–æ–≤–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.005, 0.01), "emoji": "üêü", "price": 5, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–í—Å–µ –≤–æ–¥–æ–µ–º—ã"]},
    {"name": "–£–∫–ª–µ–π–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.01, 0.05), "emoji": "üêü", "price": 15, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–ë—ã—Å—Ç—Ä—è–Ω–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.01, 0.03), "emoji": "üêü", "price": 12, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–ü–æ–¥—É—Å—Ç", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 2), "emoji": "üêü", "price": 230, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–°–∏–Ω–µ—Ü", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.3, 1), "emoji": "üêü", "price": 55, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–ë–µ–ª–æ–≥–ª–∞–∑–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.2, 0.8), "emoji": "üêü", "price": 50, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–†—ã–±–µ—Ü", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 3), "emoji": "üêü", "price": 290, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–®–µ–º–∞—è", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.2, 0.8), "emoji": "üêü", "price": 260, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–î–æ–Ω"]},
    {"name": "–í—ã—Ä–µ–∑—É–±", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (2, 8), "emoji": "üêü", "price": 950, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–î–æ–Ω"]},
    {"name": "–ë–µ—Ä—à", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 4), "emoji": "üêü", "price": 330, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–ß–µ—Ö–æ–Ω—å", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.3, 1), "emoji": "üêü", "price": 65, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–í–æ–ª–≥–∞", "–î–æ–Ω"]},
    {"name": "–ê—Ç–µ—Ä–∏–Ω–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.02, 0.05), "emoji": "üêü", "price": 8, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ò–≥–ª–∞-—Ä—ã–±–∞", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.1, 0.3), "emoji": "üé£", "price": 170, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ó–≤–µ–∑–¥–æ—á—ë—Ç", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.3, 1), "emoji": "‚≠ê", "price": 340, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ë—ã—á–æ–∫", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.05, 0.3), "emoji": "üêü", "price": 30, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ü–µ—Å–∫–∞—Ä—å", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.01, 0.05), "emoji": "üêü", "price": 10, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–í—Å–µ —Ä–µ–∫–∏"]},
    {"name": "–ì–æ–ª–µ—Ü", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.02, 0.1), "emoji": "üêü", "price": 15, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–í—Å–µ —Ä–µ–∫–∏"]},
    {"name": "–©–∏–ø–æ–≤–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.005, 0.02), "emoji": "üêü", "price": 5, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–í—Å–µ —Ä–µ–∫–∏"]},
    {"name": "–í—å—é–Ω", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.03, 0.1), "emoji": "üêç", "price": 35, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–í—Å–µ —Ä–µ–∫–∏"]},
    {"name": "–ì–æ–ª–µ—Ü –∞—Ä–∫—Ç–∏—á–µ—Å–∫–∏–π", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 8), "emoji": "üêü", "price": 380, "baits": ["—á–µ—Ä–≤—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–°–µ–≤–µ—Ä–Ω—ã–µ —Ä–µ–∫–∏"]},
    {"name": "–ö—É–º–∂–∞", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (3, 12), "emoji": "üêü", "price": 1050, "baits": ["—á–µ—Ä–≤—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–°–µ–≤–µ—Ä–Ω—ã–µ —Ä–µ–∫–∏"]},
    {"name": "–†—É—á—å–µ–≤–∞—è —Ñ–æ—Ä–µ–ª—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.3, 2), "emoji": "üêü", "price": 360, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–ì–æ—Ä–Ω—ã–µ —Ä—É—á—å–∏"]},
    {"name": "–•–∞—Ä–∏—É—Å –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏–π", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 3), "emoji": "üêü", "price": 390, "baits": ["—á–µ—Ä–≤—å", "–º–æ—Ç—ã–ª—å"], "locations": ["–°–µ–≤–µ—Ä–Ω—ã–µ —Ä–µ–∫–∏"]},
    {"name": "–°–Ω–µ—Ç–æ–∫", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.005, 0.02), "emoji": "üêü", "price": 8, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–õ–∞–¥–æ–∂—Å–∫–æ–µ –æ–∑–µ—Ä–æ"]},
    {"name": "–ö–æ–ª—é—à–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.002, 0.01), "emoji": "üêü", "price": 3, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–í—Å–µ –≤–æ–¥–æ–µ–º—ã"]},
    {"name": "–ò–≥–ª–∞ –º–æ—Ä—Å–∫–∞—è", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.1, 0.5), "emoji": "üé£", "price": 210, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ö–æ–Ω—å-–≥—É–±–∞—Ä—å", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 2), "emoji": "üêé", "price": 240, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–õ—É—Ñ–∞—Ä—å", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (2, 10), "emoji": "üêü", "price": 980, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–°—Ç–∞–≤—Ä–∏–¥–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.1, 0.4), "emoji": "üêü", "price": 45, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–°–∫–∞—Ç", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (5, 20), "emoji": "üê†", "price": 1250, "baits": ["—á–µ—Ä–≤—å", "–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ö–∞—Ç—Ä–∞–Ω", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (8, 15), "emoji": "ü¶à", "price": 1400, "baits": ["–º–µ–ª–∫–∞—è —Ä—ã–±–∞"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–î–µ–ª—å—Ñ–∏–Ω", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (50, 200), "emoji": "üê¨", "price": 1500, "baits": ["—Ä—ã–±–∞"], "locations": ["–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–¢—é–ª–µ–Ω—å", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (70, 150), "emoji": "ü¶≠", "price": 2500, "baits": ["—Ä—ã–±–∞"], "locations": ["–ë–∞–π–∫–∞–ª", "–ö–∞—Å–ø–∏–π—Å–∫–æ–µ –º–æ—Ä–µ"]},
    {"name": "–ù–µ—Ä–ø–∞", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (50, 120), "emoji": "ü¶≠", "price": 5800, "baits": ["—Ä—ã–±–∞"], "locations": ["–ë–∞–π–∫–∞–ª"]},
    {"name": "–ë–µ–ª–æ–∫—Ä–æ–≤–Ω–∞—è —â—É–∫–∞", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (1, 5), "emoji": "‚ùÑÔ∏è", "price": 4000, "baits": ["—á–µ—Ä–≤—å", "—Ä—ã–±–∞"], "locations": ["–ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–¥—ã"]},
    {"name": "–õ–µ–¥—è–Ω–∞—è —Ä—ã–±–∞", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (0.5, 2), "emoji": "‚ùÑÔ∏è", "price": 1150, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–¥—ã"]},
    {"name": "–ü–æ–ª—è—Ä–Ω–∞—è –∞–∫—É–ª–∞", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (100, 400), "emoji": "ü¶à", "price": 1000, "baits": ["—Ä—ã–±–∞"], "locations": ["–ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–¥—ã"]},
    {"name": "–ì—Ä–µ–Ω–ª–∞–Ω–¥—Å–∫–∏–π –∫–∏—Ç", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (5000, 100000), "emoji": "üêã", "price": 5000, "baits": ["–ø–ª–∞–Ω–∫—Ç–æ–Ω"], "locations": ["–ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–¥—ã"]},
    {"name": "–ú–æ—Ä–∂", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (800, 2000), "emoji": "ü¶≠", "price": 4100, "baits": ["–º–æ–ª–ª—é—Å–∫–∏"], "locations": ["–ê—Ä–∫—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–¥—ã"]},
    {"name": "–ú–æ—Ä—Å–∫–æ–π —á—ë—Ä—Ç", "rarity": "—ç–ø–∏—á–µ—Å–∫–∞—è", "weight_range": (5, 25), "emoji": "üëπ", "price": 1350, "baits": ["—á–µ—Ä–≤—å", "—Ä—ã–±–∞"], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–ö–∞–º–±–∞–ª–∞", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (1, 7), "emoji": "üêü", "price": 370, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–¢—Ä–µ—Å–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (2, 15), "emoji": "üêü", "price": 140, "baits": ["—á–µ—Ä–≤—å", "—Ä—ã–±–∞"], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–°–∞–π—Ä–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.1, 0.3), "emoji": "üêü", "price": 40, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–°–µ–ª—å–¥—å", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.2, 0.5), "emoji": "üêü", "price": 60, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–í—Å–µ –º–æ—Ä—è"]},
    {"name": "–ö–∏–ª—å–∫–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.01, 0.03), "emoji": "üêü", "price": 5, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–í—Å–µ –º–æ—Ä—è"]},
    {"name": "–°–∞—Ä–¥–∏–Ω–∞", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.1, 0.2), "emoji": "üêü", "price": 35, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–ê–Ω—á–æ—É—Å", "rarity": "–æ–±—ã—á–Ω–∞—è", "weight_range": (0.02, 0.05), "emoji": "üêü", "price": 15, "baits": ["–º–æ—Ç—ã–ª—å"], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–°–∫–æ—Ä–ø–µ–Ω–∞", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.5, 3), "emoji": "ü¶Ç", "price": 410, "baits": ["—á–µ—Ä–≤—å"], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–ú–æ—Ä—Å–∫–æ–π —ë–∂", "rarity": "—Ä–µ–¥–∫–∞—è", "weight_range": (0.3, 1), "emoji": "ü¶î", "price": 190, "baits": ["–≤–æ–¥–æ—Ä–æ—Å–ª–∏"], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–ú–æ—Ä—Å–∫–∞—è –∑–≤–µ–∑–¥–∞", "rarity": "–º—É—Å–æ—Ä", "weight_range": (0.1, 0.5), "emoji": "‚≠ê", "price": 2, "baits": [], "locations": ["–í—Å–µ –º–æ—Ä—è"]},
    {"name": "–ö–æ—Ä–∞–ª–ª", "rarity": "–º—É—Å–æ—Ä", "weight_range": (0.5, 3), "emoji": "ü™∏", "price": 3, "baits": [], "locations": ["–¢—Ä–æ–ø–∏—á–µ—Å–∫–∏–µ –º–æ—Ä—è"]},
    {"name": "–ñ–µ–º—á—É–≥", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (0.01, 0.05), "emoji": "üíé", "price": 2000, "baits": [], "locations": ["–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–µ –º–æ—Ä—è"]},
    {"name": "–ó–æ–ª–æ—Ç–æ–π —Å–∞–º–æ—Ä–æ–¥–æ–∫", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (0.1, 5), "emoji": "ü•á", "price": 4800, "baits": [], "locations": ["–í—Å–µ –≤–æ–¥–æ–µ–º—ã"]},
    {"name": "–°—É–Ω–¥—É–∫ —Å —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏", "rarity": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "weight_range": (10, 50), "emoji": "üß∞", "price": 1000, "baits": [], "locations": ["–í—Å–µ –º–æ—Ä—è"]}
]

# ========== –í–ò–î–´ –ß–ï–†–í–ï–ô –ò –ù–ê–ñ–ò–í–û–ö ==========
BAITS = [
    {"name": "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å", "price": 10, "emoji": "üå±", "description": "–ë–∞–∑–æ–≤—ã–π —á–µ—Ä–≤—å –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ä—ã–±", "effectiveness": 1.0, "type": "—á–µ—Ä–≤—å"},
    {"name": "üî¥ –ú–æ—Ç—ã–ª—å", "price": 15, "emoji": "üî¥", "description": "–õ–∏—á–∏–Ω–∫–∞ –∫–æ–º–∞—Ä–∞, —Ö–æ—Ä–æ—à –¥–ª—è –∑–∏–º–Ω–µ–π —Ä—ã–±–∞–ª–∫–∏", "effectiveness": 1.2, "type": "–º–æ—Ç—ã–ª—å"},
    {"name": "‚ö™ –ë–µ–ª—ã–π –æ–ø–∞—Ä—ã—à", "price": 20, "emoji": "‚ö™", "description": "–õ–∏—á–∏–Ω–∫–∞ –º—É—Ö–∏, –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –∫—Ä—É–ø–Ω—É—é —Ä—ã–±—É", "effectiveness": 1.3, "type": "–æ–ø–∞—Ä—ã—à"},
    {"name": "üü° –ö—Ä–∞—Å–Ω—ã–π –æ–ø–∞—Ä—ã—à", "price": 25, "emoji": "üü°", "description": "–ö—Ä–∞—Å–Ω–∞—è –ª–∏—á–∏–Ω–∫–∞, –ª—É—á—à–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.5, "type": "–æ–ø–∞—Ä—ã—à"},
    {"name": "üü§ –î–æ–∂–¥–µ–≤–æ–π —á–µ—Ä–≤—å", "price": 30, "emoji": "üü§", "description": "–ö—Ä—É–ø–Ω—ã–π —á–µ—Ä–≤—å –ø–æ—Å–ª–µ –¥–æ–∂–¥—è", "effectiveness": 1.4, "type": "—á–µ—Ä–≤—å"},
    {"name": "üü† –ù–∞–≤–æ–∑–Ω—ã–π —á–µ—Ä–≤—å", "price": 35, "emoji": "üü†", "description": "–ß–µ—Ä–≤—å —Å —Å–∏–ª—å–Ω—ã–º –∑–∞–ø–∞—Ö–æ–º, –æ—Ç–ª–∏—á–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.6, "type": "—á–µ—Ä–≤—å"},
    {"name": "üåΩ –ö—É–∫—É—Ä—É–∑–∞", "price": 30, "emoji": "üåΩ", "description": "–õ—é–±–∏–º–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –∫–∞—Ä–ø–∞ –∏ —Å–∞–∑–∞–Ω–∞", "effectiveness": 1.5, "type": "—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è"},
    {"name": "üü¢ –ì–æ—Ä–æ—Ö", "price": 35, "emoji": "üü¢", "description": "–û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è –ª–µ—â–∞", "effectiveness": 1.4, "type": "—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è"},
    {"name": "üçû –•–ª–µ–±", "price": 5, "emoji": "üçû", "description": "–ë—é–¥–∂–µ—Ç–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è –º–µ–ª–∫–æ–π —Ä—ã–±—ã", "effectiveness": 0.8, "type": "—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è"},
    {"name": "üêõ –ß–µ—Ä–≤—å-–≤—ã–ø–æ–ª–∑–æ–∫", "price": 50, "emoji": "üêõ", "description": "–ö—Ä—É–ø–Ω—ã–π —á–µ—Ä–≤—å –¥–ª—è —Ö–∏—â–Ω–æ–π —Ä—ã–±—ã", "effectiveness": 1.7, "type": "—á–µ—Ä–≤—å"},
    {"name": "ü¶ó –ö—É–∑–Ω–µ—á–∏–∫", "price": 40, "emoji": "ü¶ó", "description": "–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è –≥–æ–ª–∞–≤–ª—è", "effectiveness": 1.6, "type": "–Ω–∞—Å–µ–∫–æ–º–æ–µ"},
    {"name": "üê∏ –õ—è–≥—É—à–∫–∞", "price": 100, "emoji": "üê∏", "description": "–õ—É—á—à–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è —Å–æ–º–∞", "effectiveness": 2.0, "type": "–∂–∏–≤–µ—Ü"},
    {"name": "ü¶ê –ö—Ä–µ–≤–µ—Ç–∫–∞", "price": 60, "emoji": "ü¶ê", "description": "–ú–æ—Ä—Å–∫–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è —Ö–∏—â–Ω–∏–∫–æ–≤", "effectiveness": 1.8, "type": "–º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç"},
    {"name": "üêü –ú–µ–ª–∫–∞—è —Ä—ã–±–∞", "price": 80, "emoji": "üêü", "description": "–ñ–∏–≤–µ—Ü –¥–ª—è —â—É–∫–∏ –∏ —Å—É–¥–∞–∫–∞", "effectiveness": 2.0, "type": "–∂–∏–≤–µ—Ü"},
    {"name": "ü•ö –ò–∫—Ä–∞", "price": 150, "emoji": "ü•ö", "description": "–î–æ—Ä–æ–≥–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è —Ñ–æ—Ä–µ–ª–∏", "effectiveness": 2.2, "type": "–æ—Å–æ–±–∞—è"},
    {"name": "ü•© –ú—è—Å–æ", "price": 70, "emoji": "ü•©", "description": "–ü—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è —Ä–∞–∫–æ–≤ –∏ –∫—Ä–∞–±–æ–≤", "effectiveness": 1.5, "type": "–º—è—Å–æ"},
    {"name": "üçñ –°–∞–ª—å–Ω–∏–∫", "price": 45, "emoji": "üçñ", "description": "–õ–∏—á–∏–Ω–∫–∞ –º–∞–π—Å–∫–æ–≥–æ –∂—É–∫–∞", "effectiveness": 1.6, "type": "–ª–∏—á–∏–Ω–∫–∞"},
    {"name": "ü¶™ –ú–∏–¥–∏—è", "price": 55, "emoji": "ü¶™", "description": "–ú–æ–ª–ª—é—Å–∫ –¥–ª—è –º–æ—Ä—Å–∫–æ–π —Ä—ã–±–∞–ª–∫–∏", "effectiveness": 1.7, "type": "–º–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç"},
    {"name": "üêå –£–ª–∏—Ç–∫–∞", "price": 35, "emoji": "üêå", "description": "–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è –∫–∞—Ä–ø–∞", "effectiveness": 1.4, "type": "–º–æ–ª–ª—é—Å–∫"},
    {"name": "üßÄ –°—ã—Ä", "price": 65, "emoji": "üßÄ", "description": "–ê—Ä–æ–º–∞—Ç–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.5, "type": "–º–æ–ª–æ—á–Ω–æ–µ"},
    {"name": "üçØ –¢–µ—Å—Ç–æ", "price": 25, "emoji": "üçØ", "description": "–î–æ–º–∞—à–Ω—è—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.2, "type": "—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è"},
    {"name": "üé£ –ë–æ–π–ª—ã", "price": 200, "emoji": "üé£", "description": "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è –∫–∞—Ä–ø–∞", "effectiveness": 2.5, "type": "–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è"},
    {"name": "üé£ –¢–≤–∏—Å—Ç–µ—Ä", "price": 120, "emoji": "üé£", "description": "–°–∏–ª–∏–∫–æ–Ω–æ–≤–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.8, "type": "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è"},
    {"name": "üé£ –í–æ–±–ª–µ—Ä", "price": 300, "emoji": "üé£", "description": "–î–æ—Ä–æ–≥–∞—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 2.0, "type": "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è"},
    {"name": "üé£ –ë–ª–µ—Å–Ω–∞", "price": 180, "emoji": "üé£", "description": "–ú–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.9, "type": "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è"},
    {"name": "üíé –ü–µ—Ä–ª–æ–≤–∫–∞", "price": 20, "emoji": "üíé", "description": "–î–µ—à–µ–≤–∞—è —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.1, "type": "—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è"},
    {"name": "üåæ –ü—à–µ–Ω–∏—Ü–∞", "price": 15, "emoji": "üåæ", "description": "–ó–µ—Ä–Ω–æ–≤–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.0, "type": "—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è"},
    {"name": "ü•ú –ê—Ä–∞—Ö–∏—Å", "price": 90, "emoji": "ü•ú", "description": "–ê—Ä–æ–º–∞—Ç–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.7, "type": "—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–∞—è"},
    {"name": "üßÖ –ß–µ—Å–Ω–æ–∫", "price": 40, "emoji": "üßÖ", "description": "–ê—Ä–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä –¥–ª—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.3, "type": "–∞—Ä–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä"},
    {"name": "üçØ –ú–µ–¥", "price": 110, "emoji": "üçØ", "description": "–°–ª–∞–¥–∫–∞—è –¥–æ–±–∞–≤–∫–∞ –∫ –ø—Ä–∏–º–∞–Ω–∫–µ", "effectiveness": 1.6, "type": "–∞—Ä–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä"},
    {"name": "üåø –ê–Ω–∏—Å", "price": 85, "emoji": "üåø", "description": "–ê—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "effectiveness": 1.5, "type": "–∞—Ä–æ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä"},
    {"name": "‚≠ê –°–ø–µ—Ü–∫–æ—Ä–º", "price": 500, "emoji": "‚≠ê", "description": "–≠–ª–∏—Ç–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞ –¥–ª—è —Ä–µ–¥–∫–æ–π —Ä—ã–±—ã", "effectiveness": 3.0, "type": "–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è"}
]

# ========== –£–î–û–ß–ö–ò –†–ï–ê–õ–¨–ù–´–ï ==========
RODS = [
    # –ü–æ–ø–ª–∞–≤–æ—á–Ω—ã–µ —É–¥–æ—á–∫–∏
    {"name": "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞", "price": 300, "emoji": "üé£", "description": "–ü—Ä–æ—Å—Ç–∞—è —É–¥–æ—á–∫–∞ –¥–ª—è –ª–æ–≤–ª–∏ —Å –±–µ—Ä–µ–≥–∞", "power": 1.0, "durability": 100, "max_fish_weight": 5, "type": "–ø–æ–ø–ª–∞–≤–æ—á–Ω–∞—è", "luck": 1.0},
    {"name": "üé£ –ë–æ–ª–æ–Ω—Å–∫–∞—è —É–¥–æ—á–∫–∞", "price": 800, "emoji": "üé£", "description": "–£–¥–æ—á–∫–∞ —Å –∫–æ–ª—å—Ü–∞–º–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–≥–æ –∑–∞–±—Ä–æ—Å–∞", "power": 1.2, "durability": 120, "max_fish_weight": 8, "type": "–ø–æ–ø–ª–∞–≤–æ—á–Ω–∞—è", "luck": 1.1},
    {"name": "üé£ –ú–∞—Ç—á–µ–≤–∞—è —É–¥–æ—á–∫–∞", "price": 1500, "emoji": "üé£", "description": "–î–ª—è –ª–æ–≤–ª–∏ –Ω–∞ –¥–∞–ª—å–Ω–∏—Ö –¥–∏—Å—Ç–∞–Ω—Ü–∏—è—Ö", "power": 1.5, "durability": 150, "max_fish_weight": 12, "type": "–ø–æ–ø–ª–∞–≤–æ—á–Ω–∞—è", "luck": 1.2},
    {"name": "üé£ –®—Ç–µ–∫–µ—Ä–Ω–∞—è —É–¥–æ—á–∫–∞", "price": 3000, "emoji": "üé£", "description": "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —É–¥–æ—á–∫–∞ –¥–ª—è —Ç–æ—á–Ω–æ–π –ª–æ–≤–ª–∏", "power": 1.8, "durability": 180, "max_fish_weight": 15, "type": "–ø–æ–ø–ª–∞–≤–æ—á–Ω–∞—è", "luck": 1.3},
    
    # –°–ø–∏–Ω–Ω–∏–Ω–≥–∏
    {"name": "üé£ –£–ª—å—Ç—Ä–∞–ª–∞–π—Ç —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 2000, "emoji": "üé£", "description": "–î–ª—è –ª–æ–≤–ª–∏ –º–µ–ª–∫–æ–π —Ö–∏—â–Ω–æ–π —Ä—ã–±—ã", "power": 1.4, "durability": 130, "max_fish_weight": 3, "type": "—Å–ø–∏–Ω–Ω–∏–Ω–≥", "luck": 1.4},
    {"name": "üé£ –õ–∞–π—Ç —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 3500, "emoji": "üé£", "description": "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–ø–∏–Ω–Ω–∏–Ω–≥", "power": 1.7, "durability": 160, "max_fish_weight": 8, "type": "—Å–ø–∏–Ω–Ω–∏–Ω–≥", "luck": 1.5},
    {"name": "üé£ –ú–µ–¥–∏—É–º —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 5000, "emoji": "üé£", "description": "–î–ª—è –∫—Ä—É–ø–Ω–æ–π —Ö–∏—â–Ω–æ–π —Ä—ã–±—ã", "power": 2.0, "durability": 200, "max_fish_weight": 15, "type": "—Å–ø–∏–Ω–Ω–∏–Ω–≥", "luck": 1.6},
    {"name": "üé£ –•–µ–≤–∏ —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 8000, "emoji": "üé£", "description": "–î–ª—è —Å–∞–º–æ–π –∫—Ä—É–ø–Ω–æ–π —Ä—ã–±—ã", "power": 2.5, "durability": 250, "max_fish_weight": 30, "type": "—Å–ø–∏–Ω–Ω–∏–Ω–≥", "luck": 1.7},
    {"name": "üé£ –ö–∞—Ä–±–æ–Ω–æ–≤—ã–π —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 12000, "emoji": "üé£", "description": "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏–Ω–Ω–∏–Ω–≥ –∏–∑ –∫–∞—Ä–±–æ–Ω–∞", "power": 3.0, "durability": 300, "max_fish_weight": 50, "type": "—Å–ø–∏–Ω–Ω–∏–Ω–≥", "luck": 1.8},
    
    # –§–∏–¥–µ—Ä–Ω—ã–µ —É–¥–æ—á–∫–∏
    {"name": "üé£ –ü–∏–∫–µ—Ä", "price": 2500, "emoji": "üé£", "description": "–õ–µ–≥–∫–∞—è —Ñ–∏–¥–µ—Ä–Ω–∞—è —É–¥–æ—á–∫–∞", "power": 1.3, "durability": 140, "max_fish_weight": 6, "type": "—Ñ–∏–¥–µ—Ä", "luck": 1.3},
    {"name": "üé£ –§–∏–¥–µ—Ä –º–µ–¥–∏—É–º", "price": 4500, "emoji": "üé£", "description": "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ–∏–¥–µ—Ä–Ω–∞—è —É–¥–æ—á–∫–∞", "power": 1.6, "durability": 170, "max_fish_weight": 12, "type": "—Ñ–∏–¥–µ—Ä", "luck": 1.4},
    {"name": "üé£ –§–∏–¥–µ—Ä —Ö–µ–≤–∏", "price": 7000, "emoji": "üé£", "description": "–î–ª—è –ª–æ–≤–ª–∏ –Ω–∞ —Å–∏–ª—å–Ω–æ–º —Ç–µ—á–µ–Ω–∏–∏", "power": 2.0, "durability": 220, "max_fish_weight": 20, "type": "—Ñ–∏–¥–µ—Ä", "luck": 1.5},
    {"name": "üé£ –§–∏–¥–µ—Ä —ç–∫—Å—Ç—Ä–∞-—Ö–µ–≤–∏", "price": 10000, "emoji": "üé£", "description": "–î–ª—è —Å–∞–º–æ–π –∫—Ä—É–ø–Ω–æ–π –¥–æ–Ω–Ω–æ–π —Ä—ã–±—ã", "power": 2.5, "durability": 280, "max_fish_weight": 40, "type": "—Ñ–∏–¥–µ—Ä", "luck": 1.6},
    
    # –ù–∞—Ö–ª—ã—Å—Ç–æ–≤—ã–µ —É–¥–æ—á–∫–∏
    {"name": "üé£ –ù–∞—Ö–ª—ã—Å—Ç 5 –∫–ª–∞—Å—Å", "price": 6000, "emoji": "üé£", "description": "–î–ª—è –ª–æ–≤–ª–∏ –Ω–∞ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–µ –º—É—à–∫–∏", "power": 1.5, "durability": 150, "max_fish_weight": 4, "type": "–Ω–∞—Ö–ª—ã—Å—Ç", "luck": 1.7},
    {"name": "üé£ –ù–∞—Ö–ª—ã—Å—Ç 7 –∫–ª–∞—Å—Å", "price": 9000, "emoji": "üé£", "description": "–î–ª—è –ª–æ–≤–ª–∏ —Å—Ä–µ–¥–Ω–µ–π —Ä—ã–±—ã", "power": 1.8, "durability": 180, "max_fish_weight": 8, "type": "–Ω–∞—Ö–ª—ã—Å—Ç", "luck": 1.8},
    {"name": "üé£ –ù–∞—Ö–ª—ã—Å—Ç 9 –∫–ª–∞—Å—Å", "price": 15000, "emoji": "üé£", "description": "–î–ª—è –∫—Ä—É–ø–Ω–æ–π —Ä—ã–±—ã", "power": 2.2, "durability": 220, "max_fish_weight": 15, "type": "–Ω–∞—Ö–ª—ã—Å—Ç", "luck": 1.9},
    
    # –ó–∏–º–Ω–∏–µ —É–¥–æ—á–∫–∏
    {"name": "üé£ –ó–∏–º–Ω—è—è —É–¥–æ—á–∫–∞", "price": 500, "emoji": "‚ùÑÔ∏è", "description": "–î–ª—è –∑–∏–º–Ω–µ–π —Ä—ã–±–∞–ª–∫–∏", "power": 1.0, "durability": 80, "max_fish_weight": 2, "type": "–∑–∏–º–Ω—è—è", "luck": 1.2},
    {"name": "üé£ –ó–∏–º–Ω–∏–π —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 1500, "emoji": "‚ùÑÔ∏è", "description": "–°–ø–∏–Ω–Ω–∏–Ω–≥ –¥–ª—è –∑–∏–º–Ω–µ–π —Ä—ã–±–∞–ª–∫–∏", "power": 1.3, "durability": 100, "max_fish_weight": 5, "type": "–∑–∏–º–Ω—è—è", "luck": 1.3},
    {"name": "üé£ –ó–∏–º–Ω—è—è –∂–µ—Ä–ª–∏—Ü–∞", "price": 800, "emoji": "‚ùÑÔ∏è", "description": "–î–ª—è –ª–æ–≤–ª–∏ —Ö–∏—â–Ω–∏–∫–∞ –∑–∏–º–æ–π", "power": 1.5, "durability": 120, "max_fish_weight": 10, "type": "–∑–∏–º–Ω—è—è", "luck": 1.4},
    {"name": "üé£ –ë–∞–ª–∞–Ω—Å–∏—Ä–Ω–∞—è —É–¥–æ—á–∫–∞", "price": 1200, "emoji": "‚ùÑÔ∏è", "description": "–î–ª—è –ª–æ–≤–ª–∏ –Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä", "power": 1.4, "durability": 110, "max_fish_weight": 6, "type": "–∑–∏–º–Ω—è—è", "luck": 1.3},
    
    # –ú–æ—Ä—Å–∫–∏–µ —É–¥–æ—á–∫–∏
    {"name": "üé£ –ú–æ—Ä—Å–∫–æ–π —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 10000, "emoji": "üåä", "description": "–î–ª—è –º–æ—Ä—Å–∫–æ–π —Ä—ã–±–∞–ª–∫–∏", "power": 2.5, "durability": 300, "max_fish_weight": 50, "type": "–º–æ—Ä—Å–∫–∞—è", "luck": 1.6},
    {"name": "üé£ –ú–æ—Ä—Å–∫–∞—è –¥–æ–Ω–∫–∞", "price": 8000, "emoji": "üåä", "description": "–î–ª—è –¥–æ–Ω–Ω–æ–π –º–æ—Ä—Å–∫–æ–π –ª–æ–≤–ª–∏", "power": 2.3, "durability": 280, "max_fish_weight": 40, "type": "–º–æ—Ä—Å–∫–∞—è", "luck": 1.5},
    {"name": "üé£ –¢—Ä–æ–ª–ª–∏–Ω–≥–æ–≤—ã–π —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 20000, "emoji": "üåä", "description": "–î–ª—è –ª–æ–≤–ª–∏ —Å –ª–æ–¥–∫–∏", "power": 3.0, "durability": 350, "max_fish_weight": 100, "type": "–º–æ—Ä—Å–∫–∞—è", "luck": 1.8},
    
    # –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ —É–¥–æ—á–∫–∏
    {"name": "üèÜ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫–∞—Ä–ø–æ–≤–∞—è —É–¥–æ—á–∫–∞", "price": 50000, "emoji": "üèÜ", "description": "–≠–ª–∏—Ç–Ω–∞—è —É–¥–æ—á–∫–∞ –¥–ª—è –∫–∞—Ä–ø–∞", "power": 3.5, "durability": 500, "max_fish_weight": 80, "type": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "luck": 2.0},
    {"name": "üèÜ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –º–æ—Ä—Å–∫–æ–π —Å–ø–∏–Ω–Ω–∏–Ω–≥", "price": 75000, "emoji": "üèÜ", "description": "–î–ª—è –º–æ—Ä—Å–∫–∏—Ö –≥–∏–≥–∞–Ω—Ç–æ–≤", "power": 4.0, "durability": 600, "max_fish_weight": 200, "type": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "luck": 2.2},
    {"name": "üèÜ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –Ω–∞—Ö–ª—ã—Å—Ç–æ–≤–∞—è —É–¥–æ—á–∫–∞", "price": 60000, "emoji": "üèÜ", "description": "–ò—Å–∫—É—Å—Å—Ç–≤–æ –Ω–∞—Ö–ª—ã—Å—Ç–∞", "power": 2.8, "durability": 400, "max_fish_weight": 25, "type": "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è", "luck": 2.5}
]

# ========== –£–õ–£–ß–®–ï–ù–ò–Ø –î–õ–Ø –£–î–û–ß–ï–ö ==========
ROD_UPGRADES = [
    {"name": "üîß –†–µ–º–∫–æ–º–ø–ª–µ–∫—Ç", "price": 500, "emoji": "üîß", "description": "–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç 50 –ø—Ä–æ—á–Ω–æ—Å—Ç–∏ —É–¥–æ—á–∫–∏", "effect": "repair_50"},
    {"name": "‚öôÔ∏è –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–µ—Å–∫–∞", "price": 1000, "emoji": "‚öôÔ∏è", "description": "+10% –∫ –ø—Ä–æ—á–Ω–æ—Å—Ç–∏ —É–¥–æ—á–∫–∏", "effect": "durability_10"},
    {"name": "üíé –ü—Ä–æ—á–Ω—ã–µ –∫–æ–ª—å—Ü–∞", "price": 2000, "emoji": "üíé", "description": "+20% –∫ –ø—Ä–æ—á–Ω–æ—Å—Ç–∏ —É–¥–æ—á–∫–∏", "effect": "durability_20"},
    {"name": "üåü –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ä—É–∫–æ—è—Ç—å", "price": 3000, "emoji": "üåü", "description": "+10% –∫ —É–¥–∞—á–µ", "effect": "luck_10"},
    {"name": "‚ú® –ú–∞–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞", "price": 5000, "emoji": "‚ú®", "description": "+20% –∫ —É–¥–∞—á–µ", "effect": "luck_20"},
    {"name": "üõ°Ô∏è –ù–µ—Ä—É—à–∏–º–æ—Å—Ç—å", "price": 10000, "emoji": "üõ°Ô∏è", "description": "–£–¥–æ—á–∫–∞ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è", "effect": "unbreakable"},
    {"name": "üîÆ –£–¥–∞—á–∞ +30%", "price": 15000, "emoji": "üîÆ", "description": "–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —É–¥–∞—á—É", "effect": "luck_30"}
]

# ========== –î–û–ù–ê–¢ –ü–ê–ö–ï–¢–´ ==========
DONATE_PACKAGES = [
    # –£–ª—É—á—à–µ–Ω–∏—è
    {"name": "üõ°Ô∏è –ù–µ—Ä—É—à–∏–º–æ—Å—Ç—å —É–¥–æ—á–∫–∏", "price_rub": 299, "emoji": "üõ°Ô∏è", 
     "description": "–£–¥–æ—á–∫–∞ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è", "type": "upgrade", 
     "effect": "unbreakable", "unique_code": "299RUBUNBR"},
    
    {"name": "üîÆ –£–¥–∞—á–∞ +20%", "price_rub": 200, "emoji": "üîÆ", 
     "description": "–ü–æ—Å—Ç–æ—è–Ω–Ω–æ +20% –∫ —É–¥–∞—á–µ", "type": "upgrade", 
     "effect": "luck_20", "unique_code": "200RUBLUCK"},
    
    # –£–¥–æ—á–∫–∏
    {"name": "üé£ –°–ø–∏–Ω–Ω–∏–Ω–≥ —Å —É–¥–∞—á–µ–π 30%", "price_rub": 499, "emoji": "üé£", 
     "description": "–°–ø–∏–Ω–Ω–∏–Ω–≥ —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–π —É–¥–∞—á–µ–π", "type": "rod", 
     "effect": "special_spinning", "unique_code": "499RUBSPIN"},
    
    {"name": "üèÜ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —É–¥–æ—á–∫–∞", "price_rub": 999, "emoji": "üèÜ", 
     "description": "–õ—É—á—à–∞—è —É–¥–æ—á–∫–∞ –≤ –∏–≥—Ä–µ", "type": "rod", 
     "effect": "legendary_rod", "unique_code": "999RUBLEG"},
    
    {"name": "üåä –ú–æ—Ä—Å–∫–æ–π —Å–ø–∏–Ω–Ω–∏–Ω–≥ PRO", "price_rub": 799, "emoji": "üåä", 
     "description": "–î–ª—è –º–æ—Ä—Å–∫–æ–π —Ä—ã–±–∞–ª–∫–∏", "type": "rod", 
     "effect": "marine_pro", "unique_code": "799RUBMAR"},
    
    # –†—ã–±–æ–ø
    {"name": "üí∞ 100 —Ä—ã–±–æ–ø", "price_rub": 50, "emoji": "üí∞", 
     "description": "100 –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã", "type": "coins", 
     "effect": "coins_100", "amount": 100, "unique_code": "50RUB100"},
    
    {"name": "üí∞ 500 —Ä—ã–±–æ–ø", "price_rub": 200, "emoji": "üí∞", 
     "description": "500 –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã", "type": "coins", 
     "effect": "coins_500", "amount": 500, "unique_code": "200RUB500"},
    
    {"name": "üí∞ 1000 —Ä—ã–±–æ–ø", "price_rub": 350, "emoji": "üí∞", 
     "description": "1000 –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã", "type": "coins", 
     "effect": "coins_1000", "amount": 1000, "unique_code": "350RUB1000"},
    
    {"name": "üí∞ 5000 —Ä—ã–±–æ–ø", "price_rub": 1500, "emoji": "üí∞", 
     "description": "5000 –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã", "type": "coins", 
     "effect": "coins_5000", "amount": 5000, "unique_code": "1500RUB5000"},
    
    {"name": "üí∞ 10000 —Ä—ã–±–æ–ø", "price_rub": 2800, "emoji": "üí∞", "description": "10000 –∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã", "type": "coins", "effect": "coins_10000", "amount": 10000, "unique_code": "2800RUB10000"},
    
    # –ù–∞–±–æ—Ä—ã
    {"name": "üéÅ –°—Ç–∞—Ä—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä", "price_rub": 399, "emoji": "üéÅ", "description": "–£–¥–æ—á–∫–∞ + 500 —Ä—ã–±–æ–ø + –ø—Ä–∏–º–∞–Ω–∫–∏", "type": "pack", "effect": "start", "unique_code": "399RUBSTART"},
    {"name": "üéÅ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä", "price_rub": 899, "emoji": "üéÅ", "description": "–°–ø–∏–Ω–Ω–∏–Ω–≥ + 2000 —Ä—ã–±–æ–ø + —É–ª—É—á—à–µ–Ω–∏–µ", "type": "pack", "effect": "pro", "unique_code": "899RUBPRO"},
    
    {"name": "üéÅ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –Ω–∞–±–æ—Ä", "price_rub": 1999, "emoji": "üéÅ", 
     "description": "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —É–¥–æ—á–∫–∞ + 5000 —Ä—ã–±–æ–ø", "type": "pack", 
     "effect": "leg", "unique_code": "1999RUBLEG"}
]

# ========== –ï–ñ–ï–î–ù–ï–í–ù–´–ï –ó–ê–î–ê–ù–ò–Ø ==========
DAILY_QUESTS = [
    {"id": 1, "name": "üé£ –ù–∞—á–∏–Ω–∞—é—â–∏–π —Ä—ã–±–∞–∫", "description": "–ü–æ–π–º–∞–π—Ç–µ 5 –ª—é–±—ã—Ö —Ä—ã–±", "reward": 100, "type": "catch", "target": 5},
    {"id": 2, "name": "üí∞ –ü—Ä–æ–¥–∞–≤–µ—Ü —Ä—ã–±—ã", "description": "–ü—Ä–æ–¥–∞–π—Ç–µ —Ä—ã–±—É –Ω–∞ 300 —Ä—ã–±–æ–ø", "reward": 150, "type": "sell", "target": 300},
    {"id": 3, "name": "üõí –ü–æ–∫—É–ø–∞—Ç–µ–ª—å", "description": "–ö—É–ø–∏—Ç–µ 3 —á–µ—Ä–≤—è–∫–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ", "reward": 80, "type": "buy_bait", "target": 3},
    {"id": 4, "name": "üêü –û—Ö–æ—Ç–Ω–∏–∫ –∑–∞ —Ä–µ–¥–∫–æ–π —Ä—ã–±–æ–π", "description": "–ü–æ–π–º–∞–π—Ç–µ 2 —Ä–µ–¥–∫–∏–µ —Ä—ã–±—ã", "reward": 200, "type": "catch_rare", "target": 2},
    {"id": 5, "name": "üåü –ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", "description": "–ü–æ–π–º–∞–π—Ç–µ 1 —ç–ø–∏—á–µ—Å–∫—É—é —Ä—ã–±—É", "reward": 500, "type": "catch_epic", "target": 1},
    {"id": 6, "name": "üëë –ú–∞—Å—Ç–µ—Ä —Ä—ã–±–∞–ª–∫–∏", "description": "–ü–æ–π–º–∞–π—Ç–µ 1 –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—É—é —Ä—ã–±—É", "reward": 1000, "type": "catch_legendary", "target": 1},
    {"id": 7, "name": "üé£ –£–ª—É—á—à–µ–Ω–∏–µ —Å–Ω–∞—Å—Ç–µ–π", "description": "–ö—É–ø–∏—Ç–µ –Ω–æ–≤—É—é —É–¥–æ—á–∫—É", "reward": 300, "type": "buy_rod", "target": 1},
    {"id": 8, "name": "üí™ –¢—Ä—É–¥—è–≥–∞", "description": "–ó–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ 500 —Ä—ã–±–æ–ø –∑–∞ –¥–µ–Ω—å", "reward": 250, "type": "earn", "target": 500},
    {"id": 9, "name": "üîÑ –ú–Ω–æ–≥–æ—Å—Ç–∞–Ω–æ—á–Ω–∏–∫", "description": "–í—ã–ø–æ–ª–Ω–∏—Ç–µ 3 —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏—è", "reward": 400, "type": "complete_quests", "target": 3},
    {"id": 10, "name": "üèÜ –ß–µ–º–ø–∏–æ–Ω –¥–Ω—è", "description": "–ó–∞–π–º–∏—Ç–µ 1 –º–µ—Å—Ç–æ –≤ —Ç–æ–ø–µ", "reward": 1000, "type": "top_1", "target": 1}
]

# ========== –ù–ü–° –î–õ–Ø –ü–†–û–î–ê–ñ–ò ==========
NPC_SELLERS = [
    {"name": "üë®‚Äçüåæ –†—ã–±–Ω—ã–π —Ç–æ—Ä–≥–æ–≤–µ—Ü", "emoji": "üë®‚Äçüåæ", "multiplier": 1.0, "description": "–ü–æ–∫—É–ø–∞–µ—Ç —Ä—ã–±—É –ø–æ –æ–±—ã—á–Ω–æ–π —Ü–µ–Ω–µ", "preferred_fish": ["–©—É–∫–∞", "–û–∫—É–Ω—å", "–ö–∞—Ä–∞—Å—å", "–õ–µ—â", "–ü–ª–æ—Ç–≤–∞"]},
    {"name": "üë®‚Äçüç≥ –†–µ—Å—Ç–æ—Ä–∞—Ç–æ—Ä", "emoji": "üë®‚Äçüç≥", "multiplier": 1.2, "description": "–ü–ª–∞—Ç–∏—Ç –Ω–∞ 20% –±–æ–ª—å—à–µ –∑–∞ —Å–≤–µ–∂—É—é —Ä—ã–±—É", "preferred_fish": ["–§–æ—Ä–µ–ª—å", "–û—Å—ë—Ç—Ä", "–°—ë–º–≥–∞", "–°—É–¥–∞–∫", "–ö–∞—Ä–ø"]},
    {"name": "üë®‚Äçüî¨ –£—á–µ–Ω—ã–π", "emoji": "üë®‚Äçüî¨", "multiplier": 1.5, "description": "–ü–æ–∫—É–ø–∞–µ—Ç —Ä–µ–¥–∫—É—é —Ä—ã–±—É –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π", "preferred_fish": ["–ë–∞–π–∫–∞–ª—å—Å–∫–∏–π –æ–º—É–ª—å", "–¢–∞–π–º–µ–Ω—å", "–•–∞—Ä–∏—É—Å", "–õ–µ–Ω–æ–∫", "–°—Ç–µ—Ä–ª—è–¥—å"]},
    {"name": "üëë –ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä", "emoji": "üëë", "multiplier": 2.0, "description": "–ü–ª–∞—Ç–∏—Ç –≤–¥–≤–æ–µ –±–æ–ª—å—à–µ –∑–∞ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—É—é —Ä—ã–±—É", "preferred_fish": ["–ó–æ–ª–æ—Ç–∞—è —Ä—ã–±–∫–∞", "–ë–µ–ª—É–≥–∞", "–û—Å—ë—Ç—Ä", "–ù–µ–ª—å–º–∞", "–î–µ–ª—å—Ñ–∏–Ω", "–¢—é–ª–µ–Ω—å"]},
    {"name": "üèõÔ∏è –ú—É–∑–µ–π", "emoji": "üèõÔ∏è", "multiplier": 3.0, "description": "–ü–æ–∫—É–ø–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –¥–ª—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏", "preferred_fish": ["–ñ–µ–º—á—É–≥", "–ó–æ–ª–æ—Ç–æ–π —Å–∞–º–æ—Ä–æ–¥–æ–∫", "–°—É–Ω–¥—É–∫ —Å —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏", "–ö–æ—Ä–∞–ª–ª"]},
    {"name": "üë®‚Äç‚öïÔ∏è –ê–ø—Ç–µ–∫–∞—Ä—å", "emoji": "üë®‚Äç‚öïÔ∏è", "multiplier": 1.8, "description": "–ü–æ–∫—É–ø–∞–µ—Ç —Ä—ã–±—É –¥–ª—è –ª–µ–∫–∞—Ä—Å—Ç–≤", "preferred_fish": ["–§—É–≥—É", "–ê–∫—É–ª–∞", "–°–∫–∞—Ç", "–ú–æ—Ä—Å–∫–æ–π —ë–∂"]},
    {"name": "üë®‚Äçüé® –•—É–¥–æ–∂–Ω–∏–∫", "emoji": "üë®‚Äçüé®", "multiplier": 1.3, "description": "–ü–æ–∫—É–ø–∞–µ—Ç –∫—Ä–∞—Å–∏–≤—É—é —Ä—ã–±—É –¥–ª—è –Ω–∞—Ç—é—Ä–º–æ—Ä—Ç–æ–≤", "preferred_fish": ["–ó–æ–ª–æ—Ç–∞—è —Ä—ã–±–∫–∞", "–§–æ—Ä–µ–ª—å", "–ö—Ä–∞—Å–Ω–æ–ø—ë—Ä–∫–∞", "–†—ã–±–∞-–∞–Ω–≥–µ–ª"]}
]

# ========== –†–ï–î–ö–û–°–¢–ò –ò –í–ï–†–û–Ø–¢–ù–û–°–¢–ò ==========
RARITY_PROBABILITIES = {
    "–æ–±—ã—á–Ω–∞—è": 50,
    "—Ä–µ–¥–∫–∞—è": 30,
    "—ç–ø–∏—á–µ—Å–∫–∞—è": 15,
    "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è": 4,
    "–º—É—Å–æ—Ä": 1
}

# –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
URL_PATTERN = re.compile(
    r'(https?://[^\s]+)|(www\.[^\s]+)|([a-zA-Z0-9-]+\.(com|ru|net|org|info|io|me|tv|co|us|uk|de|fr|es|it|jp|cn|—Ä—Ñ)[^\s]*)|(t\.me/[^\s]+)|(telegram\.me/[^\s]+)|(tg://[^\s]+)'
)
USERNAME_PATTERN = re.compile(r'@[a-zA-Z0-9_]{5,32}')

# ========== USER DATABASE (–†–ê–°–®–ò–†–ï–ù–ù–ê–Ø) ==========
class UserDatabase:
    def __init__(self):
        self.users = {}
        self.active_fishing = {}
        self.admin_logs = []
        self.action_logs = []
        self.news = []
        self.donate_transactions = []
        self.load_data()
        self.load_logs()
    
    def load_data(self):
        """–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)"""
        try:
            with open('users_data.json', 'r', encoding='utf-8') as f:
                data = json.load(f)
                self.users = data.get('users', {})
                ADMINS.update(data.get('admins', {}))
                self.news = data.get('news', [])
                self.donate_transactions = data.get('donate_transactions', [])
            print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(self.users)} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
            print(f"üì∞ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(self.news)} –Ω–æ–≤–æ—Å—Ç–µ–π")
            print(f"üí∞ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(self.donate_transactions)} –¥–æ–Ω–∞—Ç-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π")
        except FileNotFoundError:
            print("üìÅ –§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω–∞—á–∏–Ω–∞–µ–º —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞")
            self.users = {}
            self.news = []
            self.donate_transactions = []
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {e}")
            self.users = {}
            self.news = []
            self.donate_transactions = []
    
    def load_logs(self):
        """–ó–∞–≥—Ä—É–∂–∞–µ–º –ª–æ–≥–∏"""
        try:
            with open(ADMIN_LOG_FILE, 'r', encoding='utf-8') as f:
                self.admin_logs = json.load(f)
            print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(self.admin_logs)} –ª–æ–≥–æ–≤ –∞–¥–º–∏–Ω–æ–≤")
        except FileNotFoundError:
            self.admin_logs = []
        
        try:
            with open(ACTION_LOG_FILE, 'r', encoding='utf-8') as f:
                self.action_logs = json.load(f)
            print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(self.action_logs)} –ª–æ–≥–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π")
        except FileNotFoundError:
            self.action_logs = []
    
    def save_data(self):
        """–°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª"""
        try:
            data = {
                'users': self.users,
                'admins': ADMINS,
                'news': self.news,
                'donate_transactions': self.donate_transactions
            }
            with open('users_data.json', 'w', encoding='utf-8') as f:
                json.dump(data, f, ensure_ascii=False, indent=2)
            print("üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {e}")
    
    def save_logs(self):
        """–°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–≥–∏"""
        try:
            with open(ADMIN_LOG_FILE, 'w', encoding='utf-8') as f:
                json.dump(self.admin_logs, f, ensure_ascii=False, indent=2)
            
            with open(ACTION_LOG_FILE, 'w', encoding='utf-8') as f:
                json.dump(self.action_logs, f, ensure_ascii=False, indent=2)
            print("üíæ –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–≥–æ–≤: {e}")
    
    def log_admin_action(self, admin_id, action, target_id=None, details=""):
        """–õ–æ–≥–∏—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –∞–¥–º–∏–Ω–∞"""
        log_entry = {
            "admin_id": str(admin_id),
            "action": action,
            "target_id": str(target_id) if target_id else None,
            "details": details,
            "timestamp": datetime.now().isoformat()
        }
        self.admin_logs.append(log_entry)
        if len(self.admin_logs) > 1000:
            self.admin_logs = self.admin_logs[-1000:]
        self.save_logs()
    
    def log_action(self, user_id, action_type, details=""):
        """–õ–æ–≥–∏—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        log_entry = {
            "user_id": str(user_id),
            "action_type": action_type,
            "details": details,
            "timestamp": datetime.now().isoformat()
        }
        self.action_logs.append(log_entry)
        if len(self.action_logs) > 5000:
            self.action_logs = self.action_logs[-5000:]
        self.save_logs()
    
    def log_donate(self, user_id, package_name, amount, transaction_id):
        """–õ–æ–≥–∏—Ä—É–µ–º –¥–æ–Ω–∞—Ç-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é"""
        log_entry = {
            "user_id": str(user_id),
            "package_name": package_name,
            "amount": amount,
            "transaction_id": transaction_id,
            "timestamp": datetime.now().isoformat(),
            "processed": False
        }
        self.donate_transactions.append(log_entry)
        self.save_data()
    
    def add_news(self, title, content, author_id):
        """–î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ—Å—Ç—å"""
        news_entry = {
            "id": len(self.news) + 1,
            "title": title,
            "content": content,
            "author_id": str(author_id),
            "timestamp": datetime.now().isoformat()
        }
        self.news.append(news_entry)
        if len(self.news) > 50:
            self.news = self.news[-50:]
        self.save_data()
        return news_entry
    
    def get_user(self, user_id):
        user_id = str(user_id)
        if user_id not in self.users:
            self.users[user_id] = {
                'worms': INITIAL_WORMS,
                'fish_caught': [],
                'total_fish': 0,
                'last_fishing_time': None,
                'last_worm_refill': time.time(),
                'stats': {'common': 0, 'rare': 0, 'epic': 0, 'legendary': 0, 'trash': 0},
                'username': None,
                'first_name': None,
                'warnings': [],
                'banned_until': None,
                'muted_until': None,
                'coins': INITIAL_COINS,
                'inventory': {
                    'rods': [{"name": "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞", "equipped": True, "durability": 100, "max_durability": 100, "upgrades": [], "unbreakable": False}],
                    'baits': [{"name": "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å", "count": 10}],
                    'fish': {}
                },
                'daily_quests': {},
                'quests_completed_today': 0,
                'last_daily_reset': datetime.now().isoformat(),
                'current_rod': "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞",
                'current_bait': "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å",
                'current_location': random.choice(WATER_BODIES)['name'],
                'favorite_fishing_spots': [],
                'achievements': [],
                'fishing_level': 1,
                'experience': 0,
                'total_coins_earned': 0,
                'donate_history': [],
                'rod_upgrades': {},
                'luck_bonus': 0.0,
                'unbreakable_rods': False,
                'top_nickname': None,           
                'hide_from_top': False,        
                'show_stats': True,            
                'notifications': True         
            }
        
        user = self.users[user_id]
        current_time = time.time()
        
        # –ê–≤—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–≤—è–∫–æ–≤ (—Ç–æ–ª—å–∫–æ –æ–±—ã—á–Ω—ã—Ö –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–≥—Ä–æ–∫–∞)
        time_passed = current_time - user.get('last_worm_refill', current_time)
        worms_to_add = int(time_passed // WORM_REFILL_TIME)
        
        if worms_to_add > 0:
            user['worms'] = min(user['worms'] + worms_to_add, MAX_WORMS)
            user['last_worm_refill'] = current_time
        
        # –°–±—Ä–æ—Å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
        last_reset = datetime.fromisoformat(user.get('last_daily_reset', datetime.now().isoformat()))
        if datetime.now().date() > last_reset.date():
            user['daily_quests'] = {}
            user['quests_completed_today'] = 0
            user['last_daily_reset'] = datetime.now().isoformat()
        
        # –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
        user['warnings'] = [w for w in user['warnings'] if current_time - w < WARNING_EXPIRE_TIME]
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º—É—Ç–∞
        if user.get('muted_until') and current_time > user['muted_until']:
            user['muted_until'] = None
        
        return user
    
    def use_worm(self, user_id):
        user = self.get_user(user_id)
        if user['worms'] > 0:
            user['worms'] -= 1
            self.save_data()
            return True, user['worms']
        return False, user['worms']
    
    def use_bait(self, user_id, bait_name):
        user = self.get_user(user_id)
        for bait in user['inventory']['baits']:
            if bait['name'] == bait_name and bait['count'] > 0:
                bait['count'] -= 1
                if bait['count'] == 0:
                    user['inventory']['baits'] = [b for b in user['inventory']['baits'] if b['name'] != bait_name]
                self.save_data()
                return True
        return False
    
    def get_random_weight(self, weight_range):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤–µ—Å–∞ –≤ —Ü–µ–ª—ã—Ö –∫–∏–ª–æ–≥—Ä–∞–º–º–∞—Ö"""
        min_weight, max_weight = weight_range
    
        # –û–∫—Ä—É–≥–ª—è–µ–º –≥—Ä–∞–Ω–∏—Ü—ã –¥–æ —Ü–µ–ª—ã—Ö –∫–∏–ª–æ–≥—Ä–∞–º–º–æ–≤
        min_kg = int(math.ceil(min_weight))  # 2.5 -> 3, 0.3 -> 1
        max_kg = int(math.floor(max_weight)) # 16.7 -> 16, 25.2 -> 25
    
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –¥–∏–∞–ø–∞–∑–æ–Ω –≤–∞–ª–∏–¥–Ω—ã–π
        if min_kg > max_kg:
            # –ï—Å–ª–∏ min –±–æ–ª—å—à–µ max, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–µ–µ
            min_kg = max_kg = int((min_weight + max_weight) / 2)
    
         # –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –º–∏–Ω–∏–º—É–º 1 –∫–≥
        if min_kg < 1:
            min_kg = 1
    
        # –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º —á—Ç–æ max –Ω–µ –º–µ–Ω—å—à–µ min
        if max_kg < min_kg:
            max_kg = min_kg
    
        # –ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ min == max, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
        if min_kg == max_kg:
            return float(min_kg)
    
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
        weight = random.randint(min_kg, max_kg)
    
        return float(weight)
    
    def add_fish(self, user_id, fish, weight=None):
        user = self.get_user(user_id)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–µ—Å –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω
        if weight is None:
            weight = self.get_random_weight(fish['weight_range'])
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤–µ—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        if weight < 1:
            weight_display = f"{int(weight*1000)}–≥"
        else:
            weight_display = f"{int(weight)}–∫–≥"
        
        catch = {
            'fish': fish['name'],
            'rarity': fish['rarity'],
            'weight': weight,
            'weight_display': weight_display,
            'emoji': fish['emoji'],
            'price': fish.get('price', 0),
            'time': datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            'location': user.get('current_location', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
        }
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å —Ä—ã–±—ã
        fish_name = fish['name']
        if fish_name in user['inventory']['fish']:
            user['inventory']['fish'][fish_name] += 1
        else:
            user['inventory']['fish'][fish_name] = 1
        
        user['fish_caught'].append(catch)
        if len(user['fish_caught']) > 20:
            user['fish_caught'] = user['fish_caught'][-20:]
        
        user['total_fish'] += 1
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        if fish['rarity'] == "–æ–±—ã—á–Ω–∞—è":
            user['stats']['common'] += 1
        elif fish['rarity'] == "—Ä–µ–¥–∫–∞—è":
            user['stats']['rare'] += 1
        elif fish['rarity'] == "—ç–ø–∏—á–µ—Å–∫–∞—è":
            user['stats']['epic'] += 1
        elif fish['rarity'] == "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è":
            user['stats']['legendary'] += 1
        elif fish['rarity'] == "–º—É—Å–æ—Ä":
            user['stats']['trash'] += 1
        
        user['last_fishing_time'] = time.time()
        
        # –û–ø—ã—Ç –∑–∞ —Ä—ã–±—É
        exp_gained = 0
        if fish['rarity'] == "–æ–±—ã—á–Ω–∞—è":
            exp_gained = 10
        elif fish['rarity'] == "—Ä–µ–¥–∫–∞—è":
            exp_gained = 30
        elif fish['rarity'] == "—ç–ø–∏—á–µ—Å–∫–∞—è":
            exp_gained = 100
        elif fish['rarity'] == "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è":
            exp_gained = 500
        elif fish['rarity'] == "–º—É—Å–æ—Ä":
            exp_gained = 1
        
        user['experience'] += exp_gained
        while user['experience'] >= user['fishing_level'] * 100:
            user['experience'] -= user['fishing_level'] * 100
            user['fishing_level'] += 1
        
        self.save_data()
        return catch
    
    def add_warning(self, user_id, chat_id=None):
        user = self.get_user(user_id)
        current_time = time.time()
        user['warnings'].append(current_time)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
        active_warnings = [w for w in user['warnings'] if current_time - w < WARNING_EXPIRE_TIME]
        
        if len(active_warnings) >= 2:
            user['banned_until'] = current_time + BAN_DURATION
            self.save_data()
            return True, len(active_warnings), True
        
        self.save_data()
        return False, len(active_warnings), False
    
    def is_banned(self, user_id):
        user = self.get_user(user_id)
        if user.get('banned_until'):
            current_time = time.time()
            if current_time < user['banned_until']:
                return True
            else:
                user['banned_until'] = None
                self.save_data()
                return False
        return False
    
    def is_muted(self, user_id):
        user = self.get_user(user_id)
        if user.get('muted_until'):
            current_time = time.time()
            if current_time < user['muted_until']:
                return True
            else:
                user['muted_until'] = None
                self.save_data()
                return False
        return False
    
    def get_ban_time_left(self, user_id):
        user = self.get_user(user_id)
        if user.get('banned_until'):
            current_time = time.time()
            if current_time < user['banned_until']:
                return user['banned_until'] - current_time
        return 0
    
    def get_mute_time_left(self, user_id):
        user = self.get_user(user_id)
        if user.get('muted_until'):
            current_time = time.time()
            if current_time < user['muted_until']:
                return user['muted_until'] - current_time
        return 0
    
    def get_warning_count(self, user_id):
        user = self.get_user(user_id)
        current_time = time.time()
        active_warnings = [w for w in user['warnings'] if current_time - w < WARNING_EXPIRE_TIME]
        return len(active_warnings)
    
    def add_coins(self, user_id, amount):
        user = self.get_user(user_id)
        user['coins'] = max(0, user['coins'] + amount)
        user['total_coins_earned'] = user.get('total_coins_earned', 0) + amount
        self.save_data()
        return user['coins']
    
    def remove_coins(self, user_id, amount):
        user = self.get_user(user_id)
        if user['coins'] >= amount:
            user['coins'] -= amount
            self.save_data()
            return True, user['coins']
        return False, user['coins']
    
    def add_bait(self, user_id, bait_name, count=1):
        user = self.get_user(user_id)
        for bait in user['inventory']['baits']:
            if bait['name'] == bait_name:
                bait['count'] += count
                self.save_data()
                return True
        
        user['inventory']['baits'].append({"name": bait_name, "count": count})
        self.save_data()
        return True
    
    def add_rod(self, user_id, rod_name):
        user = self.get_user(user_id)
        
        # –ù–∞—Ö–æ–¥–∏–º —É–¥–æ—á–∫—É –≤ —Å–ø–∏—Å–∫–µ
        rod_data = next((r for r in RODS if r['name'] == rod_name), None)
        if not rod_data:
            return False
        
        for rod in user['inventory']['rods']:
            if rod['name'] == rod_name:
                # –ï—Å–ª–∏ —É–¥–æ—á–∫–∞ —É–∂–µ –µ—Å—Ç—å, —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                rod['count'] = rod.get('count', 1) + 1
                self.save_data()
                return True
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —É–¥–æ—á–∫—É
        new_rod = {
            "name": rod_name,
            "equipped": False,
            "durability": rod_data['durability'],
            "max_durability": rod_data['durability'],
            "upgrades": [],
            "unbreakable": False
        }
        
        user['inventory']['rods'].append(new_rod)
        self.save_data()
        return True
    
    def set_current_rod(self, user_id, rod_name):
        user = self.get_user(user_id)
        user['current_rod'] = rod_name
        for rod in user['inventory']['rods']:
            rod['equipped'] = (rod['name'] == rod_name)
        self.save_data()
        return True
    
    def set_current_bait(self, user_id, bait_name):
        user = self.get_user(user_id)
        user['current_bait'] = bait_name
        self.save_data()
        return True
    
    def set_current_location(self, user_id, location_name):
        user = self.get_user(user_id)
        user['current_location'] = location_name
        self.save_data()
        return True
    
    def sell_fish(self, user_id, fish_name, count=1, npc_index=0):
        user = self.get_user(user_id)
        
        if fish_name not in user['inventory']['fish'] or user['inventory']['fish'][fish_name] < count:
            return False, 0
        
        # –ù–∞—Ö–æ–¥–∏–º —Ü–µ–Ω—É —Ä—ã–±—ã
        fish_price = 0
        for fish in FISHES:
            if fish['name'] == fish_name:
                fish_price = fish.get('price', 0)
                fish_rarity = fish.get('rarity', "")
                break
        
        if fish_price == 0:
            return False, 0
        
        # –ü–æ–ª—É—á–∞–µ–º NPC
        npc = NPC_SELLERS[npc_index % len(NPC_SELLERS)]
        multiplier = npc['multiplier']
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ª–∏ NPC —ç—Ç—É —Ä—ã–±—É
        preferred_fish = npc.get('preferred_fish', [])
        if fish_name in preferred_fish:
            multiplier *= 1.5  # –ë–æ–Ω—É—Å –∑–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—É—é —Ä—ã–±—É
        
        total_price = int(fish_price * count * multiplier)
        user['inventory']['fish'][fish_name] -= count
        if user['inventory']['fish'][fish_name] == 0:
            del user['inventory']['fish'][fish_name]
        
        user['coins'] += total_price
        user['total_coins_earned'] = user.get('total_coins_earned', 0) + total_price
        self.save_data()
        return True, total_price
    
    def get_daily_quests(self, user_id):
        user = self.get_user(user_id)
        if not user.get('daily_quests'):
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 3 —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏—è
            available_quests = random.sample(DAILY_QUESTS, min(3, len(DAILY_QUESTS)))
            user['daily_quests'] = {q['id']: {'progress': 0, 'completed': False} for q in available_quests}
            self.save_data()
        return user['daily_quests']
    
    def update_quest_progress(self, user_id, quest_type, amount=1):
        user = self.get_user(user_id)
        updated = False
        
        for quest_id, quest_data in user.get('daily_quests', {}).items():
            if quest_data['completed']:
                continue
                
            quest = next((q for q in DAILY_QUESTS if q['id'] == quest_id), None)
            if quest and quest['type'] == quest_type:
                quest_data['progress'] = min(quest_data['progress'] + amount, quest['target'])
                if quest_data['progress'] >= quest['target'] and not quest_data['completed']:
                    quest_data['completed'] = True
                    user['coins'] += quest['reward']
                    user['quests_completed_today'] += 1
                    updated = True
                    self.log_action(user_id, "quest_complete", f"–ó–∞–¥–∞–Ω–∏–µ {quest['name']}, –Ω–∞–≥—Ä–∞–¥–∞ {quest['reward']}")
        
        if updated:
            self.save_data()
        return updated
    
    def get_user_rod(self, user_id, rod_name):
        """–ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É–¥–æ—á–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        user = self.get_user(user_id)
        for rod in user['inventory']['rods']:
            if rod['name'] == rod_name:
                return rod
        return None
    
    def degrade_rod(self, user_id, rod_name, amount=5):
        """–£–º–µ–Ω—å—à–∞–µ–º –ø—Ä–æ—á–Ω–æ—Å—Ç—å —É–¥–æ—á–∫–∏"""
        user = self.get_user(user_id)
        for rod in user['inventory']['rods']:
            if rod['name'] == rod_name:
                if not rod.get('unbreakable', False):
                    rod['durability'] = max(0, rod['durability'] - amount)
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å–ª–æ–º–∞–ª–∞—Å—å –ª–∏ —É–¥–æ—á–∫–∞
                    if rod['durability'] <= 0:
                        # –£–¥–∞–ª—è–µ–º —Å–ª–æ–º–∞–Ω–Ω—É—é —É–¥–æ—á–∫—É
                        user['inventory']['rods'] = [r for r in user['inventory']['rods'] if r['name'] != rod_name]
                        # –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∞—è —É–¥–æ—á–∫–∞, –≤—ã–±–∏—Ä–∞–µ–º –¥—Ä—É–≥—É—é
                        if user['current_rod'] == rod_name:
                            if user['inventory']['rods']:
                                user['current_rod'] = user['inventory']['rods'][0]['name']
                                user['inventory']['rods'][0]['equipped'] = True
                            else:
                                # –î–æ–±–∞–≤–ª—è–µ–º –±–∞–∑–æ–≤—É—é —É–¥–æ—á–∫—É, –µ—Å–ª–∏ –≤—Å–µ —Å–ª–æ–º–∞–ª–∏—Å—å
                                self.add_rod(user_id, "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞")
                                self.set_current_rod(user_id, "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞")
                        self.save_data()
                        return "broken"
                    
                    self.save_data()
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –æ –Ω–∏–∑–∫–æ–π –ø—Ä–æ—á–Ω–æ—Å—Ç–∏
                    if rod['durability'] <= rod['max_durability'] * 0.2:
                        return "low"
                    elif rod['durability'] <= rod['max_durability'] * 0.5:
                        return "warning"
                return "ok"
        return "not_found"
    
    def repair_rod(self, user_id, rod_name, amount):
        """–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ—á–Ω–æ—Å—Ç—å —É–¥–æ—á–∫–∏"""
        user = self.get_user(user_id)
        for rod in user['inventory']['rods']:
            if rod['name'] == rod_name:
                rod['durability'] = min(rod['max_durability'], rod['durability'] + amount)
                self.save_data()
                return rod['durability']
        return 0
    
    def upgrade_rod(self, user_id, rod_name, upgrade_type):
        """–£–ª—É—á—à–∞–µ–º —É–¥–æ—á–∫—É"""
        user = self.get_user(user_id)
        rod = self.get_user_rod(user_id, rod_name)
        if not rod:
            return False
        
        if upgrade_type == "unbreakable":
            rod['unbreakable'] = True
            user['unbreakable_rods'] = True
        elif upgrade_type == "luck_20":
            user['luck_bonus'] = user.get('luck_bonus', 0) + 0.2
        elif upgrade_type == "luck_30":
            user['luck_bonus'] = user.get('luck_bonus', 0) + 0.3
        elif upgrade_type == "luck_10":
            user['luck_bonus'] = user.get('luck_bonus', 0) + 0.1
        
        if 'upgrades' not in rod:
            rod['upgrades'] = []
        rod['upgrades'].append(upgrade_type)
        
        self.save_data()
        return True
    
    def get_top_players(self, category="coins", limit=10):
        """–ü–æ–ª—É—á–∞–µ–º —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º"""
        users_list = []
    
        for user_id, user_data in self.users.items():
            # 1. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–∫—Ä—ã–ª–∏—Å—å –∏–∑ —Ç–æ–ø–∞
            if user_data.get('hide_from_top', False):
                continue  # ‚Üê —ç—Ç–æ—Ç –∏–≥—Ä–æ–∫ –Ω–µ –±—É–¥–µ—Ç –≤ —Ç–æ–ø–µ
        
            # 2. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞–∫–æ–µ –∏–º—è –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ —Ç–æ–ø–µ
            # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–π –Ω–∏–∫, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç - –±–µ—Ä–µ–º –∏–º—è
            display_name = user_data.get('top_nickname')
            if not display_name:
                display_name = user_data.get('first_name', '–ò–≥—Ä–æ–∫')
        
            # 3. –°—á–∏—Ç–∞–µ–º –æ—á–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            if category == "coins":
                score = user_data.get('total_coins_earned', 0)
            elif category == "fish":
                score = user_data.get('total_fish', 0)
            elif category == "level":
                score = user_data.get('fishing_level', 1)
            elif category == "rare":
                score = user_data.get('stats', {}).get('legendary', 0) * 100 + \
                       user_data.get('stats', {}).get('epic', 0) * 10 + \
                       user_data.get('stats', {}).get('rare', 0)
            else:
                score = 0
        
            # 4. –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ —Å–ø–∏—Å–æ–∫
            users_list.append({
                'user_id': user_id,
                'username': user_data.get('username', ''),
                'display_name': display_name,  # ‚Üê —ç—Ç–æ –∏–º—è –ø–æ–∫–∞–∂–µ–º –≤ —Ç–æ–ø–µ
                'score': score,
                'level': user_data.get('fishing_level', 1),
                'hide_from_top': user_data.get('hide_from_top', False)  # ‚Üê —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å
            })
    
        # 5. –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ—á–∫–æ–≤
        users_list.sort(key=lambda x: x['score'], reverse=True)
    
        # 6. –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤
        return users_list[:limit]
    
    def process_donate(self, transaction_id, verify=True):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–æ–Ω–∞—Ç-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é"""
        for transaction in self.donate_transactions:
            if transaction['transaction_id'] == transaction_id and not transaction['processed']:
                if verify:
                    transaction['processed'] = True
                    self.save_data()
                    return transaction
        return None

db = UserDatabase()

# ========== –ê–î–ú–ò–ù –°–ò–°–¢–ï–ú–ê ==========
def is_admin(user_id, min_level=1):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è"""
    user_id = str(user_id)
    return ADMINS.get(user_id, 0) >= min_level

def get_admin_level(user_id):
    """–ü–æ–ª—É—á–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –∞–¥–º–∏–Ω–∞"""
    user_id = str(user_id)
    return ADMINS.get(user_id, 0)

def set_admin_level(user_id, level):
    """–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –∞–¥–º–∏–Ω–∞"""
    user_id = str(user_id)
    if level <= 0:
        if user_id in ADMINS:
            del ADMINS[user_id]
    else:
        ADMINS[user_id] = level
    db.save_data()
    return True

def get_user_from_input(input_str):
    """–ü–æ–ª—É—á–∏—Ç—å user_id –∏–∑ –≤—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–º–æ–∂–µ—Ç –±—ã—Ç—å ID –∏–ª–∏ @username)"""
    # –ï—Å–ª–∏ —ç—Ç–æ —á–∏—Å–ª–æ–≤–æ–π ID
    if input_str.isdigit():
        return input_str
    
    # –ï—Å–ª–∏ —ç—Ç–æ @username, –∏—â–µ–º –≤ –±–∞–∑–µ
    if input_str.startswith('@'):
        username = input_str[1:].lower()
        for user_id, user_data in db.users.items():
            user_username = user_data.get('username')
            if user_username and user_username.lower() == username:
                return user_id
    
    # –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç (–∏–º—è), –∏—â–µ–º –ø–æ –∏–º–µ–Ω–∏
    search_name = input_str.lower()
    for user_id, user_data in db.users.items():
        user_name = user_data.get('first_name')
        if user_name and user_name.lower() == search_name:
            return user_id
    
    return None

# ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
def get_available_fish_for_location(location_name):
    """–ü–æ–ª—É—á–∞–µ–º —Ä—ã–±—É, –¥–æ—Å—Ç—É–ø–Ω—É—é –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –≤–æ–¥–æ–µ–º–µ"""
    available_fish = []
    for fish in FISHES:
        if 'locations' in fish:
            if '–í—Å–µ –≤–æ–¥–æ–µ–º—ã' in fish['locations'] or location_name in fish['locations']:
                available_fish.append(fish)
    return available_fish

def get_fish_for_bait(bait_name, location_fish):
    """–ü–æ–ª—É—á–∞–µ–º —Ä—ã–±—É, –∫–æ—Ç–æ—Ä–∞—è –∫–ª—é–µ—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –ø—Ä–∏–º–∞–Ω–∫—É –≤ —Ç–µ–∫—É—â–µ–º –≤–æ–¥–æ–µ–º–µ"""
    # –ù–∞—Ö–æ–¥–∏–º —Ç–∏–ø –ø—Ä–∏–º–∞–Ω–∫–∏
    bait_type = ""
    for bait in BAITS:
        if bait['name'] == bait_name:
            bait_type = bait['type']
            break
    
    suitable_fish = []
    
    for fish in location_fish:
        if 'baits' in fish:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ —Ç–∏–ø—É –ø—Ä–∏–º–∞–Ω–∫–∏
            if bait_type in ['—á–µ—Ä–≤—å', '–º–æ—Ç—ã–ª—å', '–æ–ø–∞—Ä—ã—à']:
                # –ï—Å–ª–∏ –ø—Ä–∏–º–∞–Ω–∫–∞ —á–µ—Ä–≤—å/–º–æ—Ç—ã–ª—å/–æ–ø–∞—Ä—ã—à, –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
                bait_lower = bait_name.lower()
                fish_baits = [b.lower() for b in fish.get('baits', [])]
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                for fish_bait in fish_baits:
                    if bait_type in fish_bait or any(word in bait_lower for word in bait_type.split()):
                        suitable_fish.append(fish)
                        break
            elif bait_type and bait_type != '–æ—Å–æ–±–∞—è':
                # –î–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∏–º–∞–Ω–æ–∫
                if fish.get('baits'):
                    # –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ —Ä—ã–±–∞ –º–æ–∂–µ—Ç –∫–ª–µ–≤–∞—Ç—å –Ω–∞ —á—Ç–æ-—Ç–æ –ø–æ–¥–æ–±–Ω–æ–µ
                    suitable_fish.append(fish)
            else:
                # –î–ª—è –æ—Å–æ–±—ã—Ö –ø—Ä–∏–º–∞–Ω–æ–∫
                suitable_fish.append(fish)
    
    # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–µ–π —Ä—ã–±—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
    if not suitable_fish and location_fish:
        suitable_fish = [random.choice(location_fish)]
    
    return suitable_fish

def calculate_catch(user_data, bait_name=None):
    """–†–∞—Å—á–µ—Ç —É–ª–æ–≤–∞ —Å —É—á–µ—Ç–æ–º –ø—Ä–∏–º–∞–Ω–∫–∏, —É–¥–æ—á–∫–∏ –∏ —É–¥–∞—á–∏"""
    current_location = user_data.get('current_location', '–í–æ–ª–≥–∞')
    location_fish = get_available_fish_for_location(current_location)
    
    # –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ –ø—Ä–∏–º–∞–Ω–∫–∞, –≤—ã–±–∏—Ä–∞–µ–º —Ä—ã–±—É –¥–ª—è –Ω–µ–µ
    if bait_name and bait_name != "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å":
        suitable_fish = get_fish_for_bait(bait_name, location_fish)
        if suitable_fish:
            # –í–∑–≤–µ—à–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä —Å —É—á–µ—Ç–æ–º —Ä–µ–¥–∫–æ—Å—Ç–∏
            weighted_fish = []
            for fish in suitable_fish:
                weight = RARITY_PROBABILITIES.get(fish['rarity'], 1)
                weighted_fish.extend([fish] * weight)
            
            if weighted_fish:
                selected_fish = random.choice(weighted_fish)
            else:
                selected_fish = random.choice(suitable_fish)
        else:
            selected_fish = random.choice(location_fish)
    else:
        # –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä —Å —É—á–µ—Ç–æ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Ä–µ–¥–∫–æ—Å—Ç–∏
        total_prob = sum(RARITY_PROBABILITIES.values())
        rand_num = random.randint(1, total_prob)
        current_prob = 0
        
        for rarity, prob in RARITY_PROBABILITIES.items():
            current_prob += prob
            if rand_num <= current_prob:
                # –§–∏–ª—å—Ç—Ä—É–µ–º —Ä—ã–±—É –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏ –∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é
                fish_of_rarity = [f for f in location_fish if f['rarity'] == rarity]
                if fish_of_rarity:
                    selected_fish = random.choice(fish_of_rarity)
                else:
                    # –ï—Å–ª–∏ –Ω–µ—Ç —Ä—ã–±—ã —Ç–∞–∫–æ–π —Ä–µ–¥–∫–æ—Å—Ç–∏, –±–µ—Ä–µ–º –æ–±—ã—á–Ω—É—é
                    selected_fish = random.choice([f for f in location_fish if f['rarity'] == '–æ–±—ã—á–Ω–∞—è'])
                break
    
    # –£—á–µ—Ç —É–¥–∞—á–∏ –æ—Ç —É–¥–æ—á–∫–∏ –∏ —É–ª—É—á—à–µ–Ω–∏–π
    current_rod_name = user_data.get('current_rod', 'üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞')
    rod_data = next((r for r in RODS if r['name'] == current_rod_name), None)
    
    luck_multiplier = 1.0
    if rod_data:
        luck_multiplier *= rod_data.get('luck', 1.0)
    
    # –ë–æ–Ω—É—Å —É–¥–∞—á–∏ –æ—Ç —É–ª—É—á—à–µ–Ω–∏–π
    luck_multiplier += user_data.get('luck_bonus', 0.0)
    
    # –®–∞–Ω—Å —É–ª—É—á—à–∏—Ç—å —Ä–µ–¥–∫–æ—Å—Ç—å
    if random.random() < (luck_multiplier - 1.0) * 0.1:
        # –ü—ã—Ç–∞–µ–º—Å—è —É–ª—É—á—à–∏—Ç—å —Ä–µ–¥–∫–æ—Å—Ç—å
        rarities = ['–æ–±—ã—á–Ω–∞—è', '—Ä–µ–¥–∫–∞—è', '—ç–ø–∏—á–µ—Å–∫–∞—è', '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è']
        current_index = rarities.index(selected_fish['rarity'])
        if current_index < len(rarities) - 1:
            # –ò—â–µ–º —Ä—ã–±—É —Å –ª—É—á—à–µ–π —Ä–µ–¥–∫–æ—Å—Ç—å—é
            better_fish = [f for f in location_fish if f['rarity'] == rarities[current_index + 1]]
            if better_fish:
                selected_fish = random.choice(better_fish)
    
    return selected_fish

def create_main_keyboard(user_id=None):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    btn1 = types.KeyboardButton('üé£ –ù–∞—á–∞—Ç—å —Ä—ã–±–∞–ª–∫—É')
    btn2 = types.KeyboardButton('üåä –°–º–µ–Ω–∏—Ç—å –≤–æ–¥–æ–µ–º')
    btn3 = types.KeyboardButton('üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞')
    btn4 = types.KeyboardButton('üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å')
    btn5 = types.KeyboardButton('üõí –ú–∞–≥–∞–∑–∏–Ω')
    btn6 = types.KeyboardButton('üí∞ –ü—Ä–æ–¥–∞—Ç—å —Ä—ã–±—É')
    btn7 = types.KeyboardButton('üé£ –í—ã–±—Ä–∞—Ç—å –ø—Ä–∏–º–∞–Ω–∫—É')
    btn8 = types.KeyboardButton('‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏')  # ‚Üê –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê
    btn9 = types.KeyboardButton('üìú –ó–∞–¥–∞–Ω–∏—è')
    btn10 = types.KeyboardButton('üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤')
    btn11 = types.KeyboardButton('üì∞ –ù–æ–≤–æ—Å—Ç–∏')
    btn12 = types.KeyboardButton('üí∞ –î–æ–Ω–∞—Ç')
    btn13 = types.KeyboardButton('‚ùì –ü–æ–º–æ—â—å')
    
    if user_id and is_admin(user_id):
        btn14 = types.KeyboardButton('üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å')
        markup.add(btn1, btn2, btn3, btn4, btn5, btn6, btn7, btn8, btn9, btn10, btn11, btn12, btn13, btn14)
    else:
        markup.add(btn1, btn2, btn3, btn4, btn5, btn6, btn7, btn8, btn9, btn10, btn11, btn12, btn13)
    
    return markup

def create_fishing_keyboard():
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn1 = types.KeyboardButton('üé£ –ó–∞–±—Ä–æ—Å–∏—Ç—å —É–¥–æ—á–∫—É')
    btn2 = types.KeyboardButton('üìã –ú–µ–Ω—é')
    markup.add(btn1, btn2)
    return markup

def create_admin_keyboard(admin_level):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    
    # –£—Ä–æ–≤–µ–Ω—å 1 - –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–≤–∫–ª—é—á–∞—è –¥–æ–Ω–∞—Ç)
    if admin_level >= 1:
        btn1 = types.KeyboardButton('üö´ –ë–∞–Ω/–†–∞–∑–±–∞–Ω')
        btn2 = types.KeyboardButton('üîá –ú—É—Ç/–†–∞–∑–º—É—Ç')
        btn3 = types.KeyboardButton('‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ')
        btn4 = types.KeyboardButton('üí∞ –í—ã–¥–∞—Ç—å –¥–æ–Ω–∞—Ç')
        markup.add(btn1, btn2, btn3, btn4)
    
    # –£—Ä–æ–≤–µ–Ω—å 2 - –õ–æ–≥–∏ –∏ –∞–¥–º–∏–Ω—ã
    if admin_level >= 2:
        btn5 = types.KeyboardButton('üìú –õ–æ–≥–∏ –±–∞–Ω–æ–≤')
        btn6 = types.KeyboardButton('üìã –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤')
        btn7 = types.KeyboardButton('üë§ –ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞')
        markup.add(btn5, btn6, btn7)
    
    # –£—Ä–æ–≤–µ–Ω—å 3 - –í—ã–¥–∞—á–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
    if admin_level >= 3:
        btn8 = types.KeyboardButton('üé£ –í—ã–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã')
        btn9 = types.KeyboardButton('üí∞ –í—ã–¥–∞—Ç—å –º–æ–Ω–µ—Ç—ã')
        btn10 = types.KeyboardButton('üåü –í—ã–¥–∞—Ç—å –æ–ø—ã—Ç')
        markup.add(btn8, btn9, btn10)
    
    # –£—Ä–æ–≤–µ–Ω—å 4 - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    if admin_level >= 4:
        btn11 = types.KeyboardButton('üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞')
        btn12 = types.KeyboardButton('üë§ –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∞')
        btn13 = types.KeyboardButton('üîÑ –°–±—Ä–æ—Å –∏–≥—Ä–æ–∫–∞')
        markup.add(btn11, btn12, btn13)
    
    # –£—Ä–æ–≤–µ–Ω—å 5 - –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    if admin_level >= 5:
        btn14 = types.KeyboardButton('‚öôÔ∏è –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ')
        btn15 = types.KeyboardButton('üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏')
        btn16 = types.KeyboardButton('üì¢ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å')
        btn17 = types.KeyboardButton('üìú –í—Å–µ –ª–æ–≥–∏')
        markup.add(btn14, btn15, btn16, btn17)
    
    btn_back = types.KeyboardButton('üìã –ú–µ–Ω—é')
    markup.add(btn_back)
    
    return markup

def ban_user_in_group(chat_id, user_id, user_name, reason="–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª", days=2):
    try:
        until_date = int(time.time()) + (days * 86400)
        bot.ban_chat_member(chat_id, user_id, until_date=until_date)
        ban_message = f"üö´ {user_name} –∑–∞–±–∞–Ω–µ–Ω –Ω–∞ {days} –¥–Ω–µ–π!\n‚ö†Ô∏è –ü—Ä–∏—á–∏–Ω–∞: {reason}"
        bot.send_message(chat_id, ban_message)
        
        # –õ–æ–≥–∏—Ä—É–µ–º –±–∞–Ω
        db.log_action(user_id, "banned", f"–í —á–∞—Ç–µ {chat_id}, –ø—Ä–∏—á–∏–Ω–∞: {reason}, –¥–Ω–µ–π: {days}")
        return True
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –±–∞–Ω–∞: {e}")
        try:
            ban_message = f"üö´ {user_name} –ø–æ–ª—É—á–∏–ª –±–∞–Ω –Ω–∞ {days} –¥–Ω–µ–π! –ü—Ä–∏—á–∏–Ω–∞: {reason}"
            bot.send_message(chat_id, ban_message)
        except:
            pass
        return False

def mute_user_in_group(chat_id, user_id, user_name, minutes=60, reason="–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª"):
    try:
        until_date = int(time.time()) + (minutes * 60)
        bot.restrict_chat_member(chat_id, user_id, until_date=until_date, can_send_messages=False)
        mute_message = f"üîá {user_name} –∑–∞–º—É—á–µ–Ω –Ω–∞ {minutes} –º–∏–Ω—É—Ç!\n‚ö†Ô∏è –ü—Ä–∏—á–∏–Ω–∞: {reason}"
        bot.send_message(chat_id, mute_message)
        
        # –õ–æ–≥–∏—Ä—É–µ–º –º—É—Ç
        db.log_action(user_id, "muted", f"–í —á–∞—Ç–µ {chat_id}, –ø—Ä–∏—á–∏–Ω–∞: {reason}, –º–∏–Ω—É—Ç: {minutes}")
        return True
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –º—É—Ç–∞: {e}")
        try:
            mute_message = f"üîá {user_name} –ø–æ–ª—É—á–∏–ª –º—É—Ç –Ω–∞ {minutes} –º–∏–Ω—É—Ç! –ü—Ä–∏—á–∏–Ω–∞: {reason}"
            bot.send_message(chat_id, mute_message)
        except:
            pass
        return False

def delete_links_in_group(message):
    if message.chat.type in ['group', 'supergroup']:
        text = message.text or message.caption or ""
        
        if URL_PATTERN.search(text):
            all_matches = URL_PATTERN.findall(text)
            has_other_links = False
            
            for match_group in all_matches:
                for match in match_group:
                    if match and not USERNAME_PATTERN.fullmatch(match):
                        has_other_links = True
                        break
                if has_other_links:
                    break
            
            if has_other_links:
                try:
                    user = message.from_user
                    user_id = str(user.id)
                    chat_id = message.chat.id
                    
                    if db.is_banned(user_id):
                        ban_time_left = db.get_ban_time_left(user_id)
                        days_left = int(ban_time_left // 86400)
                        hours_left = int((ban_time_left % 86400) // 3600)
                        minutes_left = int((ban_time_left % 3600) // 60)
                        
                        ban_message = (
                            f"üö´ {user.first_name}, —Ç—ã —É–∂–µ –∑–∞–±–∞–Ω–µ–Ω!\n"
                            f"‚è≥ –ë–∞–Ω –∏—Å—Ç–µ—á–µ—Ç —á–µ—Ä–µ–∑: {days_left}–¥ {hours_left}—á {minutes_left}–º–∏–Ω"
                        )
                        bot.send_message(chat_id, ban_message)
                        return True
                    
                    bot.delete_message(chat_id, message.message_id)
                    banned, warning_count, is_ban = db.add_warning(user_id, chat_id)
                    
                    if is_ban:
                        ban_user_in_group(chat_id, user.id, user.first_name, "2 —Å—Å—ã–ª–∫–∏ –∑–∞ 24 —á–∞—Å–∞")
                    else:
                        warning_message = (
                            f"‚ö†Ô∏è {user.first_name}, –¥–∞—é –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ!\n"
                            f"–ù–∞ 2 —Ä–∞–∑ –¥–∞—é –±–∞–Ω, –Ω–µ –∫–∏–¥–∞–π —Å—Å—ã–ª–∫–∏\n"
                            f"üìä –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: {warning_count}/2"
                        )
                        bot.send_message(chat_id, warning_message)
                    
                except Exception as e:
                    print(f"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏: {e}")
                return True
    return False

# ========== –û–°–ù–û–í–ù–´–ï –ö–û–ú–ê–ù–î–´ ==========
@bot.message_handler(commands=['start'])
def start_command(message):
    user = message.from_user
    user_data = db.get_user(user.id)
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
    if user.username:
        user_data['username'] = user.username
    user_data['first_name'] = user.first_name
    db.save_data()
    
    if db.is_banned(str(user.id)):
        ban_time_left = db.get_ban_time_left(user.id)
        days_left = int(ban_time_left // 86400)
        hours_left = int((ban_time_left % 86400) // 3600)
        minutes_left = int((ban_time_left % 3600) // 60)
        
        ban_text = (
            f"üö´ {user.first_name}, —Ç—ã –∑–∞–±–∞–Ω–µ–Ω!\n\n"
            f"‚è≥ –ë–∞–Ω –∏—Å—Ç–µ—á–µ—Ç —á–µ—Ä–µ–∑: {days_left}–¥ {hours_left}—á {minutes_left}–º–∏–Ω\n"
            f"–û–∂–∏–¥–∞–π—Ç–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –±–∞–Ω–∞ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –∏–≥—Ä—ã."
        )
        bot.send_message(message.chat.id, ban_text)
        return
    
    welcome_text = (
        f"üé£ –ü—Ä–∏–≤–µ—Ç, {user.first_name}!\n"
        f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä —Ä—ã–±–∞–ª–∫–∏!\n\n"
        f"üìç –¢–µ–∫—É—â–∏–π –≤–æ–¥–æ–µ–º: {user_data['current_location']}\n"
        f"üêõ –ß–µ—Ä–≤—è–∫–æ–≤: {user_data['worms']}/10\n"
        f"üí∞ {COINS_NAME}: {user_data['coins']}\n"
        f"üêü –í—Å–µ–≥–æ –ø–æ–π–º–∞–Ω–æ: {user_data['total_fish']}\n"
        f"üé£ –£—Ä–æ–≤–µ–Ω—å: {user_data['fishing_level']}\n\n"
        f"‚ôªÔ∏è –ß–µ—Ä–≤—è–∫–∏ –ø–æ–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç!\n"
        f"üåä –ú–µ–Ω—è–π—Ç–µ –≤–æ–¥–æ–µ–º—ã –¥–ª—è —Ä–∞–∑–Ω–æ–π —Ä—ã–±—ã!\n\n"
        f"–ò—Å–ø–æ–ª—å–∑—É–π –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ –¥–ª—è –∏–≥—Ä—ã!\n\n"
        f"–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å: ||2200702034105283||"
    )
    
    bot.send_message(message.chat.id, welcome_text, reply_markup=create_main_keyboard(user.id))

@bot.message_handler(commands=['help'])
def help_command(message):
    help_text = (
        "üé£ *–ü–æ–º–æ—â—å –ø–æ –∏–≥—Ä–µ \"–†—ã–±–∞–ª–∫–∞\"*\n\n"
        "üìã *–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*\n"
        "/start - –ù–∞—á–∞—Ç—å –∏–≥—Ä—É\n"
        "/fishing - –ù–∞—á–∞—Ç—å —Ä—ã–±–∞–ª–∫—É\n"
        "/location - –°–º–µ–Ω–∏—Ç—å –≤–æ–¥–æ–µ–º\n"
        "/stats - –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
        "/inventory - –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–ª–æ–≤—ã\n"
        "/shop - –ú–∞–≥–∞–∑–∏–Ω —Å–Ω–∞—Å—Ç–µ–π\n"
        "/sell - –ü—Ä–æ–¥–∞—Ç—å —Ä—ã–±—É\n"
        "/quests - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è\n"
        "/top - –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤\n"
        "/news - –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏\n"
        "/donate - –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç\n"
        "/help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n\n"
        "üéÆ *–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:*\n"
        "1Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ –≤–æ–¥–æ–µ–º –¥–ª—è —Ä—ã–±–∞–ª–∫–∏ üåä\n"
        "2Ô∏è‚É£ –ö—É–ø–∏—Ç–µ –ø—Ä–∏–º–∞–Ω–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ üõí\n"
        "3Ô∏è‚É£ –ö–∞–∂–¥–∞—è —Ä—ã–±–∞–ª–∫–∞ —Ç—Ä–∞—Ç–∏—Ç 1 —á–µ—Ä–≤—è–∫–∞\n"
        "4Ô∏è‚É£ –ß–µ—Ä–≤—è–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è (1 –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç)\n"
        "5Ô∏è‚É£ –†–∞–∑–Ω–∞—è —Ä—ã–±–∞ –≤–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –≤–æ–¥–æ–µ–º–∞—Ö\n"
        "6Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –ø—Ä–∏–º–∞–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω–æ–π —Ä—ã–±—ã\n\n"
        "üêü *–†–µ–¥–∫–æ—Å—Ç–∏ —Ä—ã–±—ã:*\n"
        "‚Ä¢ üêü –û–±—ã—á–Ω–∞—è (50%)\n"
        "‚Ä¢ üê† –†–µ–¥–∫–∞—è (30%)\n"
        "‚Ä¢ üåü –≠–ø–∏—á–µ—Å–∫–∞—è (15%)\n"
        "‚Ä¢ üëë –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è (4%)\n"
        "‚Ä¢ üóëÔ∏è –ú—É—Å–æ—Ä (1%)\n\n"
        "üåä *–í–æ–¥–æ–µ–º—ã:*\n"
        "‚Ä¢ 10 —Ä–µ–∞–ª—å–Ω—ã—Ö –≤–æ–¥–æ–µ–º–æ–≤ –†–æ—Å—Å–∏–∏\n"
        "‚Ä¢ –í –∫–∞–∂–¥–æ–º —Å–≤–æ—è —Ä—ã–±–∞\n"
        "‚Ä¢ –ú–µ–Ω—è–π—Ç–µ –≤–æ–¥–æ–µ–º—ã –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è\n\n"
        "üõí *–ú–∞–≥–∞–∑–∏–Ω:*\n"
        "‚Ä¢ –ü–æ–∫—É–ø–∞–π—Ç–µ —á–µ—Ä–≤–µ–π –∏ —Å–Ω–∞—Å—Ç–∏\n"
        "‚Ä¢ –†–∞–∑–Ω—ã–µ –ø—Ä–∏–º–∞–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω–æ–π —Ä—ã–±—ã\n"
        "‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω—ã–µ —É–¥–æ—á–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —à–∞–Ω—Å—ã\n"
        "‚Ä¢ –£–¥–æ—á–∫–∏ –º–æ–≥—É—Ç –ª–æ–º–∞—Ç—å—Å—è - —É–ª—É—á—à–∞–π—Ç–µ –∏—Ö\n\n"
        "üí∞ *–ü—Ä–æ–¥–∞–∂–∞ —Ä—ã–±—ã:*\n"
        "‚Ä¢ –ü—Ä–æ–¥–∞–≤–∞–π—Ç–µ —Ä—ã–±—É NPC-—Ç–æ—Ä–≥–æ–≤—Ü–∞–º\n"
        "‚Ä¢ –†–∞–∑–Ω—ã–µ NPC –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç —Ä–∞–∑–Ω—É—é —Ä—ã–±—É\n"
        "‚Ä¢ –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º–∞—è —Ä—ã–±–∞ –¥–æ—Ä–æ–∂–µ –Ω–∞ 50%\n\n"
        "‚öñÔ∏è *–ü—Ä–∞–≤–∏–ª–∞ —á–∞—Ç–∞ (–≤ –≥—Ä—É–ø–ø–∞—Ö):*\n"
        "‚Ä¢ –ó–∞–ø—Ä–µ—â–µ–Ω—ã –ª—é–±—ã–µ —Å—Å—ã–ª–∫–∏ (–∫—Ä–æ–º–µ @username)\n"
        "‚Ä¢ 1 —Å—Å—ã–ª–∫–∞ = –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ\n"
        "‚Ä¢ 2 —Å—Å—ã–ª–∫–∏ –∑–∞ 24 —á–∞—Å–∞ = –±–∞–Ω –Ω–∞ 2 –¥–Ω—è –≤ –≥—Ä—É–ø–ø–µ\n"
        "‚Ä¢ @username —Ä–∞–∑—Ä–µ—à–µ–Ω—ã\n\n"
        "üí∞ *–î–æ–Ω–∞—Ç:*\n"
        "‚Ä¢ –ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–æ–µ–∫—Ç–∞\n"
        "‚Ä¢ –ü–æ–ª—É—á–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è\n"
        "‚Ä¢ –£—Å–∫–æ—Ä—å—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å\n\n"
        "–£–¥–∞—á–∏ –Ω–∞ —Ä—ã–±–∞–ª–∫–µ! üé£"
    )
    
    bot.send_message(message.chat.id, help_text, reply_markup=create_main_keyboard(message.from_user.id))

@bot.message_handler(commands=['location', '–≤–æ–¥–æ–µ–º'])
def location_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    user_data = db.get_user(user.id)
    
    markup = types.InlineKeyboardMarkup(row_width=2)
    for i, water_body in enumerate(WATER_BODIES):
        btn = types.InlineKeyboardButton(
            f"{water_body['emoji']} {water_body['name']} ({water_body['difficulty']})",
            callback_data=f'select_location_{i}'
        )
        markup.add(btn)
    
    btn_back = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
    markup.add(btn_back)
    
    location_text = (
        f"üåä *–í—ã–±–æ—Ä –≤–æ–¥–æ–µ–º–∞*\n\n"
        f"üìç –¢–µ–∫—É—â–∏–π –≤–æ–¥–æ–µ–º: {user_data['current_location']}\n\n"
        f"–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π –≤–æ–¥–æ–µ–º –¥–ª—è —Ä—ã–±–∞–ª–∫–∏:\n\n"
        f"–ö–∞–∂–¥—ã–π –≤–æ–¥–æ–µ–º –∏–º–µ–µ—Ç —Å–≤–æ—é —Ä—ã–±—É –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å."
    )
    
    bot.send_message(message.chat.id, location_text, reply_markup=markup)

@bot.message_handler(commands=['stats'])
def stats_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    user_data = db.get_user(user.id)
    total = user_data['total_fish']
    
    if total > 0:
        luck_rate = ((user_data['stats']['epic'] + user_data['stats']['legendary']) / total * 100)
        trash_rate = (user_data['stats']['trash'] / total * 100)
    else:
        luck_rate = trash_rate = 0
    
    warning_count = db.get_warning_count(user.id)
    
    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É–¥–æ—á–∫–µ
    current_rod = user_data['current_rod']
    rod_data = db.get_user_rod(user.id, current_rod)
    rod_durability = f"{rod_data['durability']}/{rod_data['max_durability']}" if rod_data else "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
    
    stats_text = (
        f"üìä *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ {user.first_name}*\n\n"
        f"üìç –í–æ–¥–æ–µ–º: {user_data['current_location']}\n"
        f"üêõ –ß–µ—Ä–≤—è–∫–æ–≤: {user_data['worms']}/10\n"
        f"üí∞ {COINS_NAME}: {user_data['coins']}\n"
        f"üí∞ –í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: {user_data.get('total_coins_earned', 0)}\n"
        f"üé£ –£—Ä–æ–≤–µ–Ω—å: {user_data['fishing_level']}\n"
        f"üìà –û–ø—ã—Ç: {user_data['experience']}/{user_data['fishing_level'] * 100}\n"
        f"‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: {warning_count}/2\n\n"
        f"üé£ *–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ:*\n"
        f"‚Ä¢ –£–¥–æ—á–∫–∞: {current_rod}\n"
        f"‚Ä¢ –ü—Ä–æ—á–Ω–æ—Å—Ç—å: {rod_durability}\n"
        f"‚Ä¢ –ü—Ä–∏–º–∞–Ω–∫–∞: {user_data['current_bait']}\n"
        f"‚Ä¢ –ë–æ–Ω—É—Å —É–¥–∞—á–∏: +{user_data.get('luck_bonus', 0)*100:.0f}%\n\n"
        f"üêü *–ü–æ–π–º–∞–Ω–æ:*\n"
        f"‚Ä¢ üêü –û–±—ã—á–Ω—ã—Ö: {user_data['stats']['common']}\n"
        f"‚Ä¢ üê† –†–µ–¥–∫–∏—Ö: {user_data['stats']['rare']}\n"
        f"‚Ä¢ üåü –≠–ø–∏—á–µ—Å–∫–∏—Ö: {user_data['stats']['epic']}\n"
        f"‚Ä¢ üëë –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã—Ö: {user_data['stats']['legendary']}\n"
        f"‚Ä¢ üóëÔ∏è –ú—É—Å–æ—Ä–∞: {user_data['stats']['trash']}\n\n"
        f"üéØ –£–¥–∞—á–∞: {luck_rate:.1f}% | –ú—É—Å–æ—Ä: {trash_rate:.1f}%\n"
        f"üé£ –í—Å–µ–≥–æ –ø–æ–ø—ã—Ç–æ–∫: {user_data['total_fish']}"
    )
    bot.send_message(message.chat.id, stats_text, reply_markup=create_main_keyboard(user.id))

@bot.message_handler(commands=['inventory'])
def inventory_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    user_data = db.get_user(user.id)
    
    inventory_text = f"üéí *–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å {user.first_name}*\n\n"
    
    # –†—ã–±–∞
    if user_data['inventory']['fish']:
        inventory_text += "üêü *–†—ã–±–∞:*\n"
        for fish_name, count in user_data['inventory']['fish'].items():
            # –ù–∞—Ö–æ–¥–∏–º —Ü–µ–Ω—É —Ä—ã–±—ã
            fish_price = 0
            for fish in FISHES:
                if fish['name'] == fish_name:
                    fish_price = fish.get('price', 0)
                    break
            inventory_text += f"‚Ä¢ {fish_name}: {count} —à—Ç (–ø–æ {fish_price}—Ä)\n"
        inventory_text += "\n"
    else:
        inventory_text += "üêü –†—ã–±—ã –Ω–µ—Ç\n\n"
    
    # –ü—Ä–∏–º–∞–Ω–∫–∏
    if user_data['inventory']['baits']:
        inventory_text += "üé£ *–ü—Ä–∏–º–∞–Ω–∫–∏:*\n"
        for bait in user_data['inventory']['baits']:
            inventory_text += f"‚Ä¢ {bait['name']}: {bait['count']} —à—Ç\n"
        inventory_text += "\n"
    
    # –£–¥–æ—á–∫–∏
    if user_data['inventory']['rods']:
        inventory_text += "üé£ *–£–¥–æ—á–∫–∏:*\n"
        for rod in user_data['inventory']['rods']:
            equipped = "‚úÖ" if rod.get('equipped', False) else ""
            durability = f"{rod.get('durability', 0)}/{rod.get('max_durability', 100)}"
            unbreakable = "üõ°Ô∏è" if rod.get('unbreakable', False) else ""
            inventory_text += f"‚Ä¢ {rod['name']} {equipped} {unbreakable}\n"
            inventory_text += f"  –ü—Ä–æ—á–Ω–æ—Å—Ç—å: {durability}\n"
            if rod.get('upgrades'):
                inventory_text += f"  –£–ª—É—á—à–µ–Ω–∏—è: {', '.join(rod['upgrades'])}\n"
    
    bot.send_message(message.chat.id, inventory_text, reply_markup=create_main_keyboard(user.id))

@bot.message_handler(commands=['shop'])
def shop_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    markup = types.InlineKeyboardMarkup(row_width=2)
    btn1 = types.InlineKeyboardButton('ü™± –ü—Ä–∏–º–∞–Ω–∫–∏', callback_data='shop_baits')
    btn2 = types.InlineKeyboardButton('üé£ –£–¥–æ—á–∫–∏', callback_data='shop_rods')
    btn3 = types.InlineKeyboardButton('‚öôÔ∏è –£–ª—É—á—à–µ–Ω–∏—è', callback_data='shop_upgrades')
    btn4 = types.InlineKeyboardButton('üêõ –ö—É–ø–∏—Ç—å —á–µ—Ä–≤—è–∫–æ–≤', callback_data='shop_worms')
    btn5 = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
    markup.add(btn1, btn2, btn3, btn4, btn5)
    
    user_data = db.get_user(user.id)
    shop_text = (
        f"üõí *–ú–∞–≥–∞–∑–∏–Ω —Ä—ã–±–æ–ª–æ–≤–Ω—ã—Ö —Å–Ω–∞—Å—Ç–µ–π*\n\n"
        f"üí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user_data['coins']} {COINS_NAME}\n\n"
        f"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
    )
    
    bot.send_message(message.chat.id, shop_text, reply_markup=markup)

@bot.message_handler(commands=['sell'])
def sell_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    user_data = db.get_user(user.id)
    
    if not user_data['inventory']['fish']:
        bot.send_message(message.chat.id, "üé£ –£ –≤–∞—Å –Ω–µ—Ç —Ä—ã–±—ã –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏!", reply_markup=create_main_keyboard(user.id))
        return
    
    markup = types.InlineKeyboardMarkup(row_width=2)
    
    # –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è NPC-–ø—Ä–æ–¥–∞–≤—Ü–æ–≤
    for i, npc in enumerate(NPC_SELLERS):
        btn = types.InlineKeyboardButton(f"{npc['emoji']} {npc['name']}", callback_data=f'sell_npc_{i}')
        markup.add(btn)
    
    btn_back = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
    markup.add(btn_back)
    
    sell_text = (
        f"üí∞ *–ü—Ä–æ–¥–∞–∂–∞ —Ä—ã–±—ã*\n\n"
        f"üêü –í–∞—à–∞ —Ä—ã–±–∞:\n"
    )
    
    for fish_name, count in user_data['inventory']['fish'].items():
        # –ù–∞—Ö–æ–¥–∏–º –±–∞–∑–æ–≤—É—é —Ü–µ–Ω—É
        base_price = 0
        for fish in FISHES:
            if fish['name'] == fish_name:
                base_price = fish.get('price', 0)
                break
        
        if base_price > 0:
            sell_text += f"‚Ä¢ {fish_name}: {count} —à—Ç (–ø–æ {base_price} {COINS_NAME})\n"
    
    sell_text += "\n–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è:"
    
    bot.send_message(message.chat.id, sell_text, reply_markup=markup)

@bot.message_handler(commands=['quests'])
def quests_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    user_data = db.get_user(user.id)
    daily_quests = db.get_daily_quests(user.id)
    
    quests_text = f"üìú *–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è*\n\n"
    quests_text += f"‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è: {user_data['quests_completed_today']}/3\n\n"
    
    for quest_id, quest_data in daily_quests.items():
        quest = next((q for q in DAILY_QUESTS if q['id'] == quest_id), None)
        if quest:
            status = "‚úÖ" if quest_data['completed'] else f"{quest_data['progress']}/{quest['target']}"
            quests_text += f"{quest['emoji'] if 'emoji' in quest else 'üéØ'} *{quest['name']}*\n"
            quests_text += f"üìù {quest['description']}\n"
            quests_text += f"üìä –ü—Ä–æ–≥—Ä–µ—Å—Å: {status}\n"
            quests_text += f"üí∞ –ù–∞–≥—Ä–∞–¥–∞: {quest['reward']} {COINS_NAME}\n\n"
    
    if not daily_quests:
        quests_text += "üéØ –ó–∞–¥–∞–Ω–∏—è –æ–±–Ω–æ–≤—è—Ç—Å—è –∑–∞–≤—Ç—Ä–∞!"
    
    bot.send_message(message.chat.id, quests_text, reply_markup=create_main_keyboard(user.id))

@bot.message_handler(commands=['top', '—Ç–æ–ø'])
def top_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    markup = types.InlineKeyboardMarkup(row_width=3)
    btn1 = types.InlineKeyboardButton('üí∞ –ü–æ —Ä—ã–±–æ–ø', callback_data='top_coins')
    btn2 = types.InlineKeyboardButton('üêü –ü–æ —Ä—ã–±–µ', callback_data='top_fish')
    btn3 = types.InlineKeyboardButton('üé£ –ü–æ —É—Ä–æ–≤–Ω—é', callback_data='top_level')
    btn4 = types.InlineKeyboardButton('üåü –ü–æ —Ä–µ–¥–∫–æ—Å—Ç—è–º', callback_data='top_rare')
    btn5 = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
    markup.add(btn1, btn2, btn3, btn4, btn5)
    
    top_text = (
        f"üèÜ *–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤*\n\n"
        f"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–æ–ø–∞:"
    )
    
    bot.send_message(message.chat.id, top_text, reply_markup=markup)

@bot.message_handler(commands=['news', '–Ω–æ–≤–æ—Å—Ç–∏'])
def news_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    if not db.news:
        bot.send_message(message.chat.id, "üì∞ –ù–æ–≤–æ—Å—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç!", reply_markup=create_main_keyboard(user.id))
        return
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –Ω–æ–≤–æ—Å—Ç–µ–π
    news_text = "üì∞ *–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏*\n\n"
    
    for news_item in db.news[-5:][::-1]:  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5, –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
        timestamp = datetime.fromisoformat(news_item['timestamp']).strftime("%d.%m.%Y %H:%M")
        news_text += f"üìÖ *{news_item['title']}*\n"
        news_text += f"üìù {news_item['content']}\n"
        news_text += f"‚è∞ {timestamp}\n\n"
        news_text += "‚îÄ" * 30 + "\n\n"
    
    bot.send_message(message.chat.id, news_text, reply_markup=create_main_keyboard(user.id))

@bot.message_handler(commands=['donate', '–¥–æ–Ω–∞—Ç'])
def donate_command(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    markup = types.InlineKeyboardMarkup(row_width=2)
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–∞–∫–µ—Ç—ã –ø–æ —Ç–∏–ø–∞–º
    upgrades = [p for p in DONATE_PACKAGES if p['type'] == 'upgrade']
    rods = [p for p in DONATE_PACKAGES if p['type'] == 'rod']
    coins = [p for p in DONATE_PACKAGES if p['type'] == 'coins']
    packs = [p for p in DONATE_PACKAGES if p['type'] == 'pack']
    
    # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
    btn1 = types.InlineKeyboardButton('üõ°Ô∏è –£–ª—É—á—à–µ–Ω–∏—è', callback_data='donate_upgrades')
    btn2 = types.InlineKeyboardButton('üé£ –£–¥–æ—á–∫–∏', callback_data='donate_rods')
    btn3 = types.InlineKeyboardButton('üí∞ –†—ã–±–æ–ø', callback_data='donate_coins')
    btn4 = types.InlineKeyboardButton('üéÅ –ù–∞–±–æ—Ä—ã', callback_data='donate_packs')
    btn5 = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
    markup.add(btn1, btn2, btn3, btn4, btn5)
    
    donate_text = (
        f"üí∞ *–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç*\n\n"
        f"üíñ –í–∞—à–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å –±–æ—Ç–∞!\n\n"
        f"üéÅ *–ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ:*\n"
        f"‚Ä¢ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è\n"
        f"‚Ä¢ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É–¥–æ—á–∫–∏\n"
        f"‚Ä¢ –ò–≥—Ä–æ–≤—É—é –≤–∞–ª—é—Ç—É\n"
        f"‚Ä¢ –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞\n\n"
        f"üìû *–î–ª—è —Å–≤—è–∑–∏:* @Belka759\n"
        f"üí≥ *–ö–∞—Ä—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:* ||2200702034105283||\n\n"
        f"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
    )
    
    bot.send_message(message.chat.id, donate_text, reply_markup=markup)

@bot.message_handler(commands=['fishing'])
def fishing_command_handler(message):
    user = message.from_user
    if db.is_banned(str(user.id)):
        return
    
    user_id = str(user.id)
    user_data = db.get_user(user.id)
    
    if user_data['worms'] <= 0:
        current_time = time.time()
        last_refill = user_data.get('last_worm_refill', current_time)
        next_worm_in = WORM_REFILL_TIME - (current_time - last_refill)
        
        if next_worm_in > 0:
            minutes = int(next_worm_in // 60)
            seconds = int(next_worm_in % 60)
            bot.send_message(message.chat.id,
                           f"üòî –ß–µ—Ä–≤—è–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å!\n"
                           f"–°–ª–µ–¥—É—é—â–∏–π —á–µ—Ä–≤—è–∫ —á–µ—Ä–µ–∑: {minutes} –º–∏–Ω {seconds} —Å–µ–∫",
                           reply_markup=create_main_keyboard(user.id))
        else:
            user_data['worms'] = min(user_data['worms'] + 1, MAX_WORMS)
            user_data['last_worm_refill'] = current_time
            db.save_data()
            bot.send_message(message.chat.id,
                           f"üéâ –ß–µ—Ä–≤—è–∫–∏ –ø–æ–ø–æ–ª–Ω–∏–ª–∏—Å—å! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å {user_data['worms']} —á–µ—Ä–≤—è–∫–æ–≤.",
                           reply_markup=create_main_keyboard(user.id))
        return
    
    success, worms_left = db.use_worm(user.id)
    
    if not success:
        bot.send_message(message.chat.id, "–û—à–∏–±–∫–∞! –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—á–∞—Ç—å —Ä—ã–±–∞–ª–∫—É.")
        return
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∏–ª–∏ –ª—é–±—É—é –¥—Ä—É–≥—É—é –ø—Ä–∏–º–∞–Ω–∫—É
    selected_bait = user_data.get('current_bait', 'üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å')
    bait_used = False

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –≤—ã–±—Ä–∞–Ω–Ω–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞
    has_bait = False
    for bait in user_data['inventory']['baits']:
        if bait['name'] == selected_bait and bait['count'] > 0:
            has_bait = True
            break

    if has_bait:
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø—Ä–∏–º–∞–Ω–∫—É
        bait_used = db.use_bait(user.id, selected_bait)
    else:
        # –ò—â–µ–º –ª—é–±—É—é –¥—Ä—É–≥—É—é –ø—Ä–∏–º–∞–Ω–∫—É
        available_baits = []
        for bait in user_data['inventory']['baits']:
            if bait['count'] > 0:
                available_baits.extend([bait['name']] * bait['count'])
    
        if available_baits:
            selected_bait = random.choice(available_baits)
            bait_used = db.use_bait(user.id, selected_bait)
        else:
            selected_bait = "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å"
            bait_used = False
    
    # –°–Ω–∞—á–∞–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ —Ä—ã–±–∞–ª–∫–∏
    msg = bot.send_message(message.chat.id,
                          f"üé£ *–ù–∞—á–∞–ª–∞—Å—å —Ä—ã–±–∞–ª–∫–∞!*\n\n"
                          f"üìç –í–æ–¥–æ–µ–º: {user_data['current_location']}\n"
                          f"üé£ –ü—Ä–∏–º–∞–Ω–∫–∞: {selected_bait}\n"
                          f"üïê –û—Å—Ç–∞–ª–æ—Å—å —á–µ—Ä–≤—è–∫–æ–≤: {worms_left}",
                          reply_markup=create_fishing_keyboard())
    
    # –ù–ï–ú–ï–î–õ–ï–ù–ù–û –ª–æ–≤–∏–º —Ä—ã–±—É (–±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è 30 —Å–µ–∫—É–Ω–¥)
    caught_fish = calculate_catch(user_data, selected_bait)
    catch_info = db.add_fish(user.id, caught_fish)
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_data = db.get_user(user.id)
    
    # –£–º–µ–Ω—å—à–∞–µ–º –ø—Ä–æ—á–Ω–æ—Å—Ç—å —É–¥–æ—á–∫–∏
    current_rod = user_data['current_rod']
    rod_status = db.degrade_rod(user.id, current_rod, random.randint(1, 10))
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞–Ω–∏–π
    db.update_quest_progress(user.id, "catch")
    if caught_fish['rarity'] == "—Ä–µ–¥–∫–∞—è":
        db.update_quest_progress(user.id, "catch_rare")
    elif caught_fish['rarity'] == "—ç–ø–∏—á–µ—Å–∫–∞—è":
        db.update_quest_progress(user.id, "catch_epic")
    elif caught_fish['rarity'] == "–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è":
        db.update_quest_progress(user.id, "catch_legendary")
    
    rarity_emojis = {
        '–æ–±—ã—á–Ω–∞—è': 'üêü',
        '—Ä–µ–¥–∫–∞—è': 'üê†',
        '—ç–ø–∏—á–µ—Å–∫–∞—è': 'üåü',
        '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è': 'üëë',
        '–º—É—Å–æ—Ä': 'üóëÔ∏è'
    }
    
    bait_text = f"\nüé£ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –ø—Ä–∏–º–∞–Ω–∫–∞: {selected_bait}" if bait_used else ""
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–¥–æ—á–∫–∏
    rod_warning = ""
    if rod_status == "broken":
        rod_warning = "\n\n‚ö° *–í–Ω–∏–º–∞–Ω–∏–µ!* –í–∞—à–∞ —É–¥–æ—á–∫–∞ —Å–ª–æ–º–∞–ª–∞—Å—å!"
    elif rod_status == "low":
        rod_warning = "\n\n‚ö†Ô∏è *–í–Ω–∏–º–∞–Ω–∏–µ!* –£–¥–æ—á–∫–∞ –Ω–∞ –≥—Ä–∞–Ω–∏ –ø–æ–ª–æ–º–∫–∏! –£–ª—É—á—à–∏—Ç–µ –µ—ë –≤ –º–∞–≥–∞–∑–∏–Ω–µ."
    elif rod_status == "warning":
        rod_warning = "\n\n‚ö†Ô∏è –£–¥–æ—á–∫–∞ –∏–∑–Ω–æ—à–µ–Ω–∞. –ü–æ–¥—É–º–∞–π—Ç–µ –æ —Ä–µ–º–æ–Ω—Ç–µ."
    
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤–µ—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    weight = catch_info['weight']
    if weight < 1:
        weight_display = f"{int(weight*1000)}–≥"
    else:
        weight_display = f"{int(weight)}–∫–≥"
    
    result_text = (
        f"üéâ *–†—ã–±–∞–ª–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!*\n\n"
        f"{rarity_emojis.get(caught_fish['rarity'], 'üé£')} *–ü–æ–π–º–∞–Ω–æ:* {caught_fish['name']}\n"
        f"üìä *–†–µ–¥–∫–æ—Å—Ç—å:* {caught_fish['rarity']}\n"
        f"‚öñÔ∏è *–í–µ—Å:* {weight_display}\n"
        f"üìç *–ú–µ—Å—Ç–æ:* {catch_info['location']}\n"
        f"{bait_text}"
        f"{rod_warning}\n\n"
        f"üêõ –ß–µ—Ä–≤—è–∫–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å: {user_data['worms']}\n"
        f"üí∞ {COINS_NAME}: {user_data['coins']}\n"
        f"üêü –í—Å–µ–≥–æ –ø–æ–π–º–∞–Ω–æ: {user_data['total_fish']}\n\n"
    )
    
    if caught_fish['rarity'] == '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è':
        result_text += "üéä *–í–ê–£! –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —Ä—ã–±–∞!* üéä\n\n"
    elif caught_fish['rarity'] == '–º—É—Å–æ—Ä':
        result_text += "üòî –ù–µ –ø–æ–≤–µ–∑–ª–æ... –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!\n\n"
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    bot.send_message(message.chat.id, result_text, reply_markup=create_main_keyboard(user.id))

# –ü—Ä–∏–º–µ—Ä–Ω–æ —Å—Ç—Ä–æ–∫–∞ 1850
@bot.message_handler(commands=['–ø—Ä–∏–º–∞–Ω–∫–∞', 'bait'])
def select_bait_command(message):
    user = message.from_user
    user_data = db.get_user(user.id)
    
    if not user_data['inventory']['baits']:
        bot.send_message(message.chat.id, "üé£ –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∏–º–∞–Ω–æ–∫! –ö—É–ø–∏—Ç–µ –≤ –º–∞–≥–∞–∑–∏–Ω–µ.", 
                        reply_markup=create_main_keyboard(user.id))
        return
    
    markup = types.InlineKeyboardMarkup(row_width=2)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –ø—Ä–∏–º–∞–Ω–∫–∏
    for bait in user_data['inventory']['baits']:
        if bait['count'] > 0:
            btn = types.InlineKeyboardButton(
                f"{bait['name']} ({bait['count']} —à—Ç)", 
                callback_data=f'select_bait_{bait["name"]}'
            )
            markup.add(btn)
    
    btn_menu = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
    markup.add(btn_menu)
    
    text = f"üé£ *–í—ã–±–æ—Ä –ø—Ä–∏–º–∞–Ω–∫–∏*\n\n–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–º–∞–Ω–∫—É –¥–ª—è —Ä—ã–±–∞–ª–∫–∏:\n\n–¢–µ–∫—É—â–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞: {user_data.get('current_bait', 'üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å')}"
    bot.send_message(message.chat.id, text, reply_markup=markup)

# ========== –ù–ê–°–¢–†–û–ô–ö–ò ==========
@bot.message_handler(commands=['settings', '–Ω–∞—Å—Ç—Ä–æ–π–∫–∏'])
def settings_command(message):
    user = message.from_user
    user_data = db.get_user(user.id)
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    nickname = user_data.get('top_nickname', user.first_name)
    hide_from_top = user_data.get('hide_from_top', False)
    
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞—Å—Ç—Ä–æ–µ–∫
    markup = types.InlineKeyboardMarkup(row_width=2)
    
    # –ö–Ω–æ–ø–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∏–∫–∞
    btn_nickname = types.InlineKeyboardButton(
        f'üìù –ù–∏–∫ –≤ —Ç–æ–ø–µ: {nickname}', 
        callback_data='settings_change_nickname'
    )
    
    # –ö–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∏—è –∏–∑ —Ç–æ–ø–∞
    hide_text = "‚úÖ –°–∫—Ä—ã—Ç –∏–∑ —Ç–æ–ø–∞" if hide_from_top else "‚ùå –í–∏–¥–µ–Ω –≤ —Ç–æ–ø–µ"
    btn_hide = types.InlineKeyboardButton(
        f'üëÅÔ∏è {hide_text}', 
        callback_data='settings_toggle_hide'
    )
    
    # –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ –Ω–∏–∫–∞
    btn_reset = types.InlineKeyboardButton(
        'üîÑ –°–±—Ä–æ—Å–∏—Ç—å –Ω–∏–∫', 
        callback_data='settings_reset_nickname'
    )
    
    btn_back = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
    
    markup.add(btn_nickname, btn_hide, btn_reset, btn_back)
    
    settings_text = (
        f"‚öôÔ∏è *–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è*\n\n"
        f"üë§ –í–∞—à –Ω–∏–∫ –≤ —Ç–æ–ø–µ: *{nickname}*\n"
        f"üëÅÔ∏è –°—Ç–∞—Ç—É—Å –≤ —Ç–æ–ø–µ: {'*–°–∫—Ä—ã—Ç* üëª' if hide_from_top else '*–í–∏–¥–µ–Ω* üëÅÔ∏è'}\n\n"
        f"*–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:*\n"
        f"‚Ä¢ –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫ –¥–ª—è —Ç–æ–ø–∞\n"
        f"‚Ä¢ –°–∫—Ä—ã—Ç—å—Å—è –∏–∑ –æ–±—â–µ–≥–æ —Ç–æ–ø–∞\n"
        f"‚Ä¢ –°–±—Ä–æ—Å–∏—Ç—å –Ω–∏–∫ –∫ –∏–º–µ–Ω–∏\n"
    )
    
    bot.send_message(message.chat.id, settings_text, reply_markup=markup)

def process_nickname_input(message, user_id):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –Ω–æ–≤–æ–≥–æ –Ω–∏–∫–∞ –¥–ª—è —Ç–æ–ø–∞"""
    try:
        new_nickname = message.text.strip()
    
        # –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
        if len(new_nickname) > 20:
            bot.send_message(message.chat.id, 
                           "‚ùå –°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –Ω–∏–∫! –ú–∞–∫—Å–∏–º—É–º 20 —Å–∏–º–≤–æ–ª–æ–≤.",
                           reply_markup=create_main_keyboard(user_id))
            return
    
        if len(new_nickname) < 2:
            bot.send_message(message.chat.id, 
                           "‚ùå –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π –Ω–∏–∫! –ú–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞.",
                           reply_markup=create_main_keyboard(user_id))
            return
    
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º
        user_data = db.get_user(user_id)
        old_nickname = user_data.get('top_nickname', user_data.get('first_name', '–ò–≥—Ä–æ–∫'))
        user_data['top_nickname'] = new_nickname
        db.save_data()
    
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        bot.send_message(message.chat.id,
                        f"‚úÖ *–ù–∏–∫ –∏–∑–º–µ–Ω–µ–Ω!*\n\n"
                        f"–°—Ç–∞—Ä—ã–π: {old_nickname}\n"
                        f"–ù–æ–≤—ã–π: *{new_nickname}*\n\n"
                        f"–¢–µ–ø–µ—Ä—å –≤ —Ç–æ–ø–µ –±—É–¥–µ—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø–æ–¥ —ç—Ç–∏–º –Ω–∏–∫–æ–º!",
                        reply_markup=create_main_keyboard(user_id))
    
    except Exception as e:
        bot.send_message(message.chat.id,
                        f"‚ùå –û—à–∏–±–∫–∞: {str(e)}\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞: /–Ω–∞—Å—Ç—Ä–æ–π–∫–∏",
                        reply_markup=create_main_keyboard(user_id))

# ========== –ê–î–ú–ò–ù –ö–û–ú–ê–ù–î–´ 1 –£–†–û–í–ï–ù–¨ (–î–û–ù–ê–¢) ==========
@bot.message_handler(commands=['–≤—ã–¥–∞—Ç—å–¥–æ–Ω–∞—Ç', 'givedonate'])
def give_donate_command(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 3:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /–≤—ã–¥–∞—Ç—å–¥–æ–Ω–∞—Ç @username/id –∫–æ–¥_–ø–∞–∫–µ—Ç–∞")
        bot.send_message(message.chat.id, "–ü—Ä–∏–º–µ—Ä: /–≤—ã–¥–∞—Ç—å–¥–æ–Ω–∞—Ç @user 299RUBUNBR")
        return
    
    target = parts[1]
    package_code = parts[2]
    
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    # –ù–∞—Ö–æ–¥–∏–º –ø–∞–∫–µ—Ç –ø–æ –∫–æ–¥—É
    package = next((p for p in DONATE_PACKAGES if p['unique_code'] == package_code), None)
    if not package:
        bot.send_message(message.chat.id, "‚ùå –ü–∞–∫–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    # –í—ã–¥–∞–µ–º –ø–∞–∫–µ—Ç
    if package['type'] == 'upgrade':
        if package['unique_code'] == '299RUBUNBR':
            # –î–µ–ª–∞–µ–º –≤—Å–µ —É–¥–æ—á–∫–∏ –Ω–µ—Ä—É—à–∏–º—ã–º–∏
            for rod in target_user['inventory']['rods']:
                rod['unbreakable'] = True
            target_user['unbreakable_rods'] = True
            response = f"‚úÖ –í—ã–¥–∞–Ω–æ —É–ª—É—á—à–µ–Ω–∏–µ '–ù–µ—Ä—É—à–∏–º–æ—Å—Ç—å' –∏–≥—Ä–æ–∫—É {target_name}"
        elif package['unique_code'] == '200RUBLUCK':
            db.upgrade_rod(target_id, target_user['current_rod'], "luck_20")
            response = f"‚úÖ –í—ã–¥–∞–Ω–æ —É–ª—É—á—à–µ–Ω–∏–µ '–£–¥–∞—á–∞ +20%' –∏–≥—Ä–æ–∫—É {target_name}"

    elif package['type'] == 'rod':
        if package['unique_code'] == '499RUBSPIN':
            db.add_rod(target_id, "üé£ –ö–∞—Ä–±–æ–Ω–æ–≤—ã–π —Å–ø–∏–Ω–Ω–∏–Ω–≥")
            db.set_current_rod(target_id, "üé£ –ö–∞—Ä–±–æ–Ω–æ–≤—ã–π —Å–ø–∏–Ω–Ω–∏–Ω–≥")
            response = f"‚úÖ –í—ã–¥–∞–Ω–∞ —É–¥–æ—á–∫–∞ '–°–ø–∏–Ω–Ω–∏–Ω–≥ —Å —É–¥–∞—á–µ–π 30%' –∏–≥—Ä–æ–∫—É {target_name}"
    elif package['unique_code'] == '999RUBLEG':
        db.add_rod(target_id, "üèÜ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫–∞—Ä–ø–æ–≤–∞—è —É–¥–æ—á–∫–∞")
        db.set_current_rod(target_id, "üèÜ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫–∞—Ä–ø–æ–≤–∞—è —É–¥–æ—á–∫–∞")
        response = f"‚úÖ –í—ã–¥–∞–Ω–∞ '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —É–¥–æ—á–∫–∞' –∏–≥—Ä–æ–∫—É {target_name}"
    elif package['unique_code'] == '799RUBMAR':
        db.add_rod(target_id, "üé£ –ú–æ—Ä—Å–∫–æ–π —Å–ø–∏–Ω–Ω–∏–Ω–≥")
        db.set_current_rod(target_id, "üé£ –ú–æ—Ä—Å–∫–æ–π —Å–ø–∏–Ω–Ω–∏–Ω–≥")
        response = f"‚úÖ –í—ã–¥–∞–Ω '–ú–æ—Ä—Å–∫–æ–π —Å–ø–∏–Ω–Ω–∏–Ω–≥ PRO' –∏–≥—Ä–æ–∫—É {target_name}"

    elif package['type'] == 'coins':
        amount = package['amount']
        db.add_coins(target_id, amount)
        response = f"‚úÖ –í—ã–¥–∞–Ω–æ {amount} —Ä—ã–±–æ–ø –∏–≥—Ä–æ–∫—É {target_name}"

    elif package['type'] == 'pack':
        if package['unique_code'] == '399RUBSTART':
            db.add_coins(target_id, 500)
            db.add_rod(target_id, "üé£ –ú–µ–¥–∏—É–º —Å–ø–∏–Ω–Ω–∏–Ω–≥")
            db.add_bait(target_id, "üî¥ –ú–æ—Ç—ã–ª—å", 5)
            db.add_bait(target_id, "‚ö™ –ë–µ–ª—ã–π –æ–ø–∞—Ä—ã—à", 5)
            response = f"‚úÖ –í—ã–¥–∞–Ω '–°—Ç–∞—Ä—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä' –∏–≥—Ä–æ–∫—É {target_name}"
        elif package['unique_code'] == '899RUBPRO':
            db.add_coins(target_id, 2000)
            db.add_rod(target_id, "üé£ –•–µ–≤–∏ —Å–ø–∏–Ω–Ω–∏–Ω–≥")
            db.upgrade_rod(target_id, target_user['current_rod'], "luck_10")
            response = f"‚úÖ –í—ã–¥–∞–Ω '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä' –∏–≥—Ä–æ–∫—É {target_name}"
        elif package['unique_code'] == '1999RUBLEG':
            db.add_coins(target_id, 5000)
            db.add_rod(target_id, "üèÜ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫–∞—Ä–ø–æ–≤–∞—è —É–¥–æ—á–∫–∞")
            response = f"‚úÖ –í—ã–¥–∞–Ω '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –Ω–∞–±–æ—Ä' –∏–≥—Ä–æ–∫—É {target_name}"
    
    # –õ–æ–≥–∏—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
    db.log_admin_action(user.id, "give_donate", target_id, package['name'])
    db.log_action(target_id, "received_donate", package['name'])
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é –¥–æ–Ω–∞—Ç–∞
    if 'donate_history' not in target_user:
        target_user['donate_history'] = []
    target_user['donate_history'].append({
        'package': package['name'],
        'date': datetime.now().isoformat(),
        'admin': str(user.id)
    })
    
    db.save_data()
    bot.send_message(message.chat.id, response)

# ========== –ê–î–ú–ò–ù –ö–û–ú–ê–ù–î–´ 1 –£–†–û–í–ï–ù–¨ (–ë–ê–ù/–ú–£–¢/–ü–†–ï–î) ==========
@bot.message_handler(commands=['–±–∞–Ω', 'ban'])
def ban_admin_command(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 3:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /–±–∞–Ω @username/id –¥–Ω–∏ –ø—Ä–∏—á–∏–Ω–∞")
        bot.send_message(message.chat.id, "–ü—Ä–∏–º–µ—Ä: /–±–∞–Ω @user 7 –Ω–µ–∞–¥–µ–∫–≤–∞—Ç")
        return
    
    target = parts[1]
    try:
        days = int(parts[2])
        if days < 1 or days > 365:
            bot.send_message(message.chat.id, "‚ùå –î–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç 1 –¥–æ 365")
            return
    except:
        bot.send_message(message.chat.id, "‚ùå –î–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–∏—Å–ª–æ–º")
        return
    
    reason = ' '.join(parts[3:]) if len(parts) > 3 else "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª"
    
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å –∞–¥–º–∏–Ω–∞
    target_admin_level = get_admin_level(target_id)
    if target_admin_level >= get_admin_level(user.id):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–ª—å–∑—è –∑–∞–±–∞–Ω–∏—Ç—å –∞–¥–º–∏–Ω–∞ —Ä–∞–≤–Ω–æ–≥–æ –∏–ª–∏ –≤—ã—à–µ —É—Ä–æ–≤–Ω–µ–º!")
        return
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    # –ë–∞–Ω–∏–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    target_user['banned_until'] = time.time() + (days * 86400)
    db.save_data()
    
    # –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–±–∞–Ω–∏—Ç—å –≤ —á–∞—Ç–µ, –µ—Å–ª–∏ —ç—Ç–æ –≥—Ä—É–ø–ø–∞
    if message.chat.type in ['group', 'supergroup']:
        try:
            until_date = int(time.time()) + (days * 86400)
            bot.ban_chat_member(message.chat.id, int(target_id), until_date=until_date)
        except:
            pass
    
    db.log_admin_action(user.id, "ban", target_id, f"{days} –¥–Ω–µ–π, –ø—Ä–∏—á–∏–Ω–∞: {reason}")
    
    response = (
        f"üö´ *–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–∞–Ω–µ–Ω*\n\n"
        f"üë§ –ò–º—è: {target_name}\n"
        f"üÜî ID: {target_id}\n"
        f"‚è≥ –°—Ä–æ–∫: {days} –¥–Ω–µ–π\n"
        f"üìù –ü—Ä–∏—á–∏–Ω–∞: {reason}\n\n"
        f"‚úÖ –ë–∞–Ω –≤—ã–¥–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: {user.first_name}"
    )
    
    bot.send_message(message.chat.id, response)

@bot.message_handler(commands=['—Ä–∞–∑–±–∞–Ω', 'unban'])
def unban_admin_command(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /—Ä–∞–∑–±–∞–Ω @username/id")
        return
    
    target = parts[1]
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    # –†–∞–∑–±–∞–Ω–∏–≤–∞–µ–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    target_user['banned_until'] = None
    db.save_data()
    
    # –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞–∑–±–∞–Ω–∏—Ç—å –≤ —á–∞—Ç–µ, –µ—Å–ª–∏ —ç—Ç–æ –≥—Ä—É–ø–ø–∞
    if message.chat.type in ['group', 'supergroup']:
        try:
            bot.unban_chat_member(message.chat.id, int(target_id))
        except:
            pass
    
    db.log_admin_action(user.id, "unban", target_id)
    
    response = (
        f"‚úÖ *–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–±–∞–Ω–µ–Ω*\n\n"
        f"üë§ –ò–º—è: {target_name}\n"
        f"üÜî ID: {target_id}\n\n"
        f"‚úÖ –†–∞–∑–±–∞–Ω –≤—ã–¥–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: {user.first_name}"
    )
    
    bot.send_message(message.chat.id, response)

@bot.message_handler(commands=['–º—É—Ç', 'mute'])
def mute_admin_command(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 3:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /–º—É—Ç @username/id –º–∏–Ω—É—Ç—ã –ø—Ä–∏—á–∏–Ω–∞")
        bot.send_message(message.chat.id, "–ü—Ä–∏–º–µ—Ä: /–º—É—Ç @user 60 —Ñ–ª—É–¥")
        return
    
    target = parts[1]
    try:
        minutes = int(parts[2])
        if minutes < 1 or minutes > 10080:  # –ú–∞–∫—Å–∏–º—É–º 7 –¥–Ω–µ–π
            bot.send_message(message.chat.id, "‚ùå –ú–∏–Ω—É—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç 1 –¥–æ 10080 (7 –¥–Ω–µ–π)")
            return
    except:
        bot.send_message(message.chat.id, "‚ùå –ú–∏–Ω—É—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–∏—Å–ª–æ–º")
        return
    
    reason = ' '.join(parts[3:]) if len(parts) > 3 else "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª"
    
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    # –ú—É—Ç–∏–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    target_user['muted_until'] = time.time() + (minutes * 60)
    db.save_data()
    
    # –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–º—É—Ç–∏—Ç—å –≤ —á–∞—Ç–µ, –µ—Å–ª–∏ —ç—Ç–æ –≥—Ä—É–ø–ø–∞
    if message.chat.type in ['group', 'supergroup']:
        mute_user_in_group(message.chat.id, int(target_id), target_name, minutes, reason)
    
    db.log_admin_action(user.id, "mute", target_id, f"{minutes} –º–∏–Ω—É—Ç, –ø—Ä–∏—á–∏–Ω–∞: {reason}")
    
    response = (
        f"üîá *–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–º—É—á–µ–Ω*\n\n"
        f"üë§ –ò–º—è: {target_name}\n"
        f"üÜî ID: {target_id}\n"
        f"‚è≥ –°—Ä–æ–∫: {minutes} –º–∏–Ω—É—Ç\n"
        f"üìù –ü—Ä–∏—á–∏–Ω–∞: {reason}\n\n"
        f"‚úÖ –ú—É—Ç –≤—ã–¥–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: {user.first_name}"
    )
    
    bot.send_message(message.chat.id, response)

@bot.message_handler(commands=['—Ä–∞–∑–º—É—Ç', 'unmute'])
def unmute_admin_command(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /—Ä–∞–∑–º—É—Ç @username/id")
        return
    
    target = parts[1]
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    # –†–∞–∑–º—É—á–∏–≤–∞–µ–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    target_user['muted_until'] = None
    db.save_data()
    
    # –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞–∑–º—É—Ç–∏—Ç—å –≤ —á–∞—Ç–µ, –µ—Å–ª–∏ —ç—Ç–æ –≥—Ä—É–ø–ø–∞
    if message.chat.type in ['group', 'supergroup']:
        try:
            bot.restrict_chat_member(message.chat.id, int(target_id), can_send_messages=True)
        except:
            pass
    
    db.log_admin_action(user.id, "unmute", target_id)
    
    response = (
        f"üîä *–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–º—É—á–µ–Ω*\n\n"
        f"üë§ –ò–º—è: {target_name}\n"
        f"üÜî ID: {target_id}\n\n"
        f"‚úÖ –†–∞–∑–º—É—Ç –≤—ã–¥–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: {user.first_name}"
    )
    
    bot.send_message(message.chat.id, response)

@bot.message_handler(commands=['–ø—Ä–µ–¥', 'warn'])
def warn_admin_command(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /–ø—Ä–µ–¥ @username/id –ø—Ä–∏—á–∏–Ω–∞")
        return
    
    target = parts[1]
    reason = ' '.join(parts[2:]) if len(parts) > 2 else "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª"
    
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
    banned, warning_count, is_ban = db.add_warning(target_id)
    
    db.log_admin_action(user.id, "warn", target_id, f"–ü—Ä–∏—á–∏–Ω–∞: {reason}")
    
    response = (
        f"‚ö†Ô∏è *–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–¥–∞–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ*\n\n"
        f"üë§ –ò–º—è: {target_name}\n"
        f"üÜî ID: {target_id}\n"
        f"üìä –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: {warning_count}/2\n"
        f"üìù –ü—Ä–∏—á–∏–Ω–∞: {reason}\n\n"
    )
    
    if is_ban:
        response += f"üö´ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–∞–Ω–µ–Ω –∑–∞ 2 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è!\n"
    
    response += f"‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤—ã–¥–∞–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: {user.first_name}"
    
    bot.send_message(message.chat.id, response)

# ========== –ê–î–ú–ò–ù –ö–û–ú–ê–ù–î–´ 2 –£–†–û–í–ï–ù–¨ ==========
@bot.message_handler(commands=['–ª–æ–≥–∏', 'logs'])
def logs_admin_command(message):
    user = message.from_user
    admin_level = get_admin_level(user.id)
    
    if admin_level < 2:
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    log_type = parts[1].lower() if len(parts) > 1 else "bans"
    
    if log_type == "bans" and admin_level >= 2:
        # –õ–æ–≥–∏ –±–∞–Ω–æ–≤
        ban_logs = [log for log in db.admin_logs if log['action'] in ['ban', 'unban']]
        
        if not ban_logs:
            bot.send_message(message.chat.id, "üìú –õ–æ–≥–æ–≤ –±–∞–Ω–æ–≤ –Ω–µ—Ç")
            return
        
        # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
        markup = types.InlineKeyboardMarkup()
        
        logs_text = "üìú *–õ–æ–≥–∏ –±–∞–Ω–æ–≤/—Ä–∞–∑–±–∞–Ω–æ–≤*\n\n"
        for i, log in enumerate(ban_logs[-10:]):  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∑–∞–ø–∏—Å–µ–π
            action_ru = "–ë–∞–Ω" if log['action'] == 'ban' else "–†–∞–∑–±–∞–Ω"
            timestamp = datetime.fromisoformat(log['timestamp']).strftime("%d.%m %H:%M")
            
            # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –∞–¥–º–∏–Ω–∞
            admin_user = db.get_user(log['admin_id'])
            admin_name = admin_user.get('first_name', log['admin_id'])
            
            logs_text += f"‚è∞ *{timestamp}* | {action_ru}\n"
            logs_text += f"üë§ –ò–≥—Ä–æ–∫: {log['target_id']}\n"
            logs_text += f"üëÆ –ê–¥–º–∏–Ω: {admin_name}\n"
            if 'details' in log:
                logs_text += f"üìù {log['details']}\n"
            logs_text += "\n"
        
        # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
        btn_prev = types.InlineKeyboardButton('‚¨ÖÔ∏è –ù–∞–∑–∞–¥', callback_data='logs_bans_prev_0')
        btn_next = types.InlineKeyboardButton('–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è', callback_data='logs_bans_next_1')
        markup.add(btn_prev, btn_next)
        
        bot.send_message(message.chat.id, logs_text, reply_markup=markup)
    
    elif log_type == "actions" and admin_level >= 5:
        # –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π (—Ç–æ–ª—å–∫–æ –¥–ª—è 5 —É—Ä–æ–≤–Ω—è)
        if not db.action_logs:
            bot.send_message(message.chat.id, "üìú –õ–æ–≥–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ—Ç")
            return
        
        logs_text = "üìú *–õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π*\n\n"
        for log in db.action_logs[-15:]:  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 15 –∑–∞–ø–∏—Å–µ–π
            timestamp = datetime.fromisoformat(log['timestamp']).strftime("%d.%m %H:%M")
            
            # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            user_data = db.get_user(log['user_id'])
            user_name = user_data.get('first_name', log['user_id'])
            
            logs_text += f"‚è∞ *{timestamp}*\n"
            logs_text += f"üë§ –ò–≥—Ä–æ–∫: {user_name} ({log['user_id']})\n"
            logs_text += f"üìù –î–µ–π—Å—Ç–≤–∏–µ: {log['action_type']}\n"
            if 'details' in log:
                logs_text += f"‚ÑπÔ∏è {log['details']}\n"
            logs_text += "\n"
        
        bot.send_message(message.chat.id, logs_text)
    
    elif log_type == "admin" and admin_level >= 2:
        # –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–æ–≤
        if not db.admin_logs:
            bot.send_message(message.chat.id, "üìú –õ–æ–≥–æ–≤ –∞–¥–º–∏–Ω–æ–≤ –Ω–µ—Ç")
            return
        
        logs_text = "üìú *–õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–æ–≤*\n\n"
        for log in db.admin_logs[-10:]:  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∑–∞–ø–∏—Å–µ–π
            timestamp = datetime.fromisoformat(log['timestamp']).strftime("%d.%m %H:%M")
            
            # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –∞–¥–º–∏–Ω–∞
            admin_user = db.get_user(log['admin_id'])
            admin_name = admin_user.get('first_name', log['admin_id'])
            
            logs_text += f"‚è∞ *{timestamp}*\n"
            logs_text += f"üëÆ –ê–¥–º–∏–Ω: {admin_name} ({log['admin_id']})\n"
            logs_text += f"üìù –î–µ–π—Å—Ç–≤–∏–µ: {log['action']}\n"
            if log['target_id']:
                logs_text += f"üéØ –¶–µ–ª—å: {log['target_id']}\n"
            if 'details' in log:
                logs_text += f"‚ÑπÔ∏è {log['details']}\n"
            logs_text += "\n"
        
        bot.send_message(message.chat.id, logs_text)

@bot.message_handler(commands=['–∞–¥–º–∏–Ω—ã', 'admins'])
def list_admins_command(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    admins_text = "üëë *–°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤*\n\n"
    
    for admin_id, level in ADMINS.items():
        admin_user = db.get_user(admin_id)
        admin_name = admin_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
        admins_text += f"üéñÔ∏è –£—Ä–æ–≤–µ–Ω—å {level}: {admin_name}\n"
        admins_text += f"   üÜî ID: {admin_id}\n"
        if admin_user.get('username'):
            admins_text += f"   üë§ @{admin_user['username']}\n"
        admins_text += "\n"
    
    bot.send_message(message.chat.id, admins_text)

@bot.message_handler(commands=['–Ω–∞–π—Ç–∏', 'find'])
def find_user_command(message):
    user = message.from_user
    if not is_admin(user.id, 2):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /–Ω–∞–π—Ç–∏ @username/id")
        return
    
    search_term = parts[1]
    results = []
    
    # –ü–æ–∏—Å–∫ –ø–æ ID
    if search_term.isdigit():
        if search_term in db.users:
            results.append(search_term)
    
    # –ü–æ–∏—Å–∫ –ø–æ username
    if search_term.startswith('@'):
        username = search_term[1:].lower()
        for user_id, user_data in db.users.items():
            if user_data.get('username', '').lower() == username:
                results.append(user_id)
    
    # –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏
    search_lower = search_term.lower()
    for user_id, user_data in db.users.items():
        if search_lower in user_data.get('first_name', '').lower():
            results.append(user_id)
    
    if not results:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        return
    
    # –°–æ–∑–¥–∞–µ–º –∏–Ω–ª–∞–π–Ω –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
    markup = types.InlineKeyboardMarkup()
    
    results_text = f"üîç *–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: '{search_term}'*\n\n"
    
    for i, user_id in enumerate(results[:10]):  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 10 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        user_data = db.get_user(user_id)
        user_name = user_data.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
        username = f"@{user_data.get('username')}" if user_data.get('username') else "–ù–µ—Ç username"
        
        results_text += f"{i+1}. {user_name} ({username})\n"
        results_text += f"   üÜî ID: {user_id}\n"
        results_text += f"   üé£ –£—Ä–æ–≤–µ–Ω—å: {user_data.get('fishing_level', 1)}\n\n"
        
        btn = types.InlineKeyboardButton(
            f"{i+1}. {user_name}",
            callback_data=f'admin_userinfo_{user_id}'
        )
        markup.add(btn)
    
    bot.send_message(message.chat.id, results_text, reply_markup=markup)

# ========== –ê–î–ú–ò–ù –ö–û–ú–ê–ù–î–´ 3 –£–†–û–í–ï–ù–¨ ==========
@bot.message_handler(commands=['–≤—ã–¥–∞—Ç—å', 'give'])
def give_admin_command(message):
    user = message.from_user
    if not is_admin(user.id, 3):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 4:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /–≤—ã–¥–∞—Ç—å @username/id —Ç–∏–ø –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ")
        bot.send_message(message.chat.id, "–¢–∏–ø—ã: coins, bait, rod, fish, exp")
        return
    
    target = parts[1]
    item_type = parts[2].lower()
    
    try:
        amount = int(parts[3])
        if amount <= 0:
            bot.send_message(message.chat.id, "‚ùå –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º")
            return
    except:
        bot.send_message(message.chat.id, "‚ùå –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–∏—Å–ª–æ–º")
        return
    
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    if item_type == 'coins':
        db.add_coins(target_id, amount)
        db.log_admin_action(user.id, "give_coins", target_id, f"{amount} {COINS_NAME}")
        response = f"‚úÖ –í—ã–¥–∞–Ω–æ {amount} {COINS_NAME} –∏–≥—Ä–æ–∫—É {target_name}"
    
    elif item_type == 'bait':
        if len(parts) < 5:
            bot.send_message(message.chat.id, "‚ùå –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–º–∞–Ω–∫–∏")
            return
        
        bait_name = ' '.join(parts[4:])
        # –ò—â–µ–º –ø—Ä–∏–º–∞–Ω–∫—É
        bait_found = False
        for bait in BAITS:
            if bait['name'] == bait_name:
                db.add_bait(target_id, bait_name, amount)
                db.log_admin_action(user.id, "give_bait", target_id, f"{bait_name} x{amount}")
                response = f"‚úÖ –í—ã–¥–∞–Ω–æ {amount} —à—Ç. –ø—Ä–∏–º–∞–Ω–∫–∏ '{bait_name}' –∏–≥—Ä–æ–∫—É {target_name}"
                bait_found = True
                break
        
        if not bait_found:
            response = f"‚ùå –ü—Ä–∏–º–∞–Ω–∫–∞ '{bait_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
    
    elif item_type == 'rod':
        if len(parts) < 5:
            bot.send_message(message.chat.id, "‚ùå –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É–¥–æ—á–∫–∏")
            return
        
        rod_name = ' '.join(parts[4:])
        # –ò—â–µ–º —É–¥–æ—á–∫—É
        rod_found = False
        for rod in RODS:
            if rod['name'] == rod_name:
                for i in range(amount):
                    db.add_rod(target_id, rod_name)
                db.log_admin_action(user.id, "give_rod", target_id, f"{rod_name} x{amount}")
                response = f"‚úÖ –í—ã–¥–∞–Ω–æ {amount} —à—Ç. —É–¥–æ—á–∫–∏ '{rod_name}' –∏–≥—Ä–æ–∫—É {target_name}"
                rod_found = True
                break
        
        if not rod_found:
            response = f"‚ùå –£–¥–æ—á–∫–∞ '{rod_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
    
    elif item_type == 'fish':
        if len(parts) < 5:
            bot.send_message(message.chat.id, "‚ùå –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä—ã–±—ã")
            return
        
        fish_name = ' '.join(parts[4:])
        # –ò—â–µ–º —Ä—ã–±—É
        fish_found = False
        for fish in FISHES:
            if fish['name'] == fish_name:
                # –î–æ–±–∞–≤–ª—è–µ–º —Ä—ã–±—É –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                if fish_name in target_user['inventory']['fish']:
                    target_user['inventory']['fish'][fish_name] += amount
                else:
                    target_user['inventory']['fish'][fish_name] = amount
                
                db.save_data()
                db.log_admin_action(user.id, "give_fish", target_id, f"{fish_name} x{amount}")
                response = f"‚úÖ –í—ã–¥–∞–Ω–æ {amount} —à—Ç. —Ä—ã–±—ã '{fish_name}' –∏–≥—Ä–æ–∫—É {target_name}"
                fish_found = True
                break
        
        if not fish_found:
            response = f"‚ùå –†—ã–±–∞ '{fish_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
    
    elif item_type == 'exp':
        target_user['experience'] += amount
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å
        while target_user['experience'] >= target_user['fishing_level'] * 100:
            target_user['experience'] -= target_user['fishing_level'] * 100
            target_user['fishing_level'] += 1
        
        db.save_data()
        db.log_admin_action(user.id, "give_exp", target_id, f"{amount} –æ–ø—ã—Ç–∞")
        response = f"‚úÖ –í—ã–¥–∞–Ω–æ {amount} –æ–ø—ã—Ç–∞ –∏–≥—Ä–æ–∫—É {target_name}. –ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: {target_user['fishing_level']}"
    
    else:
        response = "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –ø—Ä–µ–¥–º–µ—Ç–∞"
    
    bot.send_message(message.chat.id, response)

# ========== –ê–î–ú–ò–ù –ö–û–ú–ê–ù–î–´ 4 –£–†–û–í–ï–ù–¨ ==========
@bot.message_handler(commands=['—Å—Ç–∞—Ç–∞–¥–º–∏–Ω', 'statsadmin'])
def admin_stats_command(message):
    user = message.from_user
    if not is_admin(user.id, 4):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /—Å—Ç–∞—Ç–∞–¥–º–∏–Ω @username/id")
        return
    
    target = parts[1]
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    target_user = db.get_user(target_id)
    
    stats_text = (
        f"üë§ *–ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞*\n\n"
        f"üìù –ò–º—è: {target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')}\n"
        f"üÜî ID: {target_id}\n"
    )
    
    if target_user.get('username'):
        stats_text += f"üë§ Username: @{target_user['username']}\n"
    
    stats_text += f"üìä –£—Ä–æ–≤–µ–Ω—å –∞–¥–º–∏–Ω–∞: {get_admin_level(target_id)}\n\n"
    
    stats_text += (
        f"üí∞ {COINS_NAME}: {target_user['coins']}\n"
        f"üí∞ –í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: {target_user.get('total_coins_earned', 0)}\n"
        f"üêõ –ß–µ—Ä–≤—è–∫–æ–≤: {target_user['worms']}/10\n"
        f"üé£ –£—Ä–æ–≤–µ–Ω—å —Ä—ã–±–∞–ª–∫–∏: {target_user['fishing_level']}\n"
        f"üìà –û–ø—ã—Ç: {target_user['experience']}/{target_user['fishing_level'] * 100}\n"
        f"üêü –í—Å–µ–≥–æ –ø–æ–π–º–∞–Ω–æ: {target_user['total_fish']}\n\n"
    )
    
    stats_text += f"üìç –¢–µ–∫—É—â–∏–π –≤–æ–¥–æ–µ–º: {target_user.get('current_location', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')}\n"
    stats_text += f"üé£ –¢–µ–∫—É—â–∞—è —É–¥–æ—á–∫–∞: {target_user.get('current_rod', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')}\n"
    stats_text += f"ü™± –¢–µ–∫—É—â–∞—è –ø—Ä–∏–º–∞–Ω–∫–∞: {target_user.get('current_bait', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')}\n\n"
    
    # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –±–∞–Ω—ã
    warning_count = db.get_warning_count(target_id)
    stats_text += f"‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: {warning_count}/2\n"
    
    if target_user.get('banned_until'):
        ban_time_left = target_user['banned_until'] - time.time()
        if ban_time_left > 0:
            days = int(ban_time_left // 86400)
            hours = int((ban_time_left % 86400) // 3600)
            stats_text += f"üö´ –ó–∞–±–∞–Ω–µ–Ω –¥–æ: {days}–¥ {hours}—á\n"
    
    if target_user.get('muted_until'):
        mute_time_left = target_user['muted_until'] - time.time()
        if mute_time_left > 0:
            minutes = int(mute_time_left // 60)
            stats_text += f"üîá –ó–∞–º—É—á–µ–Ω –¥–æ: {minutes} –º–∏–Ω\n"
    
    stats_text += "\nüé£ *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä—ã–±—ã:*\n"
    stats_text += f"üêü –û–±—ã—á–Ω—ã—Ö: {target_user['stats']['common']}\n"
    stats_text += f"üê† –†–µ–¥–∫–∏—Ö: {target_user['stats']['rare']}\n"
    stats_text += f"üåü –≠–ø–∏—á–µ—Å–∫–∏—Ö: {target_user['stats']['epic']}\n"
    stats_text += f"üëë –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã—Ö: {target_user['stats']['legendary']}\n"
    stats_text += f"üóëÔ∏è –ú—É—Å–æ—Ä–∞: {target_user['stats']['trash']}\n\n"
    
    # –î–æ–Ω–∞—Ç –∏—Å—Ç–æ—Ä–∏—è
    if target_user.get('donate_history'):
        stats_text += "üí∞ *–ò—Å—Ç–æ—Ä–∏—è –¥–æ–Ω–∞—Ç–∞:*\n"
        for donation in target_user['donate_history'][-5:]:
            date = datetime.fromisoformat(donation['date']).strftime("%d.%m")
            stats_text += f"‚Ä¢ {donation['package']} ({date})\n"
    
    bot.send_message(message.chat.id, stats_text)

@bot.message_handler(commands=['–±–æ—Ç—Å—Ç–∞—Ç', 'botstats'])
def bot_stats_command(message):
    user = message.from_user
    if not is_admin(user.id, 4):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    total_users = len(db.users)
    active_users = 0
    total_fish = 0
    total_coins = 0
    
    for user_id, user_data in db.users.items():
        total_fish += user_data.get('total_fish', 0)
        total_coins += user_data.get('coins', 0)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–∏–≥—Ä–∞–ª –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π)
        last_fishing = user_data.get('last_fishing_time', 0)
        if time.time() - last_fishing < 7 * 86400:
            active_users += 1
    
    stats_text = (
        f"ü§ñ *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞*\n\n"
        f"üë• –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {total_users}\n"
        f"üéÆ –ê–∫—Ç–∏–≤–Ω—ã—Ö (7 –¥–Ω–µ–π): {active_users}\n"
        f"üé£ –í—Å–µ–≥–æ –ø–æ–π–º–∞–Ω–æ —Ä—ã–±—ã: {total_fish}\n"
        f"üí∞ –í—Å–µ–≥–æ —Ä—ã–±–æ–ø –≤ —ç–∫–æ–Ω–æ–º–∏–∫–µ: {total_coins}\n"
        f"üëë –ê–¥–º–∏–Ω–æ–≤: {len(ADMINS)}\n"
        f"üìú –õ–æ–≥–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π: {len(db.action_logs)}\n"
        f"üìã –õ–æ–≥–æ–≤ –∞–¥–º–∏–Ω–æ–≤: {len(db.admin_logs)}\n"
        f"üì∞ –ù–æ–≤–æ—Å—Ç–µ–π: {len(db.news)}\n"
        f"üí∞ –î–æ–Ω–∞—Ç-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: {len(db.donate_transactions)}\n\n"
        f"üïê –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: {datetime.now().strftime('%d.%m.%Y %H:%M')}"
    )
    
    bot.send_message(message.chat.id, stats_text)

# ========== –ê–î–ú–ò–ù –ö–û–ú–ê–ù–î–´ 5 –£–†–û–í–ï–ù–¨ ==========
@bot.message_handler(commands=['+–∞–¥–º–∏–Ω', '+admin'])
def add_admin_command(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 3:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /+–∞–¥–º–∏–Ω @username/id —É—Ä–æ–≤–µ–Ω—å")
        return
    
    target = parts[1]
    try:
        level = int(parts[2])
        if level < 1 or level > 5:
            bot.send_message(message.chat.id, "‚ùå –£—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 1 –¥–æ 5")
            return
    except:
        bot.send_message(message.chat.id, "‚ùå –£—Ä–æ–≤–µ–Ω—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º")
        return
    
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    set_admin_level(target_id, level)
    db.log_admin_action(user.id, "add_admin", target_id, f"–£—Ä–æ–≤–µ–Ω—å {level}")
    
    # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    bot.send_message(message.chat.id, f"‚úÖ –ê–¥–º–∏–Ω –¥–æ–±–∞–≤–ª–µ–Ω: {target_name} (ID: {target_id}), —É—Ä–æ–≤–µ–Ω—å: {level}")

@bot.message_handler(commands=['-–∞–¥–º–∏–Ω', '-admin'])
def remove_admin_command(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /-–∞–¥–º–∏–Ω @username/id")
        return
    
    target = parts[1]
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    if target_id == str(user.id):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–ª—å–∑—è —Å–Ω—è—Ç—å —Å–µ–±—è!")
        return
    
    old_level = get_admin_level(target_id)
    set_admin_level(target_id, 0)
    db.log_admin_action(user.id, "remove_admin", target_id)
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    bot.send_message(message.chat.id, f"‚úÖ –ê–¥–º–∏–Ω —Å–Ω—è—Ç: {target_name} (ID: {target_id}), –±—ã–ª —É—Ä–æ–≤–µ–Ω—å: {old_level}")

@bot.message_handler(commands=['–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏', 'clearlogs'])
def clear_logs_command(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ —Ç–∏–ø")
        bot.send_message(message.chat.id, "–¢–∏–ø—ã: all, admin, action, donate")
        return
    
    log_type = parts[1].lower()
    
    if log_type == 'all':
        db.admin_logs = []
        db.action_logs = []
        response = "‚úÖ –í—Å–µ –ª–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã"
    elif log_type == 'admin':
        db.admin_logs = []
        response = "‚úÖ –õ–æ–≥–∏ –∞–¥–º–∏–Ω–æ–≤ –æ—á–∏—â–µ–Ω—ã"
    elif log_type == 'action':
        db.action_logs = []
        response = "‚úÖ –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –æ—á–∏—â–µ–Ω—ã"
    elif log_type == 'donate':
        db.donate_transactions = []
        response = "‚úÖ –î–æ–Ω–∞—Ç-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—á–∏—â–µ–Ω—ã"
    else:
        response = "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –ª–æ–≥–æ–≤"
    
    db.save_logs()
    db.save_data()
    db.log_admin_action(user.id, "clear_logs", details=log_type)
    bot.send_message(message.chat.id, response)

@bot.message_handler(commands=['—Å–±—Ä–æ—Å–∏—Ç—å', 'reset'])
def reset_user_command(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split()
    if len(parts) < 2:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /—Å–±—Ä–æ—Å–∏—Ç—å @username/id —á—Ç–æ")
        bot.send_message(message.chat.id, "–ß—Ç–æ: stats, inventory, all")
        return
    
    target = parts[1]
    reset_type = parts[2].lower() if len(parts) > 2 else "stats"
    
    target_id = get_user_from_input(target)
    if not target_id:
        bot.send_message(message.chat.id, "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return
    
    target_user = db.get_user(target_id)
    target_name = target_user.get('first_name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')
    
    if reset_type == 'stats':
        target_user['stats'] = {'common': 0, 'rare': 0, 'epic': 0, 'legendary': 0, 'trash': 0}
        target_user['total_fish'] = 0
        target_user['fishing_level'] = 1
        target_user['experience'] = 0
        target_user['total_coins_earned'] = 0
        response = f"‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞ {target_name} —Å–±—Ä–æ—à–µ–Ω–∞"
    
    elif reset_type == 'inventory':
        target_user['inventory'] = {
            'rods': [{"name": "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞", "equipped": True, "durability": 100, "max_durability": 100, "upgrades": [], "unbreakable": False}],
            'baits': [{"name": "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å", "count": 10}],
            'fish': {}
        }
        target_user['current_rod'] = "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞"
        target_user['current_bait'] = "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å"
        target_user['luck_bonus'] = 0
        target_user['unbreakable_rods'] = False
        response = f"‚úÖ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–≥—Ä–æ–∫–∞ {target_name} —Å–±—Ä–æ—à–µ–Ω"
    
    elif reset_type == 'all':
        # –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å (–∫—Ä–æ–º–µ –±–∞–Ω–∞ –∏ –¥–æ–Ω–∞—Ç–∞)
        banned_until = target_user.get('banned_until')
        muted_until = target_user.get('muted_until')
        warnings = target_user.get('warnings', [])
        donate_history = target_user.get('donate_history', [])
        username = target_user.get('username')
        first_name = target_user.get('first_name')
        
        new_user_data = {
            'worms': INITIAL_WORMS,
            'fish_caught': [],
            'total_fish': 0,
            'last_fishing_time': None,
            'last_worm_refill': time.time(),
            'stats': {'common': 0, 'rare': 0, 'epic': 0, 'legendary': 0, 'trash': 0},
            'username': username,
            'first_name': first_name,
            'warnings': warnings,
            'banned_until': banned_until,
            'muted_until': muted_until,
            'coins': INITIAL_COINS,
            'inventory': {
                'rods': [{"name": "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞", "equipped": True, "durability": 100, "max_durability": 100, "upgrades": [], "unbreakable": False}],
                'baits': [{"name": "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å", "count": 10}],
                'fish': {}
            },
            'daily_quests': {},
            'quests_completed_today': 0,
            'last_daily_reset': datetime.now().isoformat(),
            'current_rod': "üé£ –ú–∞—Ö–æ–≤–∞—è —É–¥–æ—á–∫–∞",
            'current_bait': "üå± –û–±—ã—á–Ω—ã–π —á–µ—Ä–≤—å",
            'current_location': random.choice(WATER_BODIES)['name'],
            'favorite_fishing_spots': [],
            'achievements': [],
            'fishing_level': 1,
            'experience': 0,
            'total_coins_earned': 0,
            'donate_history': donate_history,
            'rod_upgrades': {},
            'luck_bonus': 0.0,
            'unbreakable_rods': False
        }
        
        db.users[target_id] = new_user_data
        response = f"‚úÖ –ò–≥—Ä–æ–∫ {target_name} –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—à–µ–Ω (–∫—Ä–æ–º–µ –±–∞–Ω–∞ –∏ –¥–æ–Ω–∞—Ç–∞)"
    
    else:
        response = "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Å–±—Ä–æ—Å–∞"
    
    db.save_data()
    db.log_admin_action(user.id, "reset", target_id, reset_type)
    bot.send_message(message.chat.id, response)

@bot.message_handler(commands=['news', '–Ω–æ–≤–æ—Å—Ç—å'])
def send_news_command(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        bot.send_message(message.chat.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤!")
        return
    
    parts = message.text.split(maxsplit=2)
    if len(parts) < 3:
        bot.send_message(message.chat.id, "‚ùå –§–æ—Ä–º–∞—Ç: /news –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–∫—Å—Ç")
        return
    
    title = parts[1]
    content = parts[2]
    
    # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ—Å—Ç—å
    news_item = db.add_news(title, content, user.id)
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
    sent_count = 0
    error_count = 0
    
    for user_id in db.users.keys():
        try:
            news_text = (
                f"üì∞ *–ù–û–í–û–°–¢–¨: {title}*\n\n"
                f"{content}\n\n"
                f"‚è∞ {datetime.fromisoformat(news_item['timestamp']).strftime('%d.%m.%Y %H:%M')}"
            )
            bot.send_message(user_id, news_text)
            sent_count += 1
            time.sleep(0.05)  # –ó–∞–¥–µ—Ä–∂–∫–∞ —á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ–≤—ã—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã
        except:
            error_count += 1
    
    response = (
        f"‚úÖ –ù–æ–≤–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!\n\n"
        f"üìù –ó–∞–≥–æ–ª–æ–≤–æ–∫: {title}\n"
        f"üìä –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: {sent_count} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º\n"
        f"‚ùå –û—à–∏–±–æ–∫: {error_count}"
    )
    
    bot.send_message(message.chat.id, response)

# ========== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–ù–û–ü–û–ö ==========
@bot.message_handler(func=lambda msg: msg.text == 'üé£ –ù–∞—á–∞—Ç—å —Ä—ã–±–∞–ª–∫—É')
def fishing_button_handler(message):
    fishing_command_handler(message)

@bot.message_handler(func=lambda msg: msg.text == 'üåä –°–º–µ–Ω–∏—Ç—å –≤–æ–¥–æ–µ–º')
def location_button_handler(message):
    location_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üé£ –ó–∞–±—Ä–æ—Å–∏—Ç—å —É–¥–æ—á–∫—É')
def fishing_cast_handler(message):
    fishing_command_handler(message)

@bot.message_handler(func=lambda msg: msg.text == 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞')
def stats_button_handler(message):
    stats_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å')
def inventory_button_handler(message):
    inventory_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üõí –ú–∞–≥–∞–∑–∏–Ω')
def shop_button_handler(message):
    shop_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üí∞ –ü—Ä–æ–¥–∞—Ç—å —Ä—ã–±—É')
def sell_button_handler(message):
    sell_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üìú –ó–∞–¥–∞–Ω–∏—è')
def quests_button_handler(message):
    quests_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤')
def top_button_handler(message):
    top_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üì∞ –ù–æ–≤–æ—Å—Ç–∏')
def news_button_handler(message):
    news_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üí∞ –î–æ–Ω–∞—Ç')
def donate_button_handler(message):
    donate_command(message)

@bot.message_handler(func=lambda msg: msg.text == '‚ùì –ü–æ–º–æ—â—å')
def help_button_handler(message):
    help_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üé£ –í—ã–±—Ä–∞—Ç—å –ø—Ä–∏–º–∞–Ω–∫—É')
def select_bait_button(message):
    select_bait_command(message)

@bot.message_handler(func=lambda msg: msg.text == '‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏')
def settings_button_handler(message):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫"""
    settings_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å')
def admin_panel_handler(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        bot.send_message(message.chat.id, "‚ùå –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏!", reply_markup=create_main_keyboard(user.id))
        return
    
    admin_level = get_admin_level(user.id)
    admin_text = (
        f"üëë *–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å*\n\n"
        f"üéñÔ∏è –í–∞—à —É—Ä–æ–≤–µ–Ω—å: {admin_level}/5\n"
        f"üë§ –í–∞—à ID: {user.id}\n\n"
        f"üìã *–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:*\n"
    )
    
    if admin_level >= 1:
        admin_text += "‚Ä¢ /–±–∞–Ω @user –¥–Ω–∏ –ø—Ä–∏—á–∏–Ω–∞ - –ó–∞–±–∞–Ω–∏—Ç—å\n‚Ä¢ /—Ä–∞–∑–±–∞–Ω @user - –†–∞–∑–±–∞–Ω–∏—Ç—å\n‚Ä¢ /–º—É—Ç @user –º–∏–Ω –ø—Ä–∏—á–∏–Ω–∞ - –ó–∞–º—É—Ç–∏—Ç—å\n‚Ä¢ /—Ä–∞–∑–º—É—Ç @user - –†–∞–∑–º—É—Ç–∏—Ç—å\n‚Ä¢ /–ø—Ä–µ–¥ @user –ø—Ä–∏—á–∏–Ω–∞ - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ\n‚Ä¢ /–≤—ã–¥–∞—Ç—å–¥–æ–Ω–∞—Ç @user –∫–æ–¥ - –í—ã–¥–∞—Ç—å –¥–æ–Ω–∞—Ç\n"
    if admin_level >= 2:
        admin_text += "‚Ä¢ /–ª–æ–≥–∏ bans - –õ–æ–≥–∏ –±–∞–Ω–æ–≤\n‚Ä¢ /–ª–æ–≥–∏ admin - –õ–æ–≥–∏ –∞–¥–º–∏–Ω–æ–≤\n‚Ä¢ /–∞–¥–º–∏–Ω—ã - –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤\n‚Ä¢ /–Ω–∞–π—Ç–∏ @user - –ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞\n"
    if admin_level >= 3:
        admin_text += "‚Ä¢ /–≤—ã–¥–∞—Ç—å @user coins —Å—É–º–º–∞ - –í—ã–¥–∞—Ç—å –º–æ–Ω–µ—Ç—ã\n‚Ä¢ /–≤—ã–¥–∞—Ç—å @user bait —Å—É–º–º–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ - –í—ã–¥–∞—Ç—å –ø—Ä–∏–º–∞–Ω–∫—É\n‚Ä¢ /–≤—ã–¥–∞—Ç—å @user rod —Å—É–º–º–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ - –í—ã–¥–∞—Ç—å —É–¥–æ—á–∫—É\n‚Ä¢ /–≤—ã–¥–∞—Ç—å @user fish —Å—É–º–º–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ - –í—ã–¥–∞—Ç—å —Ä—ã–±—É\n‚Ä¢ /–≤—ã–¥–∞—Ç—å @user exp —Å—É–º–º–∞ - –í—ã–¥–∞—Ç—å –æ–ø—ã—Ç\n"
    if admin_level >= 4:
        admin_text += "‚Ä¢ /—Å—Ç–∞—Ç–∞–¥–º–∏–Ω @user - –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n‚Ä¢ /–±–æ—Ç—Å—Ç–∞—Ç - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞\n‚Ä¢ /—Å–±—Ä–æ—Å–∏—Ç—å @user —Ç–∏–ø - –°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ\n"
    if admin_level >= 5:
        admin_text += "‚Ä¢ /+–∞–¥–º–∏–Ω @user —É—Ä–æ–≤–µ–Ω—å - –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω\n‚Ä¢ /-–∞–¥–º–∏–Ω @user - –£–¥–∞–ª–∏—Ç—å –∞–¥–º–∏–Ω\n‚Ä¢ /–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ —Ç–∏–ø - –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏\n‚Ä¢ /news –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–∫—Å—Ç - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å\n"
    
    admin_text += "\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:"
    
    bot.send_message(message.chat.id, admin_text, reply_markup=create_admin_keyboard(admin_level))

@bot.message_handler(func=lambda msg: msg.text == 'üìã –ú–µ–Ω—é')
def menu_command(message):
    user = message.from_user
    bot.send_message(message.chat.id, "–í–æ–∑–≤—Ä–∞—â–∞—é –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=create_main_keyboard(user.id))

@bot.message_handler(func=lambda msg: msg.text == 'üö´ –ë–∞–Ω/–†–∞–∑–±–∞–Ω')
def admin_ban_menu_handler(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        return
    
    bot.send_message(message.chat.id, 
                    "üö´ *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–∞–º–∏*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥—ã:\n"
                    "/–±–∞–Ω @username –¥–Ω–∏ –ø—Ä–∏—á–∏–Ω–∞ - –ó–∞–±–∞–Ω–∏—Ç—å\n"
                    "/—Ä–∞–∑–±–∞–Ω @username - –†–∞–∑–±–∞–Ω–∏—Ç—å\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–±–∞–Ω @user 7 –Ω–µ–∞–¥–µ–∫–≤–∞—Ç\n"
                    "/—Ä–∞–∑–±–∞–Ω @user",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üîá –ú—É—Ç/–†–∞–∑–º—É—Ç')
def admin_mute_menu_handler(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        return
    
    bot.send_message(message.chat.id,
                    "üîá *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º—É—Ç–∞–º–∏*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥—ã:\n"
                    "/–º—É—Ç @username –º–∏–Ω—É—Ç—ã –ø—Ä–∏—á–∏–Ω–∞ - –ó–∞–º—É—Ç–∏—Ç—å\n"
                    "/—Ä–∞–∑–º—É—Ç @username - –†–∞–∑–º—É—Ç–∏—Ç—å\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–º—É—Ç @user 60 —Ñ–ª—É–¥\n"
                    "/—Ä–∞–∑–º—É—Ç @user",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == '‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ')
def admin_warn_menu_handler(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        return
    
    bot.send_message(message.chat.id,
                    "‚ö†Ô∏è *–í—ã–¥–∞—á–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥–∞:\n"
                    "/–ø—Ä–µ–¥ @username –ø—Ä–∏—á–∏–Ω–∞ - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–ø—Ä–µ–¥ @user —Å–ø–∞–º\n\n"
                    "2 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è = –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∞–Ω",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üí∞ –í—ã–¥–∞—Ç—å –¥–æ–Ω–∞—Ç')
def admin_donate_menu_handler(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        return
    
    bot.send_message(message.chat.id,
                    "üí∞ *–í—ã–¥–∞—á–∞ –¥–æ–Ω–∞—Ç-–ø–∞–∫–µ—Ç–æ–≤*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥–∞:\n"
                    "/–≤—ã–¥–∞—Ç—å–¥–æ–Ω–∞—Ç @username –∫–æ–¥_–ø–∞–∫–µ—Ç–∞\n\n"
                    "üì¶ *–ö–æ–¥—ã –ø–∞–∫–µ—Ç–æ–≤:*\n"
                    "299RUBUNBR - –ù–µ—Ä—É—à–∏–º–æ—Å—Ç—å —É–¥–æ—á–∫–∏\n"
                    "200RUBLUCK - –£–¥–∞—á–∞ +20%\n"
                    "499RUBSPIN - –°–ø–∏–Ω–Ω–∏–Ω–≥ —Å —É–¥–∞—á–µ–π 30%\n"
                    "999RUBLEG - –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è —É–¥–æ—á–∫–∞\n"
                    "799RUBMAR - –ú–æ—Ä—Å–∫–æ–π —Å–ø–∏–Ω–Ω–∏–Ω–≥ PRO\n"
                    "50RUB100 - 100 —Ä—ã–±–æ–ø\n"
                    "200RUB500 - 500 —Ä—ã–±–æ–ø\n"
                    "350RUB1000 - 1000 —Ä—ã–±–æ–ø\n"
                    "1500RUB5000 - 5000 —Ä—ã–±–æ–ø\n"
                    "2800RUB10000 - 10000 —Ä—ã–±–æ–ø\n"
                    "399RUBSTART - –°—Ç–∞—Ä—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä\n"
                    "899RUBPRO - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä\n"
                    "1999RUBLEG - –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –Ω–∞–±–æ—Ä\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–≤—ã–¥–∞—Ç—å–¥–æ–Ω–∞—Ç @user 299RUBUNBR",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üìú –õ–æ–≥–∏ –±–∞–Ω–æ–≤')
def admin_logs_handler(message):
    user = message.from_user
    if not is_admin(user.id, 2):
        return
    
    logs_admin_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üìã –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤')
def admin_list_handler(message):
    user = message.from_user
    if not is_admin(user.id, 1):
        return
    
    list_admins_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üë§ –ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞')
def admin_find_handler(message):
    user = message.from_user
    if not is_admin(user.id, 2):
        return
    
    bot.send_message(message.chat.id,
                    "üë§ *–ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥–∞:\n"
                    "/–Ω–∞–π—Ç–∏ @username/id/–∏–º—è\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–Ω–∞–π—Ç–∏ @user\n"
                    "/–Ω–∞–π—Ç–∏ id\n"
                    "/–Ω–∞–π—Ç–∏ –ò–≤–∞–Ω",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üé£ –í—ã–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã')
def admin_give_handler(message):
    user = message.from_user
    if not is_admin(user.id, 3):
        return
    
    bot.send_message(message.chat.id,
                    "üé£ *–í—ã–¥–∞—á–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥—ã:\n"
                    "/–≤—ã–¥–∞—Ç—å @user coins —Å—É–º–º–∞ - –ú–æ–Ω–µ—Ç—ã\n"
                    "/–≤—ã–¥–∞—Ç—å @user bait —Å—É–º–º–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ - –ü—Ä–∏–º–∞–Ω–∫–∞\n"
                    "/–≤—ã–¥–∞—Ç—å @user rod —Å—É–º–º–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ - –£–¥–æ—á–∫–∞\n"
                    "/–≤—ã–¥–∞—Ç—å @user fish —Å—É–º–º–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ - –†—ã–±–∞\n"
                    "/–≤—ã–¥–∞—Ç—å @user exp —Å—É–º–º–∞ - –û–ø—ã—Ç\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–≤—ã–¥–∞—Ç—å @user coins 1000\n"
                    "/–≤—ã–¥–∞—Ç—å @user bait 10 üî¥ –ú–æ—Ç—ã–ª—å",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üí∞ –í—ã–¥–∞—Ç—å –º–æ–Ω–µ—Ç—ã')
def admin_coins_handler(message):
    user = message.from_user
    if not is_admin(user.id, 3):
        return
    
    bot.send_message(message.chat.id,
                    "üí∞ *–í—ã–¥–∞—á–∞ –º–æ–Ω–µ—Ç*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥–∞:\n"
                    "/–≤—ã–¥–∞—Ç—å @user coins —Å—É–º–º–∞\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–≤—ã–¥–∞—Ç—å @user coins 5000",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üåü –í—ã–¥–∞—Ç—å –æ–ø—ã—Ç')
def admin_exp_handler(message):
    user = message.from_user
    if not is_admin(user.id, 3):
        return
    
    bot.send_message(message.chat.id,
                    "üåü *–í—ã–¥–∞—á–∞ –æ–ø—ã—Ç–∞*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥–∞:\n"
                    "/–≤—ã–¥–∞—Ç—å @user exp —Å—É–º–º–∞\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–≤—ã–¥–∞—Ç—å @user exp 1000",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞')
def admin_botstats_handler(message):
    user = message.from_user
    if not is_admin(user.id, 4):
        return
    
    bot_stats_command(message)

@bot.message_handler(func=lambda msg: msg.text == 'üë§ –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∞')
def admin_fullstats_handler(message):
    user = message.from_user
    if not is_admin(user.id, 4):
        return
    
    bot.send_message(message.chat.id,
                    "üë§ *–ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥–∞:\n"
                    "/—Å—Ç–∞—Ç–∞–¥–º–∏–Ω @username/id\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/—Å—Ç–∞—Ç–∞–¥–º–∏–Ω @user\n"
                    "/—Å—Ç–∞—Ç–∞–¥–º–∏–Ω id",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üîÑ –°–±—Ä–æ—Å –∏–≥—Ä–æ–∫–∞')
def admin_reset_handler(message):
    user = message.from_user
    if not is_admin(user.id, 4):
        return
    
    bot.send_message(message.chat.id,
                    "üîÑ *–°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–∞*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥–∞:\n"
                    "/—Å–±—Ä–æ—Å–∏—Ç—å @user —Ç–∏–ø\n\n"
                    "–¢–∏–ø—ã:\n"
                    "stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
                    "inventory - –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å\n"
                    "all - –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/—Å–±—Ä–æ—Å–∏—Ç—å @user stats",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == '‚öôÔ∏è –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ')
def admin_full_control_handler(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        return
    
    bot.send_message(message.chat.id,
                    "‚öôÔ∏è *–ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥—ã 5 —É—Ä–æ–≤–Ω—è:\n\n"
                    "üëë –ê–¥–º–∏–Ω—ã:\n"
                    "/+–∞–¥–º–∏–Ω @user —É—Ä–æ–≤–µ–Ω—å - –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω–∞\n"
                    "/-–∞–¥–º–∏–Ω @user - –£–¥–∞–ª–∏—Ç—å –∞–¥–º–∏–Ω–∞\n\n"
                    "üóëÔ∏è –û—á–∏—Å—Ç–∫–∞:\n"
                    "/–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ all - –í—Å–µ –ª–æ–≥–∏\n"
                    "/–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ admin - –õ–æ–≥–∏ –∞–¥–º–∏–Ω–æ–≤\n"
                    "/–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ action - –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π\n"
                    "/–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ donate - –î–æ–Ω–∞—Ç-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏\n\n"
                    "üîÑ –°–±—Ä–æ—Å:\n"
                    "/—Å–±—Ä–æ—Å–∏—Ç—å @user stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n"
                    "/—Å–±—Ä–æ—Å–∏—Ç—å @user inventory - –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å\n"
                    "/—Å–±—Ä–æ—Å–∏—Ç—å @user all - –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å\n\n"
                    "üì¢ –†–∞—Å—Å—ã–ª–∫–∞:\n"
                    "/news –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–∫—Å—Ç - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å –≤—Å–µ–º\n\n"
                    "üìú –õ–æ–≥–∏:\n"
                    "/–ª–æ–≥–∏ actions - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è\n"
                    "/–ª–æ–≥–∏ admin - –î–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–æ–≤\n"
                    "/–ª–æ–≥–∏ bans - –ë–∞–Ω—ã/—Ä–∞–∑–±–∞–Ω—ã",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏')
def admin_clear_logs_handler(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        return
    
    bot.send_message(message.chat.id,
                    "üóëÔ∏è *–û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥—ã:\n"
                    "/–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ all - –í—Å–µ –ª–æ–≥–∏\n"
                    "/–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ admin - –õ–æ–≥–∏ –∞–¥–º–∏–Ω–æ–≤\n"
                    "/–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ action - –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π\n"
                    "/–æ—á–∏—Å—Ç–∏—Ç—å–ª–æ–≥–∏ donate - –î–æ–Ω–∞—Ç-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏\n\n"
                    "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üì¢ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å')
def admin_news_handler(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        return
    
    bot.send_message(message.chat.id,
                    "üì¢ *–û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ—Å—Ç–∏*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥–∞:\n"
                    "/news –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–∫—Å—Ç\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/news –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Ä—ã–±—ã!\n\n"
                    "‚ö†Ô∏è –ù–æ–≤–æ—Å—Ç—å –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –í–°–ï–ú –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º!",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

@bot.message_handler(func=lambda msg: msg.text == 'üìú –í—Å–µ –ª–æ–≥–∏')
def admin_all_logs_handler(message):
    user = message.from_user
    if not is_admin(user.id, 5):
        return
    
    bot.send_message(message.chat.id,
                    "üìú *–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤*\n\n"
                    "üìã –ö–æ–º–∞–Ω–¥—ã:\n"
                    "/–ª–æ–≥–∏ actions - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–æ–≤\n"
                    "/–ª–æ–≥–∏ admin - –î–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–æ–≤\n"
                    "/–ª–æ–≥–∏ bans - –ë–∞–Ω—ã –∏ —Ä–∞–∑–±–∞–Ω—ã\n\n"
                    "–ü—Ä–∏–º–µ—Ä:\n"
                    "/–ª–æ–≥–∏ actions",
                    reply_markup=create_admin_keyboard(get_admin_level(user.id)))

# ========== CALLBACK –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ==========
@bot.callback_query_handler(func=lambda call: True)
def callback_handler(call):
    user = call.from_user
    
    if call.data == 'menu':
        bot.edit_message_text("–í–æ–∑–≤—Ä–∞—â–∞—é –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", 
                            call.message.chat.id, 
                            call.message.message_id)
        bot.send_message(call.message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=create_main_keyboard(user.id))
    
    # –í—ã–±–æ—Ä –≤–æ–¥–æ–µ–º–∞
    elif call.data.startswith('select_location_'):
        location_index = int(call.data.split('_')[2])
        water_body = WATER_BODIES[location_index]
        
        db.set_current_location(user.id, water_body['name'])
        
        markup = types.InlineKeyboardMarkup()
        btn_fish = types.InlineKeyboardButton('üêü –†—ã–±–∞ —ç—Ç–æ–≥–æ –≤–æ–¥–æ–µ–º–∞', callback_data=f'location_fish_{location_index}')
        btn_menu = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
        markup.add(btn_fish, btn_menu)
        
        text = (
            f"‚úÖ *–í–æ–¥–æ–µ–º –∏–∑–º–µ–Ω–µ–Ω!*\n\n"
            f"{water_body['emoji']} *{water_body['name']}*\n"
            f"üìù {water_body['description']}\n"
            f"üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: {water_body['coordinates']}\n"
            f"üé£ –°–ª–æ–∂–Ω–æ—Å—Ç—å: {water_body['difficulty']}\n\n"
            f"–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ª–æ–≤–∏—Ç—å —Ä—ã–±—É –≤ —ç—Ç–æ–º –≤–æ–¥–æ–µ–º–µ!"
        )
        
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data.startswith('location_fish_'):
        location_index = int(call.data.split('_')[2])
        water_body = WATER_BODIES[location_index]
        
        # –ü–æ–ª—É—á–∞–µ–º —Ä—ã–±—É –¥–ª—è —ç—Ç–æ–≥–æ –≤–æ–¥–æ–µ–º–∞
        location_fish = get_available_fish_for_location(water_body['name'])
        
        fish_text = f"üêü *–†—ã–±–∞ –≤–æ–¥–æ–µ–º–∞ {water_body['name']}*\n\n"
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏
        fish_by_rarity = {}
        for fish in location_fish:
            rarity = fish['rarity']
            if rarity not in fish_by_rarity:
                fish_by_rarity[rarity] = []
            fish_by_rarity[rarity].append(fish)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ —Ä–µ–¥–∫–æ—Å—Ç—è–º
        for rarity in ['–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è', '—ç–ø–∏—á–µ—Å–∫–∞—è', '—Ä–µ–¥–∫–∞—è', '–æ–±—ã—á–Ω–∞—è', '–º—É—Å–æ—Ä']:
            if rarity in fish_by_rarity:
                fish_text += f"{'üëë' if rarity == '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è' else 'üåü' if rarity == '—ç–ø–∏—á–µ—Å–∫–∞—è' else 'üê†' if rarity == '—Ä–µ–¥–∫–∞—è' else 'üêü' if rarity == '–æ–±—ã—á–Ω–∞—è' else 'üóëÔ∏è'} *{rarity.capitalize()} —Ä—ã–±–∞:*\n"
                for fish in fish_by_rarity[rarity][:10]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 10
                    fish_text += f"‚Ä¢ {fish['emoji']} {fish['name']}\n"
                if len(fish_by_rarity[rarity]) > 10:
                    fish_text += f"‚Ä¢ ... –∏ –µ—â–µ {len(fish_by_rarity[rarity]) - 10}\n"
                fish_text += "\n"
        
        markup = types.InlineKeyboardMarkup()
        btn_back = types.InlineKeyboardButton('üîô –ù–∞–∑–∞–¥ –∫ –≤–æ–¥–æ–µ–º–∞–º', callback_data='menu')
        markup.add(btn_back)
        
        bot.edit_message_text(fish_text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    # –ú–∞–≥–∞–∑–∏–Ω
    elif call.data == 'shop_baits':
        markup = types.InlineKeyboardMarkup(row_width=2)
        user_data = db.get_user(user.id)
        
        for bait in BAITS:
            btn = types.InlineKeyboardButton(f"{bait['emoji']} {bait['name']} - {bait['price']}—Ä", 
                                           callback_data=f'buy_bait_{bait["name"]}')
            markup.add(btn)
        
        btn_back = types.InlineKeyboardButton('üîô –ù–∞–∑–∞–¥', callback_data='shop_back')
        markup.add(btn_back)
        
        text = f"ü™± *–ú–∞–≥–∞–∑–∏–Ω –ø—Ä–∏–º–∞–Ω–æ–∫*\n\nüí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user_data['coins']} {COINS_NAME}\n\n–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–º–∞–Ω–∫—É:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data == 'shop_rods':
        markup = types.InlineKeyboardMarkup(row_width=2)
        user_data = db.get_user(user.id)
        
        # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É–¥–æ—á–∫–∏ –ø–æ —Ç–∏–ø—É
        rods_by_type = {}
        for rod in RODS:
            rod_type = rod['type']
            if rod_type not in rods_by_type:
                rods_by_type[rod_type] = []
            rods_by_type[rod_type].append(rod)
        
        # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞
        for rod_type in rods_by_type.keys():
            btn = types.InlineKeyboardButton(f"üé£ {rod_type.capitalize()}", 
                                           callback_data=f'shop_rods_type_{rod_type}')
            markup.add(btn)
        
        btn_back = types.InlineKeyboardButton('üîô –ù–∞–∑–∞–¥', callback_data='shop_back')
        markup.add(btn_back)
        
        text = f"üé£ *–ú–∞–≥–∞–∑–∏–Ω —É–¥–æ—á–µ–∫*\n\nüí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user_data['coins']} {COINS_NAME}\n\n–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —É–¥–æ—á–∫–∏:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data.startswith('shop_rods_type_'):
        rod_type = call.data.split('_')[3]
        markup = types.InlineKeyboardMarkup(row_width=2)
        user_data = db.get_user(user.id)
        
        rods_of_type = [r for r in RODS if r['type'] == rod_type]
        for rod in rods_of_type:
            btn = types.InlineKeyboardButton(f"{rod['emoji']} {rod['name']} - {rod['price']}—Ä", 
                                           callback_data=f'buy_rod_{rod["name"]}')
            markup.add(btn)
        
        btn_back = types.InlineKeyboardButton('üîô –ù–∞–∑–∞–¥ –∫ —Ç–∏–ø–∞–º', callback_data='shop_rods')
        markup.add(btn_back)
        
        text = f"üé£ *–£–¥–æ—á–∫–∏ —Ç–∏–ø–∞: {rod_type}*\n\nüí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user_data['coins']} {COINS_NAME}\n\n–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ—á–∫—É:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data == 'shop_upgrades':
        markup = types.InlineKeyboardMarkup(row_width=2)
        user_data = db.get_user(user.id)
        
        current_rod = user_data['current_rod']
        rod_data = db.get_user_rod(user.id, current_rod)
        
        if not rod_data:
            bot.answer_callback_query(call.id, "‚ùå –£–¥–æ—á–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
            return
        
        for upgrade in ROD_UPGRADES:
            btn = types.InlineKeyboardButton(f"{upgrade['emoji']} {upgrade['name']} - {upgrade['price']}—Ä", 
                                           callback_data=f'buy_upgrade_{upgrade["effect"]}')
            markup.add(btn)
        
        btn_back = types.InlineKeyboardButton('üîô –ù–∞–∑–∞–¥', callback_data='shop_back')
        markup.add(btn_back)
        
        durability_text = f"–ü—Ä–æ—á–Ω–æ—Å—Ç—å: {rod_data['durability']}/{rod_data['max_durability']}"
        unbreakable_text = "üõ°Ô∏è –ù–µ—Ä—É—à–∏–º–∞" if rod_data.get('unbreakable', False) else ""
        
        text = f"‚öôÔ∏è *–£–ª—É—á—à–µ–Ω–∏—è —É–¥–æ—á–∫–∏*\n\nüé£ –¢–µ–∫—É—â–∞—è —É–¥–æ—á–∫–∞: {current_rod}\n{durability_text} {unbreakable_text}\n\nüí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user_data['coins']} {COINS_NAME}\n\n–í—ã–±–µ—Ä–∏—Ç–µ —É–ª—É—á—à–µ–Ω–∏–µ:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data == 'shop_worms':
        markup = types.InlineKeyboardMarkup()
        user_data = db.get_user(user.id)
        
        btn1 = types.InlineKeyboardButton(f"üêõ 1 —á–µ—Ä–≤—è–∫ - {WORM_PRICE}—Ä", callback_data=f'buy_worms_1')
        btn3 = types.InlineKeyboardButton(f"üêõüêõüêõ 3 —á–µ—Ä–≤—è–∫–∞ - {WORM_PRICE*3}—Ä", callback_data=f'buy_worms_3')
        btn5 = types.InlineKeyboardButton(f"üêõx5 5 —á–µ—Ä–≤—è–∫–æ–≤ - {WORM_PRICE*5}—Ä", callback_data=f'buy_worms_5')
        btn10 = types.InlineKeyboardButton(f"üì¶ 10 —á–µ—Ä–≤—è–∫–æ–≤ - {WORM_PRICE*8}—Ä", callback_data=f'buy_worms_10')
        btn_back = types.InlineKeyboardButton('üîô –ù–∞–∑–∞–¥', callback_data='shop_back')
        
        markup.add(btn1, btn3, btn5, btn10, btn_back)
        
        text = f"üêõ *–ü–æ–∫—É–ø–∫–∞ —á–µ—Ä–≤—è–∫–æ–≤*\n\nüí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user_data['coins']} {COINS_NAME}\nüêõ –°–µ–π—á–∞—Å: {user_data['worms']}/10\n\n–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data == 'shop_back':
        markup = types.InlineKeyboardMarkup(row_width=2)
        btn1 = types.InlineKeyboardButton('ü™± –ü—Ä–∏–º–∞–Ω–∫–∏', callback_data='shop_baits')
        btn2 = types.InlineKeyboardButton('üé£ –£–¥–æ—á–∫–∏', callback_data='shop_rods')
        btn3 = types.InlineKeyboardButton('‚öôÔ∏è –£–ª—É—á—à–µ–Ω–∏—è', callback_data='shop_upgrades')
        btn4 = types.InlineKeyboardButton('üêõ –ö—É–ø–∏—Ç—å —á–µ—Ä–≤—è–∫–æ–≤', callback_data='shop_worms')
        btn5 = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
        markup.add(btn1, btn2, btn3, btn4, btn5)
        
        user_data = db.get_user(user.id)
        text = f"üõí *–ú–∞–≥–∞–∑–∏–Ω —Ä—ã–±–æ–ª–æ–≤–Ω—ã—Ö —Å–Ω–∞—Å—Ç–µ–π*\n\nüí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user_data['coins']} {COINS_NAME}\n\n–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data.startswith('buy_bait_'):
        bait_name = call.data[9:]
        bait = next((b for b in BAITS if b['name'] == bait_name), None)
        
        if not bait:
            bot.answer_callback_query(call.id, "‚ùå –ü—Ä–∏–º–∞–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
            return
        
        user_data = db.get_user(user.id)
        
        if user_data['coins'] < bait['price']:
            bot.answer_callback_query(call.id, f"‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ {COINS_NAME}! –ù—É–∂–Ω–æ {bait['price']}, —É –≤–∞—Å {user_data['coins']}")
            return
        
        success, new_balance = db.remove_coins(user.id, bait['price'])
        if success:
            db.add_bait(user.id, bait_name)
            db.update_quest_progress(user.id, "buy_bait")
            db.log_action(user.id, "buy_bait", bait_name)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            markup = types.InlineKeyboardMarkup()
            btn_back = types.InlineKeyboardButton('üõí –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏', callback_data='shop_baits')
            btn_menu = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
            markup.add(btn_back, btn_menu)
            
            text = f"‚úÖ *–ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞!*\n\nü™± –ö—É–ø–ª–µ–Ω–æ: {bait_name}\nüí∞ –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: {bait['price']} {COINS_NAME}\nüí≥ –û—Å—Ç–∞–ª–æ—Å—å: {new_balance} {COINS_NAME}\n\n–ü—Ä–∏–º–∞–Ω–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å!"
            bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
        else:
            bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏!")
    
    elif call.data.startswith('buy_rod_'):
        rod_name = call.data[8:]
        rod = next((r for r in RODS if r['name'] == rod_name), None)
        
        if not rod:
            bot.answer_callback_query(call.id, "‚ùå –£–¥–æ—á–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
            return
        
        user_data = db.get_user(user.id)
        
        if user_data['coins'] < rod['price']:
            bot.answer_callback_query(call.id, f"‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ {COINS_NAME}! –ù—É–∂–Ω–æ {rod['price']}, —É –≤–∞—Å {user_data['coins']}")
            return
        
        success, new_balance = db.remove_coins(user.id, rod['price'])
        if success:
            db.add_rod(user.id, rod_name)
            db.update_quest_progress(user.id, "buy_rod")
            db.log_action(user.id, "buy_rod", rod_name)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            markup = types.InlineKeyboardMarkup()
            btn_equip = types.InlineKeyboardButton('‚ö° –≠–∫–∏–ø–∏—Ä–æ–≤–∞—Ç—å', callback_data=f'equip_rod_{rod_name}')
            btn_back = types.InlineKeyboardButton('üõí –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏', callback_data='shop_rods')
            btn_menu = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
            markup.add(btn_equip, btn_back, btn_menu)
            
            text = f"‚úÖ *–ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞!*\n\nüé£ –ö—É–ø–ª–µ–Ω–æ: {rod_name}\nüí∞ –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: {rod['price']} {COINS_NAME}\nüí≥ –û—Å—Ç–∞–ª–æ—Å—å: {new_balance} {COINS_NAME}\n\n–£–¥–æ—á–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å!"
            bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
        else:
            bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏!")
    
    elif call.data.startswith('buy_upgrade_'):
        upgrade_effect = call.data[11:]
        upgrade = next((u for u in ROD_UPGRADES if u['effect'] == upgrade_effect), None)
        
        if not upgrade:
            bot.answer_callback_query(call.id, "‚ùå –£–ª—É—á—à–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!")
            return
        
        user_data = db.get_user(user.id)
        current_rod = user_data['current_rod']
        rod_data = db.get_user_rod(user.id, current_rod)
        
        if not rod_data:
            bot.answer_callback_query(call.id, "‚ùå –£–¥–æ—á–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!")
            return
        
        if user_data['coins'] < upgrade['price']:
            bot.answer_callback_query(call.id, f"‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ {COINS_NAME}! –ù—É–∂–Ω–æ {upgrade['price']}, —É –≤–∞—Å {user_data['coins']}")
            return
        
        success, new_balance = db.remove_coins(user.id, upgrade['price'])
        if success:
            if upgrade_effect == 'repair_50':
                new_durability = db.repair_rod(user.id, current_rod, 50)
                db.log_action(user.id, "repair_rod", f"{current_rod} +50")
                result_text = f"üîß –ü—Ä–æ—á–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ 50 –µ–¥–∏–Ω–∏—Ü. –¢–µ–ø–µ—Ä—å: {new_durability}/{rod_data['max_durability']}"
            elif upgrade_effect == 'durability_10':
                rod_data['max_durability'] = int(rod_data['max_durability'] * 1.1)
                rod_data['durability'] = int(rod_data['durability'] * 1.1)
                db.save_data()
                db.log_action(user.id, "upgrade_durability", f"{current_rod} +10%")
                result_text = f"‚öôÔ∏è –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—á–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ –Ω–∞ 10%"
            elif upgrade_effect == 'durability_20':
                rod_data['max_durability'] = int(rod_data['max_durability'] * 1.2)
                rod_data['durability'] = int(rod_data['durability'] * 1.2)
                db.save_data()
                db.log_action(user.id, "upgrade_durability", f"{current_rod} +20%")
                result_text = f"üíé –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—á–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ –Ω–∞ 20%"
            elif upgrade_effect == 'luck_10':
                db.upgrade_rod(user.id, current_rod, "luck_10")
                db.log_action(user.id, "upgrade_luck", f"{current_rod} +10%")
                result_text = f"üåü –£–¥–∞—á–∞ —É–≤–µ–ª–∏—á–µ–Ω–∞ –Ω–∞ 10%"
            elif upgrade_effect == 'luck_20':
                db.upgrade_rod(user.id, current_rod, "luck_20")
                db.log_action(user.id, "upgrade_luck", f"{current_rod} +20%")
                result_text = f"‚ú® –£–¥–∞—á–∞ —É–≤–µ–ª–∏—á–µ–Ω–∞ –Ω–∞ 20%"
            elif upgrade_effect == 'luck_30':
                db.upgrade_rod(user.id, current_rod, "luck_30")
                db.log_action(user.id, "upgrade_luck", f"{current_rod} +30%")
                result_text = f"üîÆ –£–¥–∞—á–∞ —É–≤–µ–ª–∏—á–µ–Ω–∞ –Ω–∞ 30%"
            elif upgrade_effect == 'unbreakable':
                db.upgrade_rod(user.id, current_rod, "unbreakable")
                db.log_action(user.id, "upgrade_unbreakable", current_rod)
                result_text = f"üõ°Ô∏è –£–¥–æ—á–∫–∞ —Ç–µ–ø–µ—Ä—å –Ω–µ—Ä—É—à–∏–º–∞!"
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            markup = types.InlineKeyboardMarkup()
            btn_back = types.InlineKeyboardButton('üõí –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏', callback_data='shop_upgrades')
            btn_menu = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
            markup.add(btn_back, btn_menu)
            
            text = f"‚úÖ *–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ!*\n\n{upgrade['emoji']} {upgrade['name']}\n{result_text}\n\nüí∞ –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: {upgrade['price']} {COINS_NAME}\nüí≥ –û—Å—Ç–∞–ª–æ—Å—å: {new_balance} {COINS_NAME}"
            bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
        else:
            bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏!")
    
    elif call.data.startswith('equip_rod_'):
        rod_name = call.data[10:]
        db.set_current_rod(user.id, rod_name)
        
        bot.answer_callback_query(call.id, f"‚úÖ –£–¥–æ—á–∫–∞ {rod_name} —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω–∞!")
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω
        markup = types.InlineKeyboardMarkup(row_width=2)
        
        for rod in RODS:
            btn = types.InlineKeyboardButton(f"{rod['emoji']} {rod['name']} - {rod['price']}—Ä", 
                                           callback_data=f'buy_rod_{rod["name"]}')
            markup.add(btn)
        
        btn_back = types.InlineKeyboardButton('üîô –ù–∞–∑–∞–¥', callback_data='shop_back')
        markup.add(btn_back)
        
        user_data = db.get_user(user.id)
        text = f"üé£ *–ú–∞–≥–∞–∑–∏–Ω —É–¥–æ—á–µ–∫*\n\nüí∞ –í–∞—à –±–∞–ª–∞–Ω—Å: {user_data['coins']} {COINS_NAME}\nüé£ –ê–∫—Ç–∏–≤–Ω–∞—è —É–¥–æ—á–∫–∞: {rod_name}\n\n–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ—á–∫—É:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data.startswith('buy_worms_'):
        count = int(call.data[10:])
        total_price = count * WORM_PRICE
        
        # –°–∫–∏–¥–∫–∞ –Ω–∞ 10 —á–µ—Ä–≤—è–∫–æ–≤
        if count == 10:
            total_price = WORM_PRICE * 8
        
        user_data = db.get_user(user.id)
        
        if user_data['worms'] >= MAX_WORMS:
            bot.answer_callback_query(call.id, f"‚ùå –£ –≤–∞—Å —É–∂–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ—Ä–≤—è–∫–æ–≤ ({MAX_WORMS})!")
            return
        
        if user_data['coins'] < total_price:
            bot.answer_callback_query(call.id, f"‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ {COINS_NAME}! –ù—É–∂–Ω–æ {total_price}, —É –≤–∞—Å {user_data['coins']}")
            return
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å
        can_buy = min(count, MAX_WORMS - user_data['worms'])
        if can_buy <= 0:
            bot.answer_callback_query(call.id, f"‚ùå –£ –≤–∞—Å —É–∂–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–µ—Ä–≤—è–∫–æ–≤ ({MAX_WORMS})!")
            return
        
        actual_price = int(total_price * (can_buy / count))
        
        success, new_balance = db.remove_coins(user.id, actual_price)
        if success:
            user_data['worms'] = min(user_data['worms'] + can_buy, MAX_WORMS)
            db.save_data()
            db.update_quest_progress(user.id, "buy_bait")
            db.log_action(user.id, "buy_worms", f"{can_buy} —à—Ç –∑–∞ {actual_price}")
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            markup = types.InlineKeyboardMarkup()
            btn_back = types.InlineKeyboardButton('üõí –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏', callback_data='shop_worms')
            btn_menu = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
            markup.add(btn_back, btn_menu)
            
            text = f"‚úÖ *–ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞!*\n\nüêõ –ö—É–ø–ª–µ–Ω–æ: {can_buy} —á–µ—Ä–≤—è–∫–æ–≤\nüí∞ –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: {actual_price} {COINS_NAME}\nüí≥ –û—Å—Ç–∞–ª–æ—Å—å: {new_balance} {COINS_NAME}\nüì¶ –í—Å–µ–≥–æ —á–µ—Ä–≤—è–∫–æ–≤: {user_data['worms']}/10"
            bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
        else:
            bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏!")
    
    # –ü—Ä–æ–¥–∞–∂–∞ —Ä—ã–±—ã
    elif call.data.startswith('sell_npc_'):
        npc_index = int(call.data[9:])
        npc = NPC_SELLERS[npc_index]
        
        user_data = db.get_user(user.id)
        
        if not user_data['inventory']['fish']:
            bot.answer_callback_query(call.id, "‚ùå –£ –≤–∞—Å –Ω–µ—Ç —Ä—ã–±—ã –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏!")
            return
        
        # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä—ã–±—ã
        markup = types.InlineKeyboardMarkup(row_width=2)
        
        for fish_name, count in user_data['inventory']['fish'].items():
            # –ù–∞—Ö–æ–¥–∏–º –±–∞–∑–æ–≤—É—é —Ü–µ–Ω—É
            base_price = 0
            for fish in FISHES:
                if fish['name'] == fish_name:
                    base_price = fish.get('price', 0)
                    break
            
            if base_price > 0:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ª–∏ NPC —ç—Ç—É —Ä—ã–±—É
                multiplier = npc['multiplier']
                if fish_name in npc.get('preferred_fish', []):
                    multiplier *= 1.5
                
                total_price = int(base_price * multiplier)
                btn = types.InlineKeyboardButton(f"{fish_name} ({count}—à—Ç) - {total_price}—Ä", 
                                               callback_data=f'sell_fish_{npc_index}_{fish_name}_1')
                markup.add(btn)
        
        # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –≤—Å–µ–≥–æ
        for fish_name, count in user_data['inventory']['fish'].items():
            base_price = 0
            for fish in FISHES:
                if fish['name'] == fish_name:
                    base_price = fish.get('price', 0)
                    break
            
            if base_price > 0 and count > 1:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –ª–∏ NPC —ç—Ç—É —Ä—ã–±—É
                multiplier = npc['multiplier']
                if fish_name in npc.get('preferred_fish', []):
                    multiplier *= 1.5
                
                total_price = int(base_price * count * multiplier)
                btn = types.InlineKeyboardButton(f"–í–°–Å {fish_name} ({count}—à—Ç) - {total_price}—Ä", 
                                               callback_data=f'sell_fish_{npc_index}_{fish_name}_{count}')
                markup.add(btn)
        
        btn_back = types.InlineKeyboardButton('üîô –ù–∞–∑–∞–¥', callback_data='sell_back')
        markup.add(btn_back)
        
        text = f"üí∞ *–ü—Ä–æ–¥–∞–∂–∞ —Ä—ã–±—ã*\n\n{npc['emoji']} *{npc['name']}*\n{npc['description']}\nüìà –ú–Ω–æ–∂–∏—Ç–µ–ª—å —Ü–µ–Ω—ã: x{npc['multiplier']}\n‚≠ê –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º–∞—è —Ä—ã–±–∞: +50%\n\n–í—ã–±–µ—Ä–∏—Ç–µ —Ä—ã–±—É –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data == 'sell_back':
        markup = types.InlineKeyboardMarkup(row_width=2)
        
        for i, npc in enumerate(NPC_SELLERS):
            btn = types.InlineKeyboardButton(f"{npc['emoji']} {npc['name']}", callback_data=f'sell_npc_{i}')
            markup.add(btn)
        
        btn_back = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
        markup.add(btn_back)
        
        user_data = db.get_user(user.id)
        text = f"üí∞ *–ü—Ä–æ–¥–∞–∂–∞ —Ä—ã–±—ã*\n\nüêü –í–∞—à–∞ —Ä—ã–±–∞:\n"
        
        for fish_name, count in user_data['inventory']['fish'].items():
            base_price = 0
            for fish in FISHES:
                if fish['name'] == fish_name:
                    base_price = fish.get('price', 0)
                    break
            
            if base_price > 0:
                text += f"‚Ä¢ {fish_name}: {count} —à—Ç (–ø–æ {base_price} {COINS_NAME})\n"
        
        text += "\n–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è:"
        bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    elif call.data.startswith('sell_fish_'):
        try:
            parts = call.data.split('_')
            npc_index = int(parts[2])
            fish_name = parts[3]
            count = int(parts[4])
        
            # –û—Ç–≤–µ—á–∞–µ–º —Å—Ä–∞–∑—É —á—Ç–æ–±—ã Telegram –∑–Ω–∞–ª —á—Ç–æ callback –æ–±—Ä–∞–±–æ—Ç–∞–Ω
            bot.answer_callback_query(call.id, "‚è≥ –ü—Ä–æ–¥–∞–µ–º...")
        
            npc = NPC_SELLERS[npc_index]
            user_data = db.get_user(user.id)
        
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Ä—ã–±–∞
            if fish_name not in user_data['inventory']['fish'] or user_data['inventory']['fish'][fish_name] < count:
                bot.answer_callback_query(call.id, "‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä—ã–±—ã!")
                return
        
            # –ù–∞—Ö–æ–¥–∏–º —Ü–µ–Ω—É
            base_price = 0
            for fish in FISHES:
                if fish['name'] == fish_name:
                    base_price = fish.get('price', 0)
                    break
        
            if base_price == 0:
                bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–Ω—ã!")
                return
        
            # –í—ã—á–∏—Å–ª—è–µ–º —Ü–µ–Ω—É
            multiplier = npc['multiplier']
            if fish_name in npc.get('preferred_fish', []):
                multiplier *= 1.5
        
            # –ü—Ä–æ–¥–∞–µ–º
            success, earned = db.sell_fish(user.id, fish_name, count, npc_index)
        
            if success:
                db.update_quest_progress(user.id, "sell", earned)
            
                # –ü–æ–ª—É—á–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                user_data = db.get_user(user.id)
            
                bonus_text = ""
                if fish_name in npc.get('preferred_fish', []):
                    bonus_text = "\n‚≠ê +50% –∑–∞ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—É—é —Ä—ã–±—É!"
            
                # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                markup = types.InlineKeyboardMarkup()
                btn_more = types.InlineKeyboardButton('üí∞ –ü—Ä–æ–¥–∞—Ç—å –µ—â–µ', callback_data=f'sell_npc_{npc_index}')
                btn_menu = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
                markup.add(btn_more, btn_menu)
            
                text = (f"üí∞ *–ü—Ä–æ–¥–∞–∂–∞ —É—Å–ø–µ—à–Ω–∞!*\n\n"
                       f"{npc['emoji']} {npc['name']}\n"
                       f"üêü –ü—Ä–æ–¥–∞–Ω–æ: {fish_name} x{count}\n"
                       f"üíµ –ü–æ–ª—É—á–µ–Ω–æ: {earned} {COINS_NAME}{bonus_text}\n"
                       f"üí≥ –í—Å–µ–≥–æ: {user_data['coins']} {COINS_NAME}\n\n"
                       f"{npc['description']}")
            
                try:
                    bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=markup)
                except:
                    # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                    bot.send_message(call.message.chat.id, text, reply_markup=markup)
            else:
                 bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–¥–∞–∂–∏!")
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –≤ –ø—Ä–æ–¥–∞–∂–µ: {e}")
            bot.answer_callback_query(call.id, "‚ùå –û—à–∏–±–∫–∞! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")
    
    # –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤
    elif call.data.startswith('top_'):
        category = call.data[4:]
        
        if category == 'coins':
            top_players = db.get_top_players("coins", 10)
            title = "üí∞ –¢–æ–ø –ø–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º —Ä—ã–±–æ–ø"
        elif category == 'fish':
            top_players = db.get_top_players("fish", 10)
            title = "üêü –¢–æ–ø –ø–æ –ø–æ–π–º–∞–Ω–Ω–æ–π —Ä—ã–±–µ"
        elif category == 'level':
            top_players = db.get_top_players("level", 10)
            title = "üé£ –¢–æ–ø –ø–æ —É—Ä–æ–≤–Ω—é"
        elif category == 'rare':
            top_players = db.get_top_players("rare", 10)
            title = "üåü –¢–æ–ø –ø–æ —Ä–µ–¥–∫–æ–π —Ä—ã–±–µ"
        else:
            return
        
        top_text = f"üèÜ *{title}*\n\n"
        
        for i, player in enumerate(top_players, 1):
            medal = "ü•á" if i == 1 else "ü•à" if i == 2 else "ü•â" if i == 3 else f"{i}."
            score_format = f"{player['score']:,}".replace(",", " ") if category == 'coins' else str(player['score'])
            
            top_text += f"{medal} *{player['display_name']}*\n"
            if player['username'] and not player.get('hide_from_top', False):
                top_text += f"   üë§ @{player['username']}\n"
            top_text += f"   üé£ –£—Ä–æ–≤–µ–Ω—å: {player['level']}\n"
            top_text += f"   üìä –û—á–∫–∏: {score_format}\n\n"
        
        markup = types.InlineKeyboardMarkup(row_width=3)
        btn1 = types.InlineKeyboardButton('üí∞ –ü–æ —Ä—ã–±–æ–ø', callback_data='top_coins')
        btn2 = types.InlineKeyboardButton('üêü –ü–æ —Ä—ã–±–µ', callback_data='top_fish')
        btn3 = types.InlineKeyboardButton('üé£ –ü–æ —É—Ä–æ–≤–Ω—é', callback_data='top_level')
        btn4 = types.InlineKeyboardButton('üåü –ü–æ —Ä–µ–¥–∫–æ—Å—Ç—è–º', callback_data='top_rare')
        btn5 = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
        markup.add(btn1, btn2, btn3, btn4, btn5)
        
        bot.edit_message_text(top_text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    # –î–æ–Ω–∞—Ç
    elif call.data.startswith('donate_'):
        category = call.data[7:]
        
        if category == 'upgrades':
            packages = [p for p in DONATE_PACKAGES if p['type'] == 'upgrade']
            title = "üõ°Ô∏è –£–ª—É—á—à–µ–Ω–∏—è"
        elif category == 'rods':
            packages = [p for p in DONATE_PACKAGES if p['type'] == 'rod']
            title = "üé£ –£–¥–æ—á–∫–∏"
        elif category == 'coins':
            packages = [p for p in DONATE_PACKAGES if p['type'] == 'coins']
            title = "üí∞ –†—ã–±–æ–ø"
        elif category == 'packs':
            packages = [p for p in DONATE_PACKAGES if p['type'] == 'pack']
            title = "üéÅ –ù–∞–±–æ—Ä—ã"
        else:
            return
        
        donate_text = f"üí∞ *{title}*\n\n"
        
        for package in packages:
            donate_text += f"{package['emoji']} *{package['name']}*\n"
            donate_text += f"üìù {package['description']}\n"
            donate_text += f"üí≥ –¶–µ–Ω–∞: {package['price_rub']}‚ÇΩ\n"
            donate_text += f"üÜî –ö–æ–¥: `{package['unique_code']}`\n\n"
        
        donate_text += "üí≥ *–ö–∞—Ä—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞:* ||2200702034105283||\n\n"
        donate_text += "üìû *–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è:*\n"
        donate_text += "1. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω—É–∂–Ω—É—é —Å—É–º–º—É\n"
        donate_text += "2. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –ø–µ—Ä–µ–≤–æ–¥–∞\n"
        donate_text += "3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç @Belka759\n"
        donate_text += "4. –£–∫–∞–∂–∏—Ç–µ –≤–∞—à ID *–º–æ–∂–æ —É–∑–Ω–∞—Ç—å –≤ @userinfobot * –∏ –∫–æ–¥ –ø–∞–∫–µ—Ç–∞\n\n"
        donate_text += "‚úÖ –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–º –≤—ã–¥–∞–¥—É—Ç –ø–æ–∫—É–ø–∫—É!"
        
        markup = types.InlineKeyboardMarkup(row_width=2)
        btn1 = types.InlineKeyboardButton('üõ°Ô∏è –£–ª—É—á—à–µ–Ω–∏—è', callback_data='donate_upgrades')
        btn2 = types.InlineKeyboardButton('üé£ –£–¥–æ—á–∫–∏', callback_data='donate_rods')
        btn3 = types.InlineKeyboardButton('üí∞ –†—ã–±–æ–ø', callback_data='donate_coins')
        btn4 = types.InlineKeyboardButton('üéÅ –ù–∞–±–æ—Ä—ã', callback_data='donate_packs')
        btn5 = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
        markup.add(btn1, btn2, btn3, btn4, btn5)
        
        bot.edit_message_text(donate_text, call.message.chat.id, call.message.message_id, reply_markup=markup)
    
    # –ê–¥–º–∏–Ω —Ñ—É–Ω–∫—Ü–∏–∏
    elif call.data.startswith('admin_userinfo_'):
        user_id = call.data.split('_')[2]
        admin_stats_command(call)

    # –í–´–ë–û–† –ü–†–ò–ú–ê–ù–ö–ò - –î–û–ë–ê–í–¨ –≠–¢–û –í –°–ê–ú–û–ú –ö–û–ù–¶–ï, –ü–ï–†–ï–î –ö–û–ù–¶–û–ú –§–£–ù–ö–¶–ò–ò
    elif call.data.startswith('select_bait_'):
        bait_name = call.data[12:]  # –£–±–∏—Ä–∞–µ–º 'select_bait_'
    
        db.set_current_bait(user.id, bait_name)
        bot.answer_callback_query(call.id, f"‚úÖ –í—ã–±—Ä–∞–Ω–∞ –ø—Ä–∏–º–∞–Ω–∫–∞: {bait_name}")
    
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ –º–µ–Ω—é
        bot.send_message(call.message.chat.id, 
                        f"‚úÖ –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏–º–∞–Ω–∫–∞: {bait_name}\n\n"
                        f"–ù–∞–∂–º–∏—Ç–µ 'üé£ –ù–∞—á–∞—Ç—å —Ä—ã–±–∞–ª–∫—É' –¥–ª—è —Ä—ã–±–∞–ª–∫–∏ —Å —ç—Ç–æ–π –ø—Ä–∏–º–∞–Ω–∫–æ–π.",
                        reply_markup=create_main_keyboard(user.id))
    
    # –ù–ê–°–¢–†–û–ô–ö–ò
    elif call.data == 'settings_change_nickname':
        msg = bot.send_message(call.message.chat.id, 
                              "‚úèÔ∏è *–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –Ω–∏–∫ –¥–ª—è —Ç–æ–ø–∞:*\n\n"
                              "–ú–∞–∫—Å–∏–º—É–º 20 —Å–∏–º–≤–æ–ª–æ–≤, –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞\n"
                              "–ü—Ä–∏–º–µ—Ä: –†—ã–±–∞–∫2024",
                              parse_mode="Markdown")
        bot.register_next_step_handler(msg, process_nickname_input, user.id)
        
    elif call.data == 'settings_toggle_hide':
        user_data = db.get_user(user.id)
        user_data['hide_from_top'] = not user_data.get('hide_from_top', False)
        db.save_data()
        
        status = "‚úÖ –¢–µ–ø–µ—Ä—å –≤—ã —Å–∫—Ä—ã—Ç—ã –∏–∑ —Ç–æ–ø–∞!" if user_data['hide_from_top'] else "üëÅÔ∏è –¢–µ–ø–µ—Ä—å –≤—ã –≤–∏–¥–∏–º—ã –≤ —Ç–æ–ø–µ!"
        bot.answer_callback_query(call.id, status)
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        nickname = user_data.get('top_nickname', user.first_name)
        hide_from_top = user_data.get('hide_from_top', False)
        
        markup = types.InlineKeyboardMarkup(row_width=2)
        
        btn_nickname = types.InlineKeyboardButton(
            f'üìù –ù–∏–∫ –≤ —Ç–æ–ø–µ: {nickname}', 
            callback_data='settings_change_nickname'
        )
        
        hide_text = "‚úÖ –°–∫—Ä—ã—Ç –∏–∑ —Ç–æ–ø–∞" if hide_from_top else "‚ùå –í–∏–¥–µ–Ω –≤ —Ç–æ–ø–µ"
        btn_hide = types.InlineKeyboardButton(
            f'üëÅÔ∏è {hide_text}', 
            callback_data='settings_toggle_hide'
        )
        
        btn_reset = types.InlineKeyboardButton(
            'üîÑ –°–±—Ä–æ—Å–∏—Ç—å –Ω–∏–∫', 
            callback_data='settings_reset_nickname'
        )
        
        btn_back = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
        
        markup.add(btn_nickname, btn_hide, btn_reset, btn_back)
        
        settings_text = (
            f"‚öôÔ∏è *–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è*\n\n"
            f"üë§ –í–∞—à –Ω–∏–∫ –≤ —Ç–æ–ø–µ: *{nickname}*\n"
            f"üëÅÔ∏è –°—Ç–∞—Ç—É—Å –≤ —Ç–æ–ø–µ: {'*–°–∫—Ä—ã—Ç* üëª' if hide_from_top else '*–í–∏–¥–µ–Ω* üëÅÔ∏è'}\n\n"
            f"*–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:*\n"
            f"‚Ä¢ –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫ –¥–ª—è —Ç–æ–ø–∞\n"
            f"‚Ä¢ –°–∫—Ä—ã—Ç—å—Å—è –∏–∑ –æ–±—â–µ–≥–æ —Ç–æ–ø–∞\n"
            f"‚Ä¢ –°–±—Ä–æ—Å–∏—Ç—å –Ω–∏–∫ –∫ –∏–º–µ–Ω–∏\n"
        )
        
        bot.edit_message_text(settings_text, call.message.chat.id, call.message.message_id, reply_markup=markup)
        
    elif call.data == 'settings_reset_nickname':
        user_data = db.get_user(user.id)
        old_nickname = user_data.get('top_nickname', user.first_name)
        user_data['top_nickname'] = None
        db.save_data()
        
        bot.answer_callback_query(call.id, f"‚úÖ –ù–∏–∫ —Å–±—Ä–æ—à–µ–Ω –∫ –∏–º–µ–Ω–∏: {user.first_name}")
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        nickname = user.first_name
        hide_from_top = user_data.get('hide_from_top', False)
        
        markup = types.InlineKeyboardMarkup(row_width=2)
        
        btn_nickname = types.InlineKeyboardButton(
            f'üìù –ù–∏–∫ –≤ —Ç–æ–ø–µ: {nickname}', 
            callback_data='settings_change_nickname'
        )
        
        hide_text = "‚úÖ –°–∫—Ä—ã—Ç –∏–∑ —Ç–æ–ø–∞" if hide_from_top else "‚ùå –í–∏–¥–µ–Ω –≤ —Ç–æ–ø–µ"
        btn_hide = types.InlineKeyboardButton(
            f'üëÅÔ∏è {hide_text}', 
            callback_data='settings_toggle_hide'
        )
        
        btn_reset = types.InlineKeyboardButton(
            'üîÑ –°–±—Ä–æ—Å–∏—Ç—å –Ω–∏–∫', 
            callback_data='settings_reset_nickname'
        )
        
        btn_back = types.InlineKeyboardButton('üìã –ú–µ–Ω—é', callback_data='menu')
        
        markup.add(btn_nickname, btn_hide, btn_reset, btn_back)
        
        settings_text = (
            f"‚öôÔ∏è *–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è*\n\n"
            f"üë§ –í–∞—à –Ω–∏–∫ –≤ —Ç–æ–ø–µ: *{nickname}*\n"
            f"üëÅÔ∏è –°—Ç–∞—Ç—É—Å –≤ —Ç–æ–ø–µ: {'*–°–∫—Ä—ã—Ç* üëª' if hide_from_top else '*–í–∏–¥–µ–Ω* üëÅÔ∏è'}\n\n"
            f"*–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:*\n"
            f"‚Ä¢ –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫ –¥–ª—è —Ç–æ–ø–∞\n"
            f"‚Ä¢ –°–∫—Ä—ã—Ç—å—Å—è –∏–∑ –æ–±—â–µ–≥–æ —Ç–æ–ø–∞\n"
            f"‚Ä¢ –°–±—Ä–æ—Å–∏—Ç—å –Ω–∏–∫ –∫ –∏–º–µ–Ω–∏\n"
        )
        
        bot.edit_message_text(settings_text, call.message.chat.id, call.message.message_id, reply_markup=markup)

    # –ï—Å–ª–∏ callback –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω
    else:
        bot.answer_callback_query(call.id, "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞")

# ========== –û–ë–†–ê–ë–û–¢–ö–ê –í–°–ï–• –°–û–û–ë–©–ï–ù–ò–ô ==========
@bot.message_handler(func=lambda message: True, content_types=['text'])
def handle_all_messages(message):
    delete_links_in_group(message)
    
    text = message.text
    if text in ['üé£ –ù–∞—á–∞—Ç—å —Ä—ã–±–∞–ª–∫—É', 'üåä –°–º–µ–Ω–∏—Ç—å –≤–æ–¥–æ–µ–º', 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞', 'üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å', '‚ùì –ü–æ–º–æ—â—å', 
                'üé£ –ó–∞–±—Ä–æ—Å–∏—Ç—å —É–¥–æ—á–∫—É', 'üìã –ú–µ–Ω—é', 'üõí –ú–∞–≥–∞–∑–∏–Ω', 'üí∞ –ü—Ä–æ–¥–∞—Ç—å —Ä—ã–±—É', 'üìú –ó–∞–¥–∞–Ω–∏—è', 'üèÜ –¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤',
                'üì∞ –ù–æ–≤–æ—Å—Ç–∏', 'üí∞ –î–æ–Ω–∞—Ç', 'üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å', 'üö´ –ë–∞–Ω/–†–∞–∑–±–∞–Ω', 'üîá –ú—É—Ç/–†–∞–∑–º—É—Ç', '‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ',
                'üí∞ –í—ã–¥–∞—Ç—å –¥–æ–Ω–∞—Ç', 'üìú –õ–æ–≥–∏ –±–∞–Ω–æ–≤', 'üìã –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤', 'üë§ –ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–∞', 'üé£ –í—ã–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã',
                'üí∞ –í—ã–¥–∞—Ç—å –º–æ–Ω–µ—Ç—ã', 'üåü –í—ã–¥–∞—Ç—å –æ–ø—ã—Ç', 'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞', 'üë§ –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∞', 'üîÑ –°–±—Ä–æ—Å –∏–≥—Ä–æ–∫–∞',
                '‚öôÔ∏è –ü–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', 'üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏', 'üì¢ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å', 'üìú –í—Å–µ –ª–æ–≥–∏']:
        return
    if text and text.startswith('/'):
        return

@bot.message_handler(content_types=['photo', 'video', 'document', 'audio', 'voice', 'sticker'])
def handle_media_messages(message):
    delete_links_in_group(message)

# ========== FLASK WEBHOOK –°–ï–†–í–ï–† ==========
# –°–æ–∑–¥–∞–µ–º Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
app = Flask(__name__)

@app.route('/')
def home():
    """–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã"""
    return """
    <!DOCTYPE html>
    <html>
    <head>
        <title>üé£ Fishing Bot</title>
        <meta charset="utf-8">
        <style>
            body {
                font-family: 'Arial', sans-serif;
                text-align: center;
                padding: 40px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                min-height: 100vh;
                margin: 0;
            }
            .container {
                max-width: 800px;
                margin: 0 auto;
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                padding: 40px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            }
            h1 {
                font-size: 3em;
                margin-bottom: 20px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            }
            .stats {
                display: flex;
                justify-content: space-around;
                flex-wrap: wrap;
                margin: 30px 0;
            }
            .stat-card {
                background: rgba(255, 255, 255, 0.15);
                border-radius: 15px;
                padding: 20px;
                margin: 10px;
                flex: 1;
                min-width: 150px;
                transition: transform 0.3s;
            }
            .stat-card:hover {
                transform: translateY(-5px);
            }
            .stat-value {
                font-size: 2em;
                font-weight: bold;
                margin: 10px 0;
            }
            .btn {
                display: inline-block;
                margin: 15px;
                padding: 15px 30px;
                background: rgba(255, 255, 255, 0.2);
                color: white;
                text-decoration: none;
                border-radius: 50px;
                border: 2px solid rgba(255, 255, 255, 0.3);
                transition: all 0.3s;
                font-weight: bold;
            }
            .btn:hover {
                background: rgba(255, 255, 255, 0.3);
                transform: scale(1.05);
            }
            .footer {
                margin-top: 40px;
                opacity: 0.8;
                font-size: 0.9em;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>üé£ Fishing Bot</h1>
            <p>–ë–æ—Ç –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Ä—ã–±–∞–ª–∫–∏ –≤ Telegram</p>
            
            <div class="stats">
                <div class="stat-card">
                    <div>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    <div class="stat-value">""" + str(len(db.users)) + """</div>
                </div>
                <div class="stat-card">
                    <div>üé£ –†—ã–±—ã</div>
                    <div class="stat-value">""" + str(len(FISHES)) + """</div>
                </div>
                <div class="stat-card">
                    <div>üåä –í–æ–¥–æ–µ–º–æ–≤</div>
                    <div class="stat-value">""" + str(len(WATER_BODIES)) + """</div>
                </div>
            </div>
            
            <div>
                <a href="/set_webhook" class="btn">üîÑ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Webhook</a>
                <a href="/health" class="btn">‚ù§Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è</a>
                <a href="/status" class="btn">üìä –°—Ç–∞—Ç—É—Å</a>
            </div>
            
            <div class="footer">
                <p>ü§ñ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ webhook —Ä–µ–∂–∏–º–µ</p>
                <p>üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞: @Belka759</p>
                <p>¬© 2024 Fishing Bot</p>
            </div>
        </div>
    </body>
    </html>
    """, 200

@app.route(f'/{BOT_TOKEN}', methods=['POST'])
def webhook():
    """–û—Å–Ω–æ–≤–Ω–æ–π endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç Telegram"""
    if request.headers.get('content-type') == 'application/json':
        json_string = request.get_data().decode('utf-8')
        update = telebot.types.Update.de_json(json_string)
        bot.process_new_updates([update])
        return 'ok', 200
    return 'error', 403

@app.route('/set_webhook', methods=['GET'])
def set_webhook():
    """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook"""
    if not WEBHOOK_URL:
        return """
        <html>
        <head><title>‚ùå –û—à–∏–±–∫–∞</title></head>
        <body style="text-align: center; padding: 50px; font-family: Arial;">
            <h1>‚ùå –û—à–∏–±–∫–∞</h1>
            <p>RENDER_EXTERNAL_URL –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è</p>
            <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é RENDER_EXTERNAL_URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Render</p>
        </body>
        </html>
        """, 500
    
    try:
        bot.remove_webhook()
        time.sleep(0.1)
        
        s = bot.set_webhook(
            url=WEBHOOK_URL,
            max_connections=50,
            allowed_updates=["message", "callback_query", "inline_query"]
        )
        
        if s:
            return f"""
            <html>
            <head>
                <title>‚úÖ Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</title>
                <style>
                    body {{
                        font-family: Arial, sans-serif;
                        text-align: center;
                        padding: 50px;
                        background: #f0f9ff;
                    }}
                    .success {{
                        background: white;
                        padding: 40px;
                        border-radius: 15px;
                        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                        max-width: 800px;
                        margin: 0 auto;
                    }}
                    .url-box {{
                        background: #e8f5e9;
                        padding: 20px;
                        border-radius: 10px;
                        margin: 20px 0;
                        word-break: break-all;
                        font-family: monospace;
                    }}
                </style>
            </head>
            <body>
                <div class="success">
                    <h1>‚úÖ Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!</h1>
                    <div class="url-box">
                        <strong>URL:</strong><br>{WEBHOOK_URL}
                    </div>
                    <p>–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É /start –≤ Telegram</p>
                    <p><a href="/" style="color: #3498db;">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a></p>
                </div>
            </body>
            </html>
            """, 200
        else:
            return """
            <html>
            <body style="text-align: center; padding: 50px;">
                <h1>‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ webhook</h1>
                <p>–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –∏ URL.</p>
            </body>
            </html>
            """, 500
    except Exception as e:
        return f"""
        <html>
        <body style="text-align: center; padding: 50px;">
            <h1>‚ùå –û—à–∏–±–∫–∞</h1>
            <p>{str(e)}</p>
        </body>
        </html>
        """, 500

@app.route('/health')
def health():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è"""
    return json.dumps({
        "status": "ok",
        "timestamp": datetime.now().isoformat(),
        "users": len(db.users),
        "webhook": WEBHOOK_URL is not None
    }, ensure_ascii=False), 200

@app.route('/status')
def status():
    """–°—Ç–∞—Ç—É—Å –±–æ—Ç–∞"""
    try:
        bot_info = bot.get_me()
        return json.dumps({
            "status": "running",
            "bot": f"@{bot_info.username}",
            "bot_name": bot_info.first_name,
            "webhook": WEBHOOK_URL,
            "users_count": len(db.users),
            "admins_count": len(ADMINS),
            "fish_count": len(FISHES),
            "baits_count": len(BAITS),
            "rods_count": len(RODS),
            "timestamp": datetime.now().isoformat()
        }, ensure_ascii=False, indent=2)
    except Exception as e:
        return json.dumps({"error": str(e)}), 500

# ========== –ó–ê–ü–£–°–ö ==========
def run():
    print("=" * 50)
    print("üé£ Fishing Bot Webhook Edition")
    print("=" * 50)
    
    try:
        bot_info = bot.get_me()
        print(f"‚úÖ –ë–æ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω: @{bot_info.username} ({bot_info.first_name})")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–æ—Ç–∞: {e}")
    
    print(f"üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –±–∞–∑–µ: {len(db.users)}")
    print(f"üåç Webhook URL: {WEBHOOK_URL}")
    
    if WEBHOOK_URL:
        print("üöÄ –ó–∞–ø—É—Å–∫ –≤ webhook —Ä–µ–∂–∏–º–µ...")
        print(f"üìû –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ webhook –æ—Ç–∫—Ä–æ–π—Ç–µ: {RENDER_URL}/set_webhook")
    else:
        print("‚ö†Ô∏è RENDER_EXTERNAL_URL –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –±–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ webhook")
    
    print("üîÑ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞...")

    port = int(os.environ.get('PORT',10000))
    
    from waitress import serve
    serve(app, host='0.0.0.0', port=port)

if __name__ == '__main__':
    run()
